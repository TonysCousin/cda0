{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6063115341335984, "cur_lr": 0.0002381114270107754, "total_loss": 10.238624243987234, "policy_loss": 0.24342202886677625, "vf_loss": 10.0, "vf_explained_var": 0.001079325613222624, "kl": 0.00477377729147472, "entropy": 2.7502408949952377, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 1237, "num_env_steps_trained": 1237, "num_agent_steps_sampled": 1237, "num_agent_steps_trained": 1237}, "sampler_results": {"episode_reward_max": 9.993583134155658, "episode_reward_min": -40.56614842219942, "episode_reward_mean": -7.305670746198125, "episode_len_mean": 51.541666666666664, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24641731925021818, "mean_inference_ms": 0.5972860246136867, "mean_action_processing_ms": 0.1347267743766377, "mean_env_wait_ms": 0.0965349072537313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004678964614868164, "StateBufferConnector_ms": 0.00425875186920166, "ViewRequirementAgentConnector_ms": 0.08281866709391277}}, "episode_reward_max": 9.993583134155658, "episode_reward_min": -40.56614842219942, "episode_reward_mean": -7.305670746198125, "episode_len_mean": 51.541666666666664, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.24641731925021818, "mean_inference_ms": 0.5972860246136867, "mean_action_processing_ms": 0.1347267743766377, "mean_env_wait_ms": 0.0965349072537313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004678964614868164, "StateBufferConnector_ms": 0.00425875186920166, "ViewRequirementAgentConnector_ms": 0.08281866709391277}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1237, "num_agent_steps_trained": 1237, "num_env_steps_sampled": 1237, "num_env_steps_trained": 1237, "num_env_steps_sampled_this_iter": 1237, "num_env_steps_trained_this_iter": 1237, "timesteps_total": 1237, "num_steps_trained_this_iter": 1237, "agent_timesteps_total": 1237, "timers": {"training_iteration_time_ms": 6092.201, "load_time_ms": 0.802, "load_throughput": 1542775.512, "learn_time_ms": 5789.831, "learn_throughput": 213.65, "synch_weights_time_ms": 2.117}, "counters": {"num_env_steps_sampled": 1237, "num_env_steps_trained": 1237, "num_agent_steps_sampled": 1237, "num_agent_steps_trained": 1237}, "done": false, "episodes_total": 24, "training_iteration": 1, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-10", "timestamp": 1678935550, "time_this_iter_s": 6.097172737121582, "time_total_s": 6.097172737121582, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042d130>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042d850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 6.097172737121582, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 17.599999999999998, "ram_util_percent": 21.566666666666666, "gpu_util_percent0": 0.6788888888888889, "vram_util_percent0": 0.03303358289930555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.30315576706679914, "cur_lr": 0.00023811142701077534, "total_loss": 10.21764316371843, "policy_loss": 0.21719550827116357, "vf_loss": 10.0, "vf_explained_var": -0.0023054568206562717, "kl": 0.024820313474429343, "entropy": 2.5302035427560994, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 1650.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 2341, "num_env_steps_trained": 2341, "num_agent_steps_sampled": 2341, "num_agent_steps_trained": 2341}, "sampler_results": {"episode_reward_max": 9.999900829896074, "episode_reward_min": -40.96350043678366, "episode_reward_mean": -4.634530782278508, "episode_len_mean": 50.891304347826086, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23071390905323697, "mean_inference_ms": 0.5673138645984334, "mean_action_processing_ms": 0.1280688752664128, "mean_env_wait_ms": 0.09160805329878076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962413124416185, "StateBufferConnector_ms": 0.0039204307224439535, "ViewRequirementAgentConnector_ms": 0.07232686747675357}}, "episode_reward_max": 9.999900829896074, "episode_reward_min": -40.96350043678366, "episode_reward_mean": -4.634530782278508, "episode_len_mean": 50.891304347826086, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.23071390905323697, "mean_inference_ms": 0.5673138645984334, "mean_action_processing_ms": 0.1280688752664128, "mean_env_wait_ms": 0.09160805329878076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962413124416185, "StateBufferConnector_ms": 0.0039204307224439535, "ViewRequirementAgentConnector_ms": 0.07232686747675357}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2341, "num_agent_steps_trained": 2341, "num_env_steps_sampled": 2341, "num_env_steps_trained": 2341, "num_env_steps_sampled_this_iter": 1104, "num_env_steps_trained_this_iter": 1104, "timesteps_total": 2341, "num_steps_trained_this_iter": 1104, "agent_timesteps_total": 2341, "timers": {"training_iteration_time_ms": 5695.108, "load_time_ms": 1.18, "load_throughput": 992205.504, "learn_time_ms": 5428.736, "learn_throughput": 215.612, "synch_weights_time_ms": 2.172}, "counters": {"num_env_steps_sampled": 2341, "num_env_steps_trained": 2341, "num_agent_steps_sampled": 2341, "num_agent_steps_trained": 2341}, "done": false, "episodes_total": 46, "training_iteration": 2, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-15", "timestamp": 1678935555, "time_this_iter_s": 5.303237199783325, "time_total_s": 11.400409936904907, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654301670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 11.400409936904907, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.099999999999998, "ram_util_percent": 21.599999999999998, "gpu_util_percent0": 0.6985714285714286, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.45473365060019877, "cur_lr": 0.0002381114270107754, "total_loss": 10.153433866668166, "policy_loss": 0.1561890868453734, "vf_loss": 10.0, "vf_explained_var": 0.0004573417337317216, "kl": 0.008836504341383932, "entropy": 2.421762813183299, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 2730.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 3568, "num_env_steps_trained": 3568, "num_agent_steps_sampled": 3568, "num_agent_steps_trained": 3568}, "sampler_results": {"episode_reward_max": 9.999900829896074, "episode_reward_min": -40.96350043678366, "episode_reward_mean": -3.7699527755077082, "episode_len_mean": 52.470588235294116, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919265113519393, "mean_inference_ms": 0.5481146389203688, "mean_action_processing_ms": 0.12389060304128072, "mean_env_wait_ms": 0.08839118930582056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003761754316442153, "StateBufferConnector_ms": 0.004117979722864488, "ViewRequirementAgentConnector_ms": 0.06993202602162081}}, "episode_reward_max": 9.999900829896074, "episode_reward_min": -40.96350043678366, "episode_reward_mean": -3.7699527755077082, "episode_len_mean": 52.470588235294116, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21919265113519393, "mean_inference_ms": 0.5481146389203688, "mean_action_processing_ms": 0.12389060304128072, "mean_env_wait_ms": 0.08839118930582056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003761754316442153, "StateBufferConnector_ms": 0.004117979722864488, "ViewRequirementAgentConnector_ms": 0.06993202602162081}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3568, "num_agent_steps_trained": 3568, "num_env_steps_sampled": 3568, "num_env_steps_trained": 3568, "num_env_steps_sampled_this_iter": 1227, "num_env_steps_trained_this_iter": 1227, "timesteps_total": 3568, "num_steps_trained_this_iter": 1227, "agent_timesteps_total": 3568, "timers": {"training_iteration_time_ms": 5790.633, "load_time_ms": 1.136, "load_throughput": 1047401.783, "learn_time_ms": 5519.071, "learn_throughput": 215.495, "synch_weights_time_ms": 2.261}, "counters": {"num_env_steps_sampled": 3568, "num_env_steps_trained": 3568, "num_agent_steps_sampled": 3568, "num_agent_steps_trained": 3568}, "done": false, "episodes_total": 68, "training_iteration": 3, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-21", "timestamp": 1678935561, "time_this_iter_s": 5.9874303340911865, "time_total_s": 17.387840270996094, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6d940>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f6db50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180222d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 17.387840270996094, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1875, "ram_util_percent": 21.6, "gpu_util_percent0": 0.78625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4547336506001987, "cur_lr": 0.00023811142701077534, "total_loss": 10.144205187892055, "policy_loss": 0.1426792177833147, "vf_loss": 10.0, "vf_explained_var": -0.0012358894219269623, "kl": 0.017069235862128395, "entropy": 2.229591719202093, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 3855.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 4756, "num_env_steps_trained": 4756, "num_agent_steps_sampled": 4756, "num_agent_steps_trained": 4756}, "sampler_results": {"episode_reward_max": 9.999900829896074, "episode_reward_min": -41.17506299788637, "episode_reward_mean": -2.1075389753757667, "episode_len_mean": 54.666666666666664, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137028339877406, "mean_inference_ms": 0.5384082015148975, "mean_action_processing_ms": 0.1217771626056525, "mean_env_wait_ms": 0.0867580676424995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036061495199970818, "StateBufferConnector_ms": 0.003956926280054553, "ViewRequirementAgentConnector_ms": 0.06768511629652703}}, "episode_reward_max": 9.999900829896074, "episode_reward_min": -41.17506299788637, "episode_reward_mean": -2.1075389753757667, "episode_len_mean": 54.666666666666664, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.562336744315832, -40.56614842219942, 9.978270413547587, 8.237848811165081, -40.145152074265546, 8.743277188919443, 9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637], "episode_lengths": [89, 80, 66, 82, 25, 48, 5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2137028339877406, "mean_inference_ms": 0.5384082015148975, "mean_action_processing_ms": 0.1217771626056525, "mean_env_wait_ms": 0.0867580676424995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036061495199970818, "StateBufferConnector_ms": 0.003956926280054553, "ViewRequirementAgentConnector_ms": 0.06768511629652703}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4756, "num_agent_steps_trained": 4756, "num_env_steps_sampled": 4756, "num_env_steps_trained": 4756, "num_env_steps_sampled_this_iter": 1188, "num_env_steps_trained_this_iter": 1188, "timesteps_total": 4756, "num_steps_trained_this_iter": 1188, "agent_timesteps_total": 4756, "timers": {"training_iteration_time_ms": 5774.922, "load_time_ms": 1.247, "load_throughput": 953405.813, "learn_time_ms": 5509.039, "learn_throughput": 215.827, "synch_weights_time_ms": 2.277}, "counters": {"num_env_steps_sampled": 4756, "num_env_steps_trained": 4756, "num_agent_steps_sampled": 4756, "num_agent_steps_trained": 4756}, "done": false, "episodes_total": 87, "training_iteration": 4, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-27", "timestamp": 1678935567, "time_this_iter_s": 5.733957529067993, "time_total_s": 23.121797800064087, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f13880>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f13ca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 23.121797800064087, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.2625, "ram_util_percent": 21.575000000000003, "gpu_util_percent0": 0.765, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.45473365060019877, "cur_lr": 0.00023811142701077537, "total_loss": 10.100306732654571, "policy_loss": 0.10123275777131009, "vf_loss": 10.0, "vf_explained_var": -0.0018636003136634828, "kl": 0.011260887861750843, "entropy": 2.161922550300757, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 5010.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 6057, "num_env_steps_trained": 6057, "num_agent_steps_sampled": 6057, "num_agent_steps_trained": 6057}, "sampler_results": {"episode_reward_max": 9.999900829896074, "episode_reward_min": -41.17506299788637, "episode_reward_mean": -1.1094358768526336, "episode_len_mean": 56.67, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752], "episode_lengths": [5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482780349214327, "mean_inference_ms": 0.5224262266421901, "mean_action_processing_ms": 0.11820111182642196, "mean_env_wait_ms": 0.08404351116214256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493070602416992, "StateBufferConnector_ms": 0.003949642181396484, "ViewRequirementAgentConnector_ms": 0.06534671783447266}}, "episode_reward_max": 9.999900829896074, "episode_reward_min": -41.17506299788637, "episode_reward_mean": -1.1094358768526336, "episode_len_mean": 56.67, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.928737449225197, -40.00250779289209, -40.03538308804902, -40.36212408762935, 9.895066912081688, 9.959260554983386, -40.34981577712714, -40.091121511721155, 9.993583134155658, 5.051910202516652, 9.799042985444789, 9.38564895418236, 9.892393503661223, 9.921142921626208, 9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752], "episode_lengths": [5, 10, 13, 18, 29, 24, 58, 9, 20, 151, 26, 102, 38, 34, 76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482780349214327, "mean_inference_ms": 0.5224262266421901, "mean_action_processing_ms": 0.11820111182642196, "mean_env_wait_ms": 0.08404351116214256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493070602416992, "StateBufferConnector_ms": 0.003949642181396484, "ViewRequirementAgentConnector_ms": 0.06534671783447266}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6057, "num_agent_steps_trained": 6057, "num_env_steps_sampled": 6057, "num_env_steps_trained": 6057, "num_env_steps_sampled_this_iter": 1301, "num_env_steps_trained_this_iter": 1301, "timesteps_total": 6057, "num_steps_trained_this_iter": 1301, "agent_timesteps_total": 6057, "timers": {"training_iteration_time_ms": 5885.023, "load_time_ms": 1.364, "load_throughput": 888034.792, "learn_time_ms": 5618.665, "learn_throughput": 215.603, "synch_weights_time_ms": 2.302}, "counters": {"num_env_steps_sampled": 6057, "num_env_steps_trained": 6057, "num_agent_steps_sampled": 6057, "num_agent_steps_trained": 6057}, "done": false, "episodes_total": 106, "training_iteration": 5, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-33", "timestamp": 1678935573, "time_this_iter_s": 6.332026720046997, "time_total_s": 29.453824520111084, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301730>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6543015e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 29.453824520111084, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.5625, "ram_util_percent": 21.674999999999997, "gpu_util_percent0": 0.7937500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4547336506001987, "cur_lr": 0.00023811142701077534, "total_loss": 10.13138173850807, "policy_loss": 0.12339003249197393, "vf_loss": 10.0, "vf_explained_var": 0.0013362040390839448, "kl": 0.02935870942507487, "entropy": 1.9159244423514015, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 6165.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 7266, "num_env_steps_trained": 7266, "num_agent_steps_sampled": 7266, "num_agent_steps_trained": 7266}, "sampler_results": {"episode_reward_max": 9.999900829896074, "episode_reward_min": -42.1186594700992, "episode_reward_mean": 0.3313995898474229, "episode_len_mean": 63.39, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738], "episode_lengths": [76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974298178372785, "mean_inference_ms": 0.5105132038571033, "mean_action_processing_ms": 0.11556218727045062, "mean_env_wait_ms": 0.08206405762274675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032858848571777344, "StateBufferConnector_ms": 0.0036325454711914062, "ViewRequirementAgentConnector_ms": 0.062491416931152344}}, "episode_reward_max": 9.999900829896074, "episode_reward_min": -42.1186594700992, "episode_reward_mean": 0.3313995898474229, "episode_len_mean": 63.39, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.931422625927857, 8.212784852408422, -40.00183175663884, 9.725259347606192, 9.973073173774866, 9.779001344031851, 8.975521894599694, 9.878339210547328, 9.999900829896074, 9.383963794637081, 9.472633326284019, 9.902679821920886, 9.989363645480486, 9.70882766741948, -40.035759284510135, 9.997073201056505, -40.96350043678366, -40.01518240896086, 9.533300256101054, 8.732444984746998, 8.848336989385341, -40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738], "episode_lengths": [76, 95, 10, 129, 56, 86, 69, 52, 2, 90, 21, 33, 6, 97, 41, 2, 64, 32, 87, 50, 42, 26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1974298178372785, "mean_inference_ms": 0.5105132038571033, "mean_action_processing_ms": 0.11556218727045062, "mean_env_wait_ms": 0.08206405762274675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032858848571777344, "StateBufferConnector_ms": 0.0036325454711914062, "ViewRequirementAgentConnector_ms": 0.062491416931152344}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7266, "num_agent_steps_trained": 7266, "num_env_steps_sampled": 7266, "num_env_steps_trained": 7266, "num_env_steps_sampled_this_iter": 1209, "num_env_steps_trained_this_iter": 1209, "timesteps_total": 7266, "num_steps_trained_this_iter": 1209, "agent_timesteps_total": 7266, "timers": {"training_iteration_time_ms": 5875.769, "load_time_ms": 1.312, "load_throughput": 922782.44, "learn_time_ms": 5612.981, "learn_throughput": 215.75, "synch_weights_time_ms": 2.316}, "counters": {"num_env_steps_sampled": 7266, "num_env_steps_trained": 7266, "num_agent_steps_sampled": 7266, "num_agent_steps_trained": 7266}, "done": false, "episodes_total": 120, "training_iteration": 6, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-39", "timestamp": 1678935579, "time_this_iter_s": 5.835568428039551, "time_total_s": 35.289392948150635, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4f8e0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f733d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802d1820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 35.289392948150635, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.9375, "ram_util_percent": 21.6125, "gpu_util_percent0": 0.635, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6821004759002981, "cur_lr": 0.0002381114270107754, "total_loss": 10.091950728600485, "policy_loss": 0.07769676437111277, "vf_loss": 10.0, "vf_explained_var": -0.001571123537264372, "kl": 0.0281311963307656, "entropy": 1.7642019804109608, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 7290.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 8508, "num_env_steps_trained": 8508, "num_agent_steps_sampled": 8508, "num_agent_steps_trained": 8508}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -42.1186594700992, "episode_reward_mean": -0.6872677820901082, "episode_len_mean": 64.41, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818], "episode_lengths": [26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915964630213626, "mean_inference_ms": 0.5011715448220952, "mean_action_processing_ms": 0.11353516180575542, "mean_env_wait_ms": 0.08044416742376949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003312349319458008, "StateBufferConnector_ms": 0.003880023956298828, "ViewRequirementAgentConnector_ms": 0.06287145614624023}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -42.1186594700992, "episode_reward_mean": -0.6872677820901082, "episode_len_mean": 64.41, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.40040667470755, -40.119670069781996, 9.81252523663065, 9.956345469591191, 9.738869952584372, 9.863889486398962, 9.716049881097057, -40.12330108729514, 9.855885425810369, 9.689042687024825, 8.101028044032898, 9.931470085754192, 7.1172991298716095, -40.012980876497956, 8.16761438030699, -40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818], "episode_lengths": [26, 15, 30, 102, 101, 104, 13, 59, 94, 102, 122, 56, 105, 31, 114, 2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915964630213626, "mean_inference_ms": 0.5011715448220952, "mean_action_processing_ms": 0.11353516180575542, "mean_env_wait_ms": 0.08044416742376949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003312349319458008, "StateBufferConnector_ms": 0.003880023956298828, "ViewRequirementAgentConnector_ms": 0.06287145614624023}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8508, "num_agent_steps_trained": 8508, "num_env_steps_sampled": 8508, "num_env_steps_trained": 8508, "num_env_steps_sampled_this_iter": 1242, "num_env_steps_trained_this_iter": 1242, "timesteps_total": 8508, "num_steps_trained_this_iter": 1242, "agent_timesteps_total": 8508, "timers": {"training_iteration_time_ms": 5880.528, "load_time_ms": 1.297, "load_throughput": 937109.728, "learn_time_ms": 5617.16, "learn_throughput": 216.378, "synch_weights_time_ms": 2.334}, "counters": {"num_env_steps_sampled": 8508, "num_env_steps_trained": 8508, "num_agent_steps_sampled": 8508, "num_agent_steps_trained": 8508}, "done": false, "episodes_total": 141, "training_iteration": 7, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-45", "timestamp": 1678935585, "time_this_iter_s": 5.915536642074585, "time_total_s": 41.20492959022522, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff65435dfd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff65435deb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801f1940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 41.20492959022522, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1375, "ram_util_percent": 21.6, "gpu_util_percent0": 0.7437499999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.023150713850447, "cur_lr": 0.00023811142701077537, "total_loss": 4.905664159477744, "policy_loss": 0.09394973866705202, "vf_loss": 4.8010214547758014, "vf_explained_var": 0.022652458329486033, "kl": 0.015005056156422876, "entropy": 1.6659320020777548, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 8445.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 9763, "num_env_steps_trained": 9763, "num_agent_steps_sampled": 9763, "num_agent_steps_trained": 9763}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.26565150719113506, "episode_len_mean": 66.22, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325], "episode_lengths": [2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902531299945716, "mean_inference_ms": 0.4987165812760241, "mean_action_processing_ms": 0.11293953266316838, "mean_env_wait_ms": 0.08001094202810012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003320932388305664, "StateBufferConnector_ms": 0.0038635730743408203, "ViewRequirementAgentConnector_ms": 0.0625772476196289}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.26565150719113506, "episode_len_mean": 66.22, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.00125208087013, 6.536934624995567, -40.067651159421516, 8.708792663814464, -40.001521140334106, 9.993576870660048, 9.593556800693888, 9.993505727291852, 9.946661568118323, 9.968174806752998, 9.941384283910564, 9.913467128171396, 9.793072034080756, 9.984191541133633, 8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325], "episode_lengths": [2, 127, 6, 61, 7, 3, 24, 38, 36, 72, 7, 44, 38, 52, 32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902531299945716, "mean_inference_ms": 0.4987165812760241, "mean_action_processing_ms": 0.11293953266316838, "mean_env_wait_ms": 0.08001094202810012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003320932388305664, "StateBufferConnector_ms": 0.0038635730743408203, "ViewRequirementAgentConnector_ms": 0.0625772476196289}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9763, "num_agent_steps_trained": 9763, "num_env_steps_sampled": 9763, "num_env_steps_trained": 9763, "num_env_steps_sampled_this_iter": 1255, "num_env_steps_trained_this_iter": 1255, "timesteps_total": 9763, "num_steps_trained_this_iter": 1255, "agent_timesteps_total": 9763, "timers": {"training_iteration_time_ms": 5899.641, "load_time_ms": 1.392, "load_throughput": 876927.145, "learn_time_ms": 5633.317, "learn_throughput": 216.635, "synch_weights_time_ms": 2.326}, "counters": {"num_env_steps_sampled": 9763, "num_env_steps_trained": 9763, "num_agent_steps_sampled": 9763, "num_agent_steps_trained": 9763}, "done": false, "episodes_total": 156, "training_iteration": 8, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-51", "timestamp": 1678935591, "time_this_iter_s": 6.041243314743042, "time_total_s": 47.24617290496826, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f98190>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654296670>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 47.24617290496826, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.037500000000001, "ram_util_percent": 21.6, "gpu_util_percent0": 0.6937500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0231507138504472, "cur_lr": 0.00023811142701077532, "total_loss": 2.9294853656727353, "policy_loss": 0.06754805179381812, "vf_loss": 2.8526706414489094, "vf_explained_var": 0.07842088992948885, "kl": 0.013072505745869292, "entropy": 1.468929131825765, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 9570.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 10915, "num_env_steps_trained": 10915, "num_agent_steps_sampled": 10915, "num_agent_steps_trained": 10915}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.3782290703257983, "episode_len_mean": 72.57, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167], "episode_lengths": [32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1895976227649063, "mean_inference_ms": 0.49819805478374235, "mean_action_processing_ms": 0.11278877312311827, "mean_env_wait_ms": 0.07987253487830832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033273696899414062, "StateBufferConnector_ms": 0.0034608840942382812, "ViewRequirementAgentConnector_ms": 0.06238842010498047}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.3782290703257983, "episode_len_mean": 72.57, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.688932664282987, 9.743776401579185, 5.4684634883042085, 8.963501082071707, 8.4566156213561, 7.737432875874786, 9.837428648167931, 6.757425180339011, 9.983192006944808, 9.970515810045049, -40.15600716377305, 9.946615683397301, 9.989995539138473, 9.766681285405818, 9.375518850634894, 9.86860932573521, -41.17506299788637, 9.998828516551365, 9.372241621165582, 9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167], "episode_lengths": [32, 91, 84, 89, 71, 114, 37, 156, 3, 6, 75, 12, 54, 55, 122, 48, 49, 5, 28, 20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1895976227649063, "mean_inference_ms": 0.49819805478374235, "mean_action_processing_ms": 0.11278877312311827, "mean_env_wait_ms": 0.07987253487830832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033273696899414062, "StateBufferConnector_ms": 0.0034608840942382812, "ViewRequirementAgentConnector_ms": 0.06238842010498047}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10915, "num_agent_steps_trained": 10915, "num_env_steps_sampled": 10915, "num_env_steps_trained": 10915, "num_env_steps_sampled_this_iter": 1152, "num_env_steps_trained_this_iter": 1152, "timesteps_total": 10915, "num_steps_trained_this_iter": 1152, "agent_timesteps_total": 10915, "timers": {"training_iteration_time_ms": 5871.533, "load_time_ms": 1.511, "load_throughput": 802848.467, "learn_time_ms": 5607.26, "learn_throughput": 216.287, "synch_weights_time_ms": 2.36}, "counters": {"num_env_steps_sampled": 10915, "num_env_steps_trained": 10915, "num_agent_steps_sampled": 10915, "num_agent_steps_trained": 10915}, "done": false, "episodes_total": 170, "training_iteration": 9, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_22-59-57", "timestamp": 1678935597, "time_this_iter_s": 5.653000116348267, "time_total_s": 52.89917302131653, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301f10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654301fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802d1820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 52.89917302131653, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.137500000000001, "ram_util_percent": 21.6, "gpu_util_percent0": 0.655, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0231507138504472, "cur_lr": 0.00023811142701077532, "total_loss": 0.36322065139754195, "policy_loss": 0.03724354506918678, "vf_loss": 0.32786637700698557, "vf_explained_var": 0.5619069114327431, "kl": 0.0018846392578039, "entropy": 1.3649095911118718, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 10650.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 12084, "num_env_steps_trained": 12084, "num_agent_steps_sampled": 12084, "num_agent_steps_trained": 12084}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.27526812620838775, "episode_len_mean": 72.95, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487], "episode_lengths": [20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18804500225112783, "mean_inference_ms": 0.49669217219415757, "mean_action_processing_ms": 0.1123798550362357, "mean_env_wait_ms": 0.07956907638439732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033071041107177734, "StateBufferConnector_ms": 0.0032563209533691406, "ViewRequirementAgentConnector_ms": 0.06249403953552246}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -43.001726359903735, "episode_reward_mean": -0.27526812620838775, "episode_len_mean": 72.95, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.996170763982759, 9.686111892768452, 5.386974122740443, 9.38797269081179, -40.153502217255564, -40.1313061747397, 9.479022588594045, 9.978758245091385, 9.97544368811463, 9.318738471628633, 8.961908657586816, 9.849569547240264, 9.75709379472774, 9.602855218556632, -40.01867296385208, 7.081905228223425, 8.692622141974752, 9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487], "episode_lengths": [20, 19, 181, 86, 26, 28, 29, 4, 53, 39, 127, 131, 126, 105, 2, 127, 165, 88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18804500225112783, "mean_inference_ms": 0.49669217219415757, "mean_action_processing_ms": 0.1123798550362357, "mean_env_wait_ms": 0.07956907638439732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033071041107177734, "StateBufferConnector_ms": 0.0032563209533691406, "ViewRequirementAgentConnector_ms": 0.06249403953552246}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12084, "num_agent_steps_trained": 12084, "num_env_steps_sampled": 12084, "num_env_steps_trained": 12084, "num_env_steps_sampled_this_iter": 1169, "num_env_steps_trained_this_iter": 1169, "timesteps_total": 12084, "num_steps_trained_this_iter": 1169, "agent_timesteps_total": 12084, "timers": {"training_iteration_time_ms": 5849.15, "load_time_ms": 1.632, "load_throughput": 740517.35, "learn_time_ms": 5586.422, "learn_throughput": 216.31, "synch_weights_time_ms": 2.357}, "counters": {"num_env_steps_sampled": 12084, "num_env_steps_trained": 12084, "num_agent_steps_sampled": 12084, "num_agent_steps_trained": 12084}, "done": false, "episodes_total": 189, "training_iteration": 10, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-02", "timestamp": 1678935602, "time_this_iter_s": 5.666546583175659, "time_total_s": 58.56571960449219, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc790>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdc8e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18027e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 58.56571960449219, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.0125, "ram_util_percent": 21.674999999999997, "gpu_util_percent0": 0.70625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5115753569252235, "cur_lr": 0.00023811142701077532, "total_loss": 2.9729807266362367, "policy_loss": -0.024770819275152116, "vf_loss": 2.981394287122059, "vf_explained_var": 0.2651877667222704, "kl": 0.03840806410535975, "entropy": 1.1767813024350575, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 11715.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 13229, "num_env_steps_trained": 13229, "num_agent_steps_sampled": 13229, "num_agent_steps_trained": 13229}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -43.134996767824354, "episode_reward_mean": -0.3362349631424791, "episode_len_mean": 71.72, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811], "episode_lengths": [88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18584556654743692, "mean_inference_ms": 0.4937925977973325, "mean_action_processing_ms": 0.11173515998656831, "mean_env_wait_ms": 0.07904950174623401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003213644027709961, "StateBufferConnector_ms": 0.00316619873046875, "ViewRequirementAgentConnector_ms": 0.06207728385925293}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -43.134996767824354, "episode_reward_mean": -0.3362349631424791, "episode_len_mean": 71.72, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.218490472361662, 8.998763373309021, 8.86330684271683, -42.1186594700992, 9.422801101735136, 9.66239484335518, -40.86937300014388, 8.856022470032116, 9.760986753872944, 8.592367449779513, 9.919635795024568, 9.984532812818014, 6.848001973956356, 9.930109611745738, 9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811], "episode_lengths": [88, 138, 119, 100, 96, 24, 27, 58, 19, 145, 121, 46, 138, 90, 2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18584556654743692, "mean_inference_ms": 0.4937925977973325, "mean_action_processing_ms": 0.11173515998656831, "mean_env_wait_ms": 0.07904950174623401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003213644027709961, "StateBufferConnector_ms": 0.00316619873046875, "ViewRequirementAgentConnector_ms": 0.06207728385925293}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13229, "num_agent_steps_trained": 13229, "num_env_steps_sampled": 13229, "num_env_steps_trained": 13229, "num_env_steps_sampled_this_iter": 1145, "num_env_steps_trained_this_iter": 1145, "timesteps_total": 13229, "num_steps_trained_this_iter": 1145, "agent_timesteps_total": 13229, "timers": {"training_iteration_time_ms": 5785.043, "load_time_ms": 1.635, "load_throughput": 733304.567, "learn_time_ms": 5529.413, "learn_throughput": 216.877, "synch_weights_time_ms": 2.389}, "counters": {"num_env_steps_sampled": 13229, "num_env_steps_trained": 13229, "num_agent_steps_sampled": 13229, "num_agent_steps_trained": 13229}, "done": false, "episodes_total": 206, "training_iteration": 11, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-08", "timestamp": 1678935608, "time_this_iter_s": 5.459328651428223, "time_total_s": 64.02504825592041, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042da60>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042deb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802d1820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 64.02504825592041, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.22857142857143, "ram_util_percent": 21.61428571428571, "gpu_util_percent0": 0.7985714285714286, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7673630353878352, "cur_lr": 0.00023811142701077534, "total_loss": 2.901956895322484, "policy_loss": -0.015682324825548658, "vf_loss": 2.906820572610698, "vf_explained_var": 0.3039526314712038, "kl": 0.01841560693749618, "entropy": 1.1844533287427004, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 12750.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 14342, "num_env_steps_trained": 14342, "num_agent_steps_sampled": 14342, "num_agent_steps_trained": 14342}, "sampler_results": {"episode_reward_max": 9.999359665435895, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.8634341097661823, "episode_len_mean": 70.76, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427], "episode_lengths": [2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18646083804395122, "mean_inference_ms": 0.4957312566851054, "mean_action_processing_ms": 0.11213949364713872, "mean_env_wait_ms": 0.07933043116803389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003364086151123047, "StateBufferConnector_ms": 0.003286600112915039, "ViewRequirementAgentConnector_ms": 0.0648348331451416}}, "episode_reward_max": 9.999359665435895, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.8634341097661823, "episode_len_mean": 70.76, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.985434741623848, 9.783349485550577, 9.999359665435895, -40.217722523548815, 9.998740315247348, -40.011357687521105, 9.364570701171111, 6.350260769177821, 9.822551838782207, 9.876689054571354, 9.66957004991422, 9.026724166986835, 9.999076950567654, 9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427], "episode_lengths": [2, 107, 6, 17, 2, 31, 117, 109, 34, 82, 137, 135, 3, 72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18646083804395122, "mean_inference_ms": 0.4957312566851054, "mean_action_processing_ms": 0.11213949364713872, "mean_env_wait_ms": 0.07933043116803389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003364086151123047, "StateBufferConnector_ms": 0.003286600112915039, "ViewRequirementAgentConnector_ms": 0.0648348331451416}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14342, "num_agent_steps_trained": 14342, "num_env_steps_sampled": 14342, "num_env_steps_trained": 14342, "num_env_steps_sampled_this_iter": 1113, "num_env_steps_trained_this_iter": 1113, "timesteps_total": 14342, "num_steps_trained_this_iter": 1113, "agent_timesteps_total": 14342, "timers": {"training_iteration_time_ms": 5805.814, "load_time_ms": 1.576, "load_throughput": 761683.322, "learn_time_ms": 5544.735, "learn_throughput": 216.44, "synch_weights_time_ms": 2.386}, "counters": {"num_env_steps_sampled": 14342, "num_env_steps_trained": 14342, "num_agent_steps_sampled": 14342, "num_agent_steps_trained": 14342}, "done": false, "episodes_total": 220, "training_iteration": 12, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-13", "timestamp": 1678935613, "time_this_iter_s": 5.5122106075286865, "time_total_s": 69.5372588634491, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6540d4640>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6540d4a00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180218c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 69.5372588634491, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.614285714285714, "ram_util_percent": 21.599999999999998, "gpu_util_percent0": 0.6985714285714285, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7673630353878353, "cur_lr": 0.00023811142701077537, "total_loss": 2.650000320304022, "policy_loss": -0.007763985349422592, "vf_loss": 2.6551507532753797, "vf_explained_var": 0.32885149049962686, "kl": 0.007238260156202137, "entropy": 1.0514494167688566, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 13845.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 15613, "num_env_steps_trained": 15613, "num_agent_steps_sampled": 15613, "num_agent_steps_trained": 15613}, "sampler_results": {"episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.5812194309383045, "episode_len_mean": 75.65, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334], "episode_lengths": [72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1858851019987897, "mean_inference_ms": 0.4951334433822755, "mean_action_processing_ms": 0.11196473778824091, "mean_env_wait_ms": 0.079261259606316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003345012664794922, "StateBufferConnector_ms": 0.0030863285064697266, "ViewRequirementAgentConnector_ms": 0.06534028053283691}}, "episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.5812194309383045, "episode_len_mean": 75.65, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.903152883515666, -40.1353065563558, 9.051229902678182, 9.633001828202119, -40.06753037596891, 8.755085153928913, -40.11791406765339, -41.50805041112818, 3.521806276297422, 9.804918061535503, 9.768034037732335, 9.895147378299542, -40.0339739280478, 9.7105910092549, 9.53857504792085, 9.87869320680188, -40.61718125918968, 9.709299700792151, 9.335932557288555, 7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334], "episode_lengths": [72, 7, 101, 56, 77, 79, 8, 60, 163, 30, 82, 60, 22, 90, 32, 28, 87, 83, 146, 175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1858851019987897, "mean_inference_ms": 0.4951334433822755, "mean_action_processing_ms": 0.11196473778824091, "mean_env_wait_ms": 0.079261259606316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003345012664794922, "StateBufferConnector_ms": 0.0030863285064697266, "ViewRequirementAgentConnector_ms": 0.06534028053283691}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15613, "num_agent_steps_trained": 15613, "num_env_steps_sampled": 15613, "num_env_steps_trained": 15613, "num_env_steps_sampled_this_iter": 1271, "num_env_steps_trained_this_iter": 1271, "timesteps_total": 15613, "num_steps_trained_this_iter": 1271, "agent_timesteps_total": 15613, "timers": {"training_iteration_time_ms": 5860.563, "load_time_ms": 1.558, "load_throughput": 773310.756, "learn_time_ms": 5594.001, "learn_throughput": 215.32, "synch_weights_time_ms": 2.352}, "counters": {"num_env_steps_sampled": 15613, "num_env_steps_trained": 15613, "num_agent_steps_sampled": 15613, "num_agent_steps_trained": 15613}, "done": false, "episodes_total": 233, "training_iteration": 13, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-20", "timestamp": 1678935620, "time_this_iter_s": 6.535746097564697, "time_total_s": 76.0730049610138, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b2a880>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769b2ac70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802eb550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 76.0730049610138, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 18.600000000000005, "ram_util_percent": 21.6, "gpu_util_percent0": 0.6211111111111111, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7673630353878353, "cur_lr": 0.0002381114270107754, "total_loss": 2.5004666477507143, "policy_loss": -0.009789384378675828, "vf_loss": 2.5061961252528513, "vf_explained_var": 0.3335721883857459, "kl": 0.008664326873558675, "entropy": 0.9255795972389087, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 15000.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 16840, "num_env_steps_trained": 16840, "num_agent_steps_sampled": 16840, "num_agent_steps_trained": 16840}, "sampler_results": {"episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.08983683237763745, "episode_len_mean": 75.09, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488], "episode_lengths": [175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18688892711749003, "mean_inference_ms": 0.49855812224883467, "mean_action_processing_ms": 0.11272113246540673, "mean_env_wait_ms": 0.07975558916915797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.003119945526123047, "ViewRequirementAgentConnector_ms": 0.06791043281555176}}, "episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": -0.08983683237763745, "episode_len_mean": 75.09, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.031408192958995, 9.479628392173609, -43.001726359903735, 9.43413624680325, 8.555022448992645, 7.087247394442583, 9.647115018879182, 9.870508720360313, 8.524708203140888, -40.400210831188915, -40.9442158912233, 9.679409701785339, 9.715185122540927, 9.409961042199054, -40.020306271470304, 5.009144733706532, 9.332643340718267, 7.578924622648167, 9.867566469461911, 9.660445470723195, 9.75721440697605, 9.840502863081879, 9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488], "episode_lengths": [175, 40, 107, 110, 83, 95, 28, 73, 136, 70, 111, 63, 72, 57, 18, 126, 101, 119, 63, 19, 53, 116, 30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18688892711749003, "mean_inference_ms": 0.49855812224883467, "mean_action_processing_ms": 0.11272113246540673, "mean_env_wait_ms": 0.07975558916915797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.003119945526123047, "ViewRequirementAgentConnector_ms": 0.06791043281555176}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16840, "num_agent_steps_trained": 16840, "num_env_steps_sampled": 16840, "num_env_steps_trained": 16840, "num_env_steps_sampled_this_iter": 1227, "num_env_steps_trained_this_iter": 1227, "timesteps_total": 16840, "num_steps_trained_this_iter": 1227, "agent_timesteps_total": 16840, "timers": {"training_iteration_time_ms": 5891.005, "load_time_ms": 1.489, "load_throughput": 811281.005, "learn_time_ms": 5614.664, "learn_throughput": 215.222, "synch_weights_time_ms": 2.354}, "counters": {"num_env_steps_sampled": 16840, "num_env_steps_trained": 16840, "num_agent_steps_sampled": 16840, "num_agent_steps_trained": 16840}, "done": false, "episodes_total": 252, "training_iteration": 14, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-26", "timestamp": 1678935626, "time_this_iter_s": 6.038076877593994, "time_total_s": 82.11108183860779, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769facac0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769faceb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 82.11108183860779, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.5625, "ram_util_percent": 21.6, "gpu_util_percent0": 0.6937500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7673630353878353, "cur_lr": 0.00023811142701077534, "total_loss": 1.9901152262752433, "policy_loss": -0.022284966485486144, "vf_loss": 2.006813033986957, "vf_explained_var": 0.4327000904650915, "kl": 0.010695442183160125, "entropy": 0.9367913293223532, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 16200.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200}, "sampler_results": {"episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 0.5440320945976587, "episode_len_mean": 70.34, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167], "episode_lengths": [30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885189023052382, "mean_inference_ms": 0.5032417910355932, "mean_action_processing_ms": 0.1136539689340918, "mean_env_wait_ms": 0.08051055682103601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0032155513763427734, "ViewRequirementAgentConnector_ms": 0.06823468208312988}}, "episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 0.5440320945976587, "episode_len_mean": 70.34, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.811552456474667, 9.629529705139753, -40.008179072961724, 8.690018727408724, 9.500406532295155, 9.943840510457045, -40.11709194240244, 9.820305678762555, 8.786459370580948, 9.953686503468179, 9.96874655685282, 9.821153722848226, 9.932628229490062, 9.460512934125582, 8.571499728293487, 9.66530518042189, 9.775854035590434, 3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167], "episode_lengths": [30, 106, 10, 95, 53, 12, 13, 56, 94, 20, 18, 78, 127, 61, 145, 62, 61, 135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885189023052382, "mean_inference_ms": 0.5032417910355932, "mean_action_processing_ms": 0.1136539689340918, "mean_env_wait_ms": 0.08051055682103601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.0032155513763427734, "ViewRequirementAgentConnector_ms": 0.06823468208312988}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200, "num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_env_steps_sampled_this_iter": 1360, "num_env_steps_trained_this_iter": 1360, "timesteps_total": 18200, "num_steps_trained_this_iter": 1360, "agent_timesteps_total": 18200, "timers": {"training_iteration_time_ms": 5924.823, "load_time_ms": 1.428, "load_throughput": 850444.721, "learn_time_ms": 5640.914, "learn_throughput": 215.267, "synch_weights_time_ms": 2.409}, "counters": {"num_env_steps_sampled": 18200, "num_env_steps_trained": 18200, "num_agent_steps_sampled": 18200, "num_agent_steps_trained": 18200}, "done": false, "episodes_total": 274, "training_iteration": 15, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-33", "timestamp": 1678935633, "time_this_iter_s": 6.669780254364014, "time_total_s": 88.7808620929718, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff655cbaa30>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff655cba9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802eb550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 88.7808620929718, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.37777777777778, "ram_util_percent": 21.666666666666668, "gpu_util_percent0": 0.6777777777777777, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7673630353878353, "cur_lr": 0.00023811142701077532, "total_loss": 1.5028677221318638, "policy_loss": -0.028707492089381923, "vf_loss": 1.5302901795585597, "vf_explained_var": 0.49185471998320685, "kl": 0.004746772505443544, "entropy": 0.8428808879521158, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 17370.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 19375, "num_env_steps_trained": 19375, "num_agent_steps_sampled": 19375, "num_agent_steps_trained": 19375}, "sampler_results": {"episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 0.9555227018573711, "episode_len_mean": 71.68, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491], "episode_lengths": [135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18950075889718015, "mean_inference_ms": 0.505823894748079, "mean_action_processing_ms": 0.11421955592695127, "mean_env_wait_ms": 0.08091239606262901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626585006713867, "StateBufferConnector_ms": 0.0032432079315185547, "ViewRequirementAgentConnector_ms": 0.06902289390563965}}, "episode_reward_max": 9.99708871317378, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 0.9555227018573711, "episode_len_mean": 71.68, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.5989179689601407, -43.134996767824354, 9.98524157737635, 8.271762861140306, 9.377468302340311, 9.994406594961015, 9.872889485688193, 9.8196489714611, 9.805216662146957, 9.966475474569044, 9.05359753210109, 5.514164482463894, 9.67240928562061, -40.00126480411358, -40.48211484011811, 9.827586510353324, 9.99708871317378, -40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491], "episode_lengths": [135, 143, 11, 46, 16, 5, 17, 82, 127, 88, 138, 131, 20, 11, 52, 79, 13, 45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18950075889718015, "mean_inference_ms": 0.505823894748079, "mean_action_processing_ms": 0.11421955592695127, "mean_env_wait_ms": 0.08091239606262901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003626585006713867, "StateBufferConnector_ms": 0.0032432079315185547, "ViewRequirementAgentConnector_ms": 0.06902289390563965}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19375, "num_agent_steps_trained": 19375, "num_env_steps_sampled": 19375, "num_env_steps_trained": 19375, "num_env_steps_sampled_this_iter": 1175, "num_env_steps_trained_this_iter": 1175, "timesteps_total": 19375, "num_steps_trained_this_iter": 1175, "agent_timesteps_total": 19375, "timers": {"training_iteration_time_ms": 5908.246, "load_time_ms": 1.587, "load_throughput": 762984.514, "learn_time_ms": 5623.844, "learn_throughput": 215.315, "synch_weights_time_ms": 2.428}, "counters": {"num_env_steps_sampled": 19375, "num_env_steps_trained": 19375, "num_agent_steps_sampled": 19375, "num_agent_steps_trained": 19375}, "done": false, "episodes_total": 291, "training_iteration": 16, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-38", "timestamp": 1678935638, "time_this_iter_s": 5.67002010345459, "time_total_s": 94.45088219642639, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ed4070>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed42b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 94.45088219642639, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.7125, "ram_util_percent": 21.625, "gpu_util_percent0": 0.69125, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3836815176939177, "cur_lr": 0.00023811142701077537, "total_loss": 0.8459305334914825, "policy_loss": -0.035591530029972396, "vf_loss": 0.8760564091507694, "vf_explained_var": 0.4739516076942285, "kl": 0.020138948001758014, "entropy": 0.8084938424577316, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 18510.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 20660, "num_env_steps_trained": 20660, "num_agent_steps_sampled": 20660, "num_agent_steps_trained": 20660}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 1.4688189800940499, "episode_len_mean": 73.39, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078], "episode_lengths": [45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19147942404036933, "mean_inference_ms": 0.5107099078930186, "mean_action_processing_ms": 0.11526381605363538, "mean_env_wait_ms": 0.08171186895623689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690004348754883, "StateBufferConnector_ms": 0.003396272659301758, "ViewRequirementAgentConnector_ms": 0.07111430168151855}}, "episode_reward_max": 10.0, "episode_reward_min": -46.252842235741554, "episode_reward_mean": 1.4688189800940499, "episode_len_mean": 73.39, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.217424172832054, 8.34925187107624, 9.988657208782264, -40.275039678425216, 7.531509678281989, 8.841618420270134, 8.704145058003625, 8.694397344196132, 9.89841546258657, 9.730108514948002, -46.252842235741554, 9.531993673420427, 4.314714629623791, 9.871958538235592, 9.19214981206673, -42.34396191567921, 8.898570782812476, 9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078], "episode_lengths": [45, 86, 49, 97, 64, 158, 72, 124, 52, 73, 165, 36, 132, 16, 135, 83, 106, 93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19147942404036933, "mean_inference_ms": 0.5107099078930186, "mean_action_processing_ms": 0.11526381605363538, "mean_env_wait_ms": 0.08171186895623689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690004348754883, "StateBufferConnector_ms": 0.003396272659301758, "ViewRequirementAgentConnector_ms": 0.07111430168151855}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20660, "num_agent_steps_trained": 20660, "num_env_steps_sampled": 20660, "num_env_steps_trained": 20660, "num_env_steps_sampled_this_iter": 1285, "num_env_steps_trained_this_iter": 1285, "timesteps_total": 20660, "num_steps_trained_this_iter": 1285, "agent_timesteps_total": 20660, "timers": {"training_iteration_time_ms": 5965.323, "load_time_ms": 1.548, "load_throughput": 784914.103, "learn_time_ms": 5669.987, "learn_throughput": 214.321, "synch_weights_time_ms": 2.406}, "counters": {"num_env_steps_sampled": 20660, "num_env_steps_trained": 20660, "num_agent_steps_sampled": 20660, "num_agent_steps_trained": 20660}, "done": false, "episodes_total": 308, "training_iteration": 17, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-45", "timestamp": 1678935645, "time_this_iter_s": 6.486297845840454, "time_total_s": 100.93718004226685, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4f610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d4f5b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 100.93718004226685, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.625, "ram_util_percent": 21.6, "gpu_util_percent0": 0.7025, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5755222765408766, "cur_lr": 0.00023811142701077532, "total_loss": 2.122068795702265, "policy_loss": -0.05016012836779867, "vf_loss": 2.1703049501195726, "vf_explained_var": 0.33470332066218056, "kl": 0.006889904784121825, "entropy": 0.7298475449993497, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 19635.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 21805, "num_env_steps_trained": 21805, "num_agent_steps_sampled": 21805, "num_agent_steps_trained": 21805}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -42.31608030156088, "episode_reward_mean": 2.3447963668134686, "episode_len_mean": 69.91, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666], "episode_lengths": [93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19156120278197222, "mean_inference_ms": 0.5114600855191955, "mean_action_processing_ms": 0.11541316328329156, "mean_env_wait_ms": 0.08184556035316284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579854965209961, "StateBufferConnector_ms": 0.003256082534790039, "ViewRequirementAgentConnector_ms": 0.06760644912719727}}, "episode_reward_max": 10.0, "episode_reward_min": -42.31608030156088, "episode_reward_mean": 2.3447963668134686, "episode_len_mean": 69.91, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.2892770720382, 8.0517671793766, 7.7136667425282965, 4.103450653159196, 9.556004128060467, 6.310703649082628, 9.981137953494633, 6.929276185947334, 9.870930434102567, 8.474970450092048, 9.976390253606803, -40.05492002598538, -40.11355620892196, -42.31608030156088, 9.830972857661221, 9.813897007396509, 9.65561884675701, 9.460328116733402, 9.501631750553413, -40.02190201727385, 8.71749326837019, 9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666], "episode_lengths": [93, 121, 92, 104, 150, 126, 8, 105, 36, 48, 8, 13, 61, 121, 57, 42, 140, 106, 117, 11, 134, 32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19156120278197222, "mean_inference_ms": 0.5114600855191955, "mean_action_processing_ms": 0.11541316328329156, "mean_env_wait_ms": 0.08184556035316284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579854965209961, "StateBufferConnector_ms": 0.003256082534790039, "ViewRequirementAgentConnector_ms": 0.06760644912719727}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21805, "num_agent_steps_trained": 21805, "num_env_steps_sampled": 21805, "num_env_steps_trained": 21805, "num_env_steps_sampled_this_iter": 1145, "num_env_steps_trained_this_iter": 1145, "timesteps_total": 21805, "num_steps_trained_this_iter": 1145, "agent_timesteps_total": 21805, "timers": {"training_iteration_time_ms": 5903.413, "load_time_ms": 1.437, "load_throughput": 838109.133, "learn_time_ms": 5614.132, "learn_throughput": 214.494, "synch_weights_time_ms": 2.443}, "counters": {"num_env_steps_sampled": 21805, "num_env_steps_trained": 21805, "num_agent_steps_sampled": 21805, "num_agent_steps_trained": 21805}, "done": false, "episodes_total": 325, "training_iteration": 18, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-50", "timestamp": 1678935650, "time_this_iter_s": 5.420591592788696, "time_total_s": 106.35777163505554, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769facac0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769fac280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 106.35777163505554, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.100000000000001, "ram_util_percent": 21.6, "gpu_util_percent0": 0.73, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5755222765408766, "cur_lr": 0.00023811142701077537, "total_loss": 2.1533352832389503, "policy_loss": -0.031382579719408964, "vf_loss": 2.171881672608891, "vf_explained_var": 0.2818604917098314, "kl": 0.026042594713343994, "entropy": 0.7693848091695044, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 20745.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 23063, "num_env_steps_trained": 23063, "num_agent_steps_sampled": 23063, "num_agent_steps_trained": 23063}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -42.52815865428622, "episode_reward_mean": 2.464679525542012, "episode_len_mean": 65.56, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498], "episode_lengths": [32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19166464167605035, "mean_inference_ms": 0.5116646924764545, "mean_action_processing_ms": 0.11543250445396923, "mean_env_wait_ms": 0.0818953827457534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610372543334961, "StateBufferConnector_ms": 0.0032835006713867188, "ViewRequirementAgentConnector_ms": 0.06606674194335938}}, "episode_reward_max": 10.0, "episode_reward_min": -42.52815865428622, "episode_reward_mean": 2.464679525542012, "episode_len_mean": 65.56, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.991177825530949, 8.732698836531268, -40.01841567636276, 4.370142957273131, 9.620719517945835, 9.671672409521488, 9.994093834903266, -40.04662895409888, 9.979668288165618, 9.9755435875425, 4.905795206216593, 9.396028927552889, -40.09655319209881, 9.892716706629837, 9.725845708899143, 9.062631557832868, 9.86489607836964, 9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498], "episode_lengths": [32, 46, 50, 47, 79, 79, 18, 80, 53, 34, 168, 63, 31, 61, 32, 137, 79, 13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19166464167605035, "mean_inference_ms": 0.5116646924764545, "mean_action_processing_ms": 0.11543250445396923, "mean_env_wait_ms": 0.0818953827457534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003610372543334961, "StateBufferConnector_ms": 0.0032835006713867188, "ViewRequirementAgentConnector_ms": 0.06606674194335938}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23063, "num_agent_steps_trained": 23063, "num_env_steps_sampled": 23063, "num_env_steps_trained": 23063, "num_env_steps_sampled_this_iter": 1258, "num_env_steps_trained_this_iter": 1258, "timesteps_total": 23063, "num_steps_trained_this_iter": 1258, "agent_timesteps_total": 23063, "timers": {"training_iteration_time_ms": 5946.995, "load_time_ms": 1.34, "load_throughput": 906287.775, "learn_time_ms": 5654.568, "learn_throughput": 214.835, "synch_weights_time_ms": 2.416}, "counters": {"num_env_steps_sampled": 23063, "num_env_steps_trained": 23063, "num_agent_steps_sampled": 23063, "num_agent_steps_trained": 23063}, "done": false, "episodes_total": 346, "training_iteration": 19, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-00-57", "timestamp": 1678935657, "time_this_iter_s": 6.0883543491363525, "time_total_s": 112.4461259841919, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4dc0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce41c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 112.4461259841919, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.125, "ram_util_percent": 21.6, "gpu_util_percent0": 0.78125, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.99619528798977, "episode_reward_min": -42.53742379278942, "episode_reward_mean": -13.904985899357087, "episode_len_mean": 41.8, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.71974888461745, 8.514023587655771, 9.983926196959525, 9.978225714407264, 9.977798747933441, -41.67133043502523, -40.11023967581941, -40.016671257709646, -40.001741440925336, 9.99619528798977, 7.7762443753213875, -40.012840917101634, -42.53742379278942, 9.84010696907277, -40.01081073494301], "episode_lengths": [10, 95, 13, 4, 16, 111, 58, 39, 3, 27, 116, 14, 93, 11, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15973969837667729, "mean_inference_ms": 0.43913370816698716, "mean_action_processing_ms": 0.10004579976641956, "mean_env_wait_ms": 0.07101638314135658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004024505615234375, "StateBufferConnector_ms": 0.007682641347249349, "ViewRequirementAgentConnector_ms": 0.06938378016153972}, "num_agent_steps_sampled_this_iter": 627, "num_env_steps_sampled_this_iter": 627, "timesteps_this_iter": 627, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.863283414811315, "cur_lr": 0.00023811142701077532, "total_loss": 3.466684360211449, "policy_loss": -0.06513984167859668, "vf_loss": 3.5204617666213642, "vf_explained_var": 0.37459402407918657, "kl": 0.01578299947602017, "entropy": 0.8090192375012807, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 24198, "num_env_steps_trained": 24198, "num_agent_steps_sampled": 24198, "num_agent_steps_trained": 24198}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -45.37655578345621, "episode_reward_mean": 1.7464211623214925, "episode_len_mean": 66.02, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483], "episode_lengths": [13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19109002710908343, "mean_inference_ms": 0.5103157073404511, "mean_action_processing_ms": 0.11513872255321196, "mean_env_wait_ms": 0.08167794581193714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0032792091369628906, "ViewRequirementAgentConnector_ms": 0.06629252433776855}}, "episode_reward_max": 10.0, "episode_reward_min": -45.37655578345621, "episode_reward_mean": 1.7464211623214925, "episode_len_mean": 66.02, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.814609013369184, 9.77468037216981, 9.595171692430332, 9.496877947743922, -40.73882066026788, 9.62332980408084, 9.183169940022914, 9.720789670767513, 9.526612408667141, 9.891894492076032, 9.95885330436167, -40.60931273481668, 9.945977037648703, 8.814605516683411, 9.249732274956651, 9.62372542287183, 9.851148350450165, 9.308652425038966, 3.4543296987134777, 9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483], "episode_lengths": [13, 12, 111, 73, 45, 92, 32, 21, 128, 9, 68, 62, 44, 162, 88, 87, 43, 50, 113, 82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19109002710908343, "mean_inference_ms": 0.5103157073404511, "mean_action_processing_ms": 0.11513872255321196, "mean_env_wait_ms": 0.08167794581193714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035181045532226562, "StateBufferConnector_ms": 0.0032792091369628906, "ViewRequirementAgentConnector_ms": 0.06629252433776855}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24198, "num_agent_steps_trained": 24198, "num_env_steps_sampled": 24198, "num_env_steps_trained": 24198, "num_env_steps_sampled_this_iter": 1135, "num_env_steps_trained_this_iter": 1135, "timesteps_total": 24198, "num_steps_trained_this_iter": 1135, "agent_timesteps_total": 24198, "timers": {"training_iteration_time_ms": 5942.575, "load_time_ms": 1.16, "load_throughput": 1044630.824, "learn_time_ms": 5644.556, "learn_throughput": 214.614, "synch_weights_time_ms": 2.396}, "counters": {"num_env_steps_sampled": 24198, "num_env_steps_trained": 24198, "num_agent_steps_sampled": 24198, "num_agent_steps_trained": 24198}, "done": false, "episodes_total": 363, "training_iteration": 20, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-03", "timestamp": 1678935663, "time_this_iter_s": 6.043039083480835, "time_total_s": 118.48916506767273, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769fac820>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f730d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801ebe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 118.48916506767273, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.725, "ram_util_percent": 21.6625, "gpu_util_percent0": 0.69625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.863283414811315, "cur_lr": 0.00023811142701077534, "total_loss": 1.7759777019172698, "policy_loss": -0.018384461445515757, "vf_loss": 1.789465429338098, "vf_explained_var": 0.37485899329185485, "kl": 0.008034693510001559, "entropy": 0.7291875266277038, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 22935.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 25412, "num_env_steps_trained": 25412, "num_agent_steps_sampled": 25412, "num_agent_steps_trained": 25412}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -45.37655578345621, "episode_reward_mean": 1.68235147908702, "episode_len_mean": 65.63, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593], "episode_lengths": [82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915046980797128, "mean_inference_ms": 0.5116737879033257, "mean_action_processing_ms": 0.11542490615895265, "mean_env_wait_ms": 0.08191152637073315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034770965576171875, "StateBufferConnector_ms": 0.003438234329223633, "ViewRequirementAgentConnector_ms": 0.06624197959899902}}, "episode_reward_max": 10.0, "episode_reward_min": -45.37655578345621, "episode_reward_mean": 1.68235147908702, "episode_len_mean": 65.63, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.31365380891104, 8.299982078763541, 8.822418975124435, 9.520325072183098, 9.502590125973374, 9.655887837706361, 9.966131139319536, 9.862057648719224, 9.773384904569491, 9.113030826011837, 7.471020886420366, 10.0, 8.261933065713805, -40.16044260340244, 9.10785627233571, 9.636182736484132, 9.957215896747382, 9.87394885488509, 9.705910437941158, 8.980061479715003, 8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593], "episode_lengths": [82, 29, 141, 51, 29, 47, 45, 71, 31, 34, 142, 1, 95, 42, 51, 26, 25, 60, 134, 54, 145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915046980797128, "mean_inference_ms": 0.5116737879033257, "mean_action_processing_ms": 0.11542490615895265, "mean_env_wait_ms": 0.08191152637073315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034770965576171875, "StateBufferConnector_ms": 0.003438234329223633, "ViewRequirementAgentConnector_ms": 0.06624197959899902}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25412, "num_agent_steps_trained": 25412, "num_env_steps_sampled": 25412, "num_env_steps_trained": 25412, "num_env_steps_sampled_this_iter": 1214, "num_env_steps_trained_this_iter": 1214, "timesteps_total": 25412, "num_steps_trained_this_iter": 1214, "agent_timesteps_total": 25412, "timers": {"training_iteration_time_ms": 5984.881, "load_time_ms": 1.288, "load_throughput": 946036.317, "learn_time_ms": 5683.234, "learn_throughput": 214.367, "synch_weights_time_ms": 2.368}, "counters": {"num_env_steps_sampled": 25412, "num_env_steps_trained": 25412, "num_agent_steps_sampled": 25412, "num_agent_steps_trained": 25412}, "done": false, "episodes_total": 382, "training_iteration": 21, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-09", "timestamp": 1678935669, "time_this_iter_s": 5.8803911209106445, "time_total_s": 124.36955618858337, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b2a490>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769b2a640>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 124.36955618858337, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.412499999999998, "ram_util_percent": 21.6375, "gpu_util_percent0": 0.635, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8632834148113149, "cur_lr": 0.00023811142701077534, "total_loss": 3.507910898383818, "policy_loss": -0.043871250654023794, "vf_loss": 3.548619482762158, "vf_explained_var": 0.03682667693448445, "kl": 0.00624202388519172, "entropy": 0.7958678453214585, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 24120.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 26762, "num_env_steps_trained": 26762, "num_agent_steps_sampled": 26762, "num_agent_steps_trained": 26762}, "sampler_results": {"episode_reward_max": 9.999445862983857, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 0.3718191906609597, "episode_len_mean": 67.23, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426], "episode_lengths": [145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19121040663801758, "mean_inference_ms": 0.511544810284239, "mean_action_processing_ms": 0.11540460393915446, "mean_env_wait_ms": 0.08186134281069478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0031843185424804688, "ViewRequirementAgentConnector_ms": 0.0640726089477539}}, "episode_reward_max": 9.999445862983857, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 0.3718191906609597, "episode_len_mean": 67.23, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.565250738037955, 8.181239955903633, 9.331089691248948, -40.307464287681995, 8.362699952191209, 6.388591931416078, 9.676702654805872, 9.810881827778253, -8.089648831757863, 6.890673261472829, 9.275100953070172, 6.741949919436611, 8.898957659656837, 9.647818367648362, 3.430466829490028, 9.425169681141508, 7.689776182692153, -40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426], "episode_lengths": [145, 101, 137, 24, 86, 128, 46, 93, 111, 57, 37, 159, 64, 43, 74, 57, 73, 11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19121040663801758, "mean_inference_ms": 0.511544810284239, "mean_action_processing_ms": 0.11540460393915446, "mean_env_wait_ms": 0.08186134281069478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0031843185424804688, "ViewRequirementAgentConnector_ms": 0.0640726089477539}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26762, "num_agent_steps_trained": 26762, "num_env_steps_sampled": 26762, "num_env_steps_trained": 26762, "num_env_steps_sampled_this_iter": 1350, "num_env_steps_trained_this_iter": 1350, "timesteps_total": 26762, "num_steps_trained_this_iter": 1350, "agent_timesteps_total": 26762, "timers": {"training_iteration_time_ms": 6116.131, "load_time_ms": 1.287, "load_throughput": 965065.223, "learn_time_ms": 5812.025, "learn_throughput": 213.695, "synch_weights_time_ms": 2.384}, "counters": {"num_env_steps_sampled": 26762, "num_env_steps_trained": 26762, "num_agent_steps_sampled": 26762, "num_agent_steps_trained": 26762}, "done": false, "episodes_total": 402, "training_iteration": 22, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-15", "timestamp": 1678935675, "time_this_iter_s": 6.824616193771362, "time_total_s": 131.19417238235474, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042dc40>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042dca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 131.19417238235474, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.988888888888889, "ram_util_percent": 21.6, "gpu_util_percent0": 0.7088888888888889, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.863283414811315, "cur_lr": 0.00023811142701077532, "total_loss": 3.1956695884729185, "policy_loss": -0.05275737281060881, "vf_loss": 3.247909390066828, "vf_explained_var": 0.3270626272316332, "kl": 0.002864082122363887, "entropy": 0.6989598137774953, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 25290.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 27938, "num_env_steps_trained": 27938, "num_agent_steps_sampled": 27938, "num_agent_steps_trained": 27938}, "sampler_results": {"episode_reward_max": 9.999445862983857, "episode_reward_min": -48.423452624912954, "episode_reward_mean": -0.14697463532388036, "episode_len_mean": 64.64, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695], "episode_lengths": [11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19140353628767898, "mean_inference_ms": 0.5119448256640933, "mean_action_processing_ms": 0.11547172805053481, "mean_env_wait_ms": 0.0819271408104506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505229949951172, "StateBufferConnector_ms": 0.003282308578491211, "ViewRequirementAgentConnector_ms": 0.06474924087524414}}, "episode_reward_max": 9.999445862983857, "episode_reward_min": -48.423452624912954, "episode_reward_mean": -0.14697463532388036, "episode_len_mean": 64.64, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.247942218047704, 9.788992468535614, 9.6840780554377, -40.02327494033686, 9.486023815887693, 9.97023597665666, 8.68551897695187, 9.72203182121627, 9.98116042340944, 9.620845933509774, -40.37787630448225, 9.559496341358942, 9.999445862983857, -42.52815865428622, -40.00301739631322, 9.66200013112422, 9.748497645019452, 7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695], "episode_lengths": [11, 118, 31, 36, 77, 58, 85, 84, 20, 125, 40, 71, 4, 139, 3, 83, 32, 84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19140353628767898, "mean_inference_ms": 0.5119448256640933, "mean_action_processing_ms": 0.11547172805053481, "mean_env_wait_ms": 0.0819271408104506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003505229949951172, "StateBufferConnector_ms": 0.003282308578491211, "ViewRequirementAgentConnector_ms": 0.06474924087524414}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27938, "num_agent_steps_trained": 27938, "num_env_steps_sampled": 27938, "num_env_steps_trained": 27938, "num_env_steps_sampled_this_iter": 1176, "num_env_steps_trained_this_iter": 1176, "timesteps_total": 27938, "num_steps_trained_this_iter": 1176, "agent_timesteps_total": 27938, "timers": {"training_iteration_time_ms": 6021.147, "load_time_ms": 1.474, "load_throughput": 836214.765, "learn_time_ms": 5725.734, "learn_throughput": 215.256, "synch_weights_time_ms": 2.412}, "counters": {"num_env_steps_sampled": 27938, "num_env_steps_trained": 27938, "num_agent_steps_sampled": 27938, "num_agent_steps_trained": 27938}, "done": false, "episodes_total": 419, "training_iteration": 23, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-21", "timestamp": 1678935681, "time_this_iter_s": 5.585681676864624, "time_total_s": 136.77985405921936, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6542964f0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654296970>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801a8f70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 136.77985405921936, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.137500000000001, "ram_util_percent": 21.6, "gpu_util_percent0": 0.70625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.43164170740565744, "cur_lr": 0.00023811142701077537, "total_loss": 1.1011690827625817, "policy_loss": -0.03438350563808307, "vf_loss": 1.133959839467103, "vf_explained_var": 0.34374853954082585, "kl": 0.008109575912829143, "entropy": 0.6820661535834879, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 26445.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 29257, "num_env_steps_trained": 29257, "num_agent_steps_sampled": 29257, "num_agent_steps_trained": 29257}, "sampler_results": {"episode_reward_max": 9.997895938793844, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 1.5506566055059765, "episode_len_mean": 67.66, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692], "episode_lengths": [84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910709962900466, "mean_inference_ms": 0.5113904500619431, "mean_action_processing_ms": 0.1153510934365825, "mean_env_wait_ms": 0.0818259983374801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034346580505371094, "StateBufferConnector_ms": 0.003169536590576172, "ViewRequirementAgentConnector_ms": 0.06439781188964844}}, "episode_reward_max": 9.997895938793844, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 1.5506566055059765, "episode_len_mean": 67.66, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.176335206478386, 9.735062445929923, 9.831362230289116, 9.863135261640355, 9.95593605470152, 8.138213784435083, 9.880997260293146, 9.59552132667143, -41.328296468457786, 9.801161985599498, 9.088376389805061, 9.250727173548455, -45.37655578345621, 9.401806891975545, 9.768517563849606, 9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692], "episode_lengths": [84, 58, 48, 35, 9, 103, 43, 29, 56, 107, 127, 94, 70, 130, 13, 132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1910709962900466, "mean_inference_ms": 0.5113904500619431, "mean_action_processing_ms": 0.1153510934365825, "mean_env_wait_ms": 0.0818259983374801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034346580505371094, "StateBufferConnector_ms": 0.003169536590576172, "ViewRequirementAgentConnector_ms": 0.06439781188964844}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29257, "num_agent_steps_trained": 29257, "num_env_steps_sampled": 29257, "num_env_steps_trained": 29257, "num_env_steps_sampled_this_iter": 1319, "num_env_steps_trained_this_iter": 1319, "timesteps_total": 29257, "num_steps_trained_this_iter": 1319, "agent_timesteps_total": 29257, "timers": {"training_iteration_time_ms": 6060.707, "load_time_ms": 1.529, "load_throughput": 812288.24, "learn_time_ms": 5774.996, "learn_throughput": 215.013, "synch_weights_time_ms": 2.423}, "counters": {"num_env_steps_sampled": 29257, "num_env_steps_trained": 29257, "num_agent_steps_sampled": 29257, "num_agent_steps_trained": 29257}, "done": false, "episodes_total": 436, "training_iteration": 24, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-27", "timestamp": 1678935687, "time_this_iter_s": 6.434107780456543, "time_total_s": 143.2139618396759, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6540d4580>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6540d45e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18027e040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 143.2139618396759, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.988888888888887, "ram_util_percent": 21.6, "gpu_util_percent0": 0.6888888888888889, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4316417074056575, "cur_lr": 0.00023811142701077532, "total_loss": 0.7088923459154155, "policy_loss": -0.0521902955110584, "vf_loss": 0.7606881889698672, "vf_explained_var": 0.3151125576950255, "kl": 0.0046118222112367995, "entropy": 0.5707015722706205, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 27585.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 30381, "num_env_steps_trained": 30381, "num_agent_steps_sampled": 30381, "num_agent_steps_trained": 30381}, "sampler_results": {"episode_reward_max": 9.997895938793844, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 1.5823781434785211, "episode_len_mean": 68.84, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668], "episode_lengths": [132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19101686599207526, "mean_inference_ms": 0.5115693747089456, "mean_action_processing_ms": 0.1153681207235258, "mean_env_wait_ms": 0.08183845966742583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034165382385253906, "StateBufferConnector_ms": 0.003108978271484375, "ViewRequirementAgentConnector_ms": 0.06432247161865234}}, "episode_reward_max": 9.997895938793844, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 1.5823781434785211, "episode_len_mean": 68.84, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.599645150123468, 9.506239950980262, -40.73702357392283, -40.194219107353874, -40.42934558446941, 4.473243165239252, 9.945732047801489, 9.864541869652019, 9.726015498117777, 9.997895938793844, 9.995093966044697, -10.684494258426483, 9.661274304767872, 9.898492461036666, 9.271598452016486, 9.345228510320915, 9.188388962544918, 9.408595738013318, 9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668], "episode_lengths": [132, 77, 69, 63, 15, 94, 41, 22, 38, 14, 27, 109, 127, 81, 72, 50, 135, 135, 2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19101686599207526, "mean_inference_ms": 0.5115693747089456, "mean_action_processing_ms": 0.1153681207235258, "mean_env_wait_ms": 0.08183845966742583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034165382385253906, "StateBufferConnector_ms": 0.003108978271484375, "ViewRequirementAgentConnector_ms": 0.06432247161865234}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30381, "num_agent_steps_trained": 30381, "num_env_steps_sampled": 30381, "num_env_steps_trained": 30381, "num_env_steps_sampled_this_iter": 1124, "num_env_steps_trained_this_iter": 1124, "timesteps_total": 30381, "num_steps_trained_this_iter": 1124, "agent_timesteps_total": 30381, "timers": {"training_iteration_time_ms": 5945.283, "load_time_ms": 1.6, "load_throughput": 761174.849, "learn_time_ms": 5670.27, "learn_throughput": 214.822, "synch_weights_time_ms": 2.343}, "counters": {"num_env_steps_sampled": 30381, "num_env_steps_trained": 30381, "num_agent_steps_sampled": 30381, "num_agent_steps_trained": 30381}, "done": false, "episodes_total": 451, "training_iteration": 25, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-33", "timestamp": 1678935693, "time_this_iter_s": 5.515941858291626, "time_total_s": 148.72990369796753, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6dfd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f6d7f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 148.72990369796753, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.728571428571428, "ram_util_percent": 21.685714285714283, "gpu_util_percent0": 0.7428571428571428, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.21582085370282872, "cur_lr": 0.00023811142701077537, "total_loss": 1.4911062246109916, "policy_loss": -0.034344520916541416, "vf_loss": 1.5243713444785383, "vf_explained_var": 0.3662799771524902, "kl": 0.014475812134245892, "entropy": 0.7310846620135837, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 28695.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 31652, "num_env_steps_trained": 31652, "num_agent_steps_sampled": 31652, "num_agent_steps_trained": 31652}, "sampler_results": {"episode_reward_max": 9.997320726399899, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 2.1643401020878117, "episode_len_mean": 68.54, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013], "episode_lengths": [2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19131407357445998, "mean_inference_ms": 0.5128667139745632, "mean_action_processing_ms": 0.11559930151693643, "mean_env_wait_ms": 0.08205649931265004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0031540393829345703, "ViewRequirementAgentConnector_ms": 0.06361865997314453}}, "episode_reward_max": 9.997320726399899, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 2.1643401020878117, "episode_len_mean": 68.54, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.98869046478473, -40.071224802891884, 9.988942699002834, -40.30982660103139, 8.779365636114711, 9.964832035697311, 9.873411921866625, 9.97405407283086, 0.6229254480499229, 8.378656075537526, 6.518281018935374, 9.209852187517983, 9.38751906840593, 9.694074786168827, 9.959942317222986, 9.174541835138076, -40.61085299162337, 8.151240991800488, 9.992047613400425, 9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013], "episode_lengths": [2, 16, 2, 40, 29, 6, 49, 15, 109, 118, 103, 79, 46, 19, 11, 97, 83, 148, 39, 140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19131407357445998, "mean_inference_ms": 0.5128667139745632, "mean_action_processing_ms": 0.11559930151693643, "mean_env_wait_ms": 0.08205649931265004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0031540393829345703, "ViewRequirementAgentConnector_ms": 0.06361865997314453}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31652, "num_agent_steps_trained": 31652, "num_env_steps_sampled": 31652, "num_env_steps_trained": 31652, "num_env_steps_sampled_this_iter": 1271, "num_env_steps_trained_this_iter": 1271, "timesteps_total": 31652, "num_steps_trained_this_iter": 1271, "agent_timesteps_total": 31652, "timers": {"training_iteration_time_ms": 5984.287, "load_time_ms": 1.464, "load_throughput": 838819.805, "learn_time_ms": 5708.954, "learn_throughput": 215.048, "synch_weights_time_ms": 2.308}, "counters": {"num_env_steps_sampled": 31652, "num_env_steps_trained": 31652, "num_agent_steps_sampled": 31652, "num_agent_steps_trained": 31652}, "done": false, "episodes_total": 469, "training_iteration": 26, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-39", "timestamp": 1678935699, "time_this_iter_s": 6.059854507446289, "time_total_s": 154.78975820541382, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18044b430>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18044ba90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801cab80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 154.78975820541382, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1375, "ram_util_percent": 21.6875, "gpu_util_percent0": 0.71, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.21582085370282875, "cur_lr": 0.00023811142701077534, "total_loss": 3.0232506694221817, "policy_loss": -0.0355632578735953, "vf_loss": 3.0550511866843597, "vf_explained_var": 0.36213533609837023, "kl": 0.02750777736755073, "entropy": 0.7772849734167795, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 29835.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 32844, "num_env_steps_trained": 32844, "num_agent_steps_sampled": 32844, "num_agent_steps_trained": 32844}, "sampler_results": {"episode_reward_max": 9.997512967371193, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 2.1617278905297614, "episode_len_mean": 70.35, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874], "episode_lengths": [140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19155845482506442, "mean_inference_ms": 0.5136216405564277, "mean_action_processing_ms": 0.11571110131328641, "mean_env_wait_ms": 0.08219610282161428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.0030243396759033203, "ViewRequirementAgentConnector_ms": 0.06440615653991699}}, "episode_reward_max": 9.997512967371193, "episode_reward_min": -48.423452624912954, "episode_reward_mean": 2.1617278905297614, "episode_len_mean": 70.35, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.102845829098296, -4.433420128127885, 0.7148907617799409, 9.889166900532611, 9.555956212553662, 9.645118864206786, 9.59101904299418, 5.200221905085252, 9.994138857349405, -48.423452624912954, 8.869307898017585, 9.986973218512334, -40.351552091468946, 9.907711403788426, 5.567166991865714, -40.95457721190374, 6.942060978486363, -1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874], "episode_lengths": [140, 86, 68, 17, 22, 25, 67, 101, 13, 92, 74, 55, 69, 124, 65, 29, 111, 52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19155845482506442, "mean_inference_ms": 0.5136216405564277, "mean_action_processing_ms": 0.11571110131328641, "mean_env_wait_ms": 0.08219610282161428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.0030243396759033203, "ViewRequirementAgentConnector_ms": 0.06440615653991699}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32844, "num_agent_steps_trained": 32844, "num_env_steps_sampled": 32844, "num_env_steps_trained": 32844, "num_env_steps_sampled_this_iter": 1192, "num_env_steps_trained_this_iter": 1192, "timesteps_total": 32844, "num_steps_trained_this_iter": 1192, "agent_timesteps_total": 32844, "timers": {"training_iteration_time_ms": 5913.301, "load_time_ms": 1.656, "load_throughput": 735851.283, "learn_time_ms": 5649.094, "learn_throughput": 215.681, "synch_weights_time_ms": 2.323}, "counters": {"num_env_steps_sampled": 32844, "num_env_steps_trained": 32844, "num_agent_steps_sampled": 32844, "num_agent_steps_trained": 32844}, "done": false, "episodes_total": 488, "training_iteration": 27, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-45", "timestamp": 1678935705, "time_this_iter_s": 5.7759928703308105, "time_total_s": 160.56575107574463, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e79d90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e79340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802eb550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 160.56575107574463, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1875, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7075, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.32373128055424305, "cur_lr": 0.00023811142701077537, "total_loss": 3.4039328972413205, "policy_loss": -0.09156428025724987, "vf_loss": 3.4939437225495933, "vf_explained_var": 0.06310254544019699, "kl": 0.010310981665864666, "entropy": 0.6380405446638664, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 30990.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 34152, "num_env_steps_trained": 34152, "num_agent_steps_sampled": 34152, "num_agent_steps_trained": 34152}, "sampler_results": {"episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 2.804150191204162, "episode_len_mean": 71.85, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339], "episode_lengths": [52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19162481316787397, "mean_inference_ms": 0.5139118884697296, "mean_action_processing_ms": 0.11575499633009546, "mean_env_wait_ms": 0.08224932191074343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003444194793701172, "StateBufferConnector_ms": 0.003072977066040039, "ViewRequirementAgentConnector_ms": 0.06512308120727539}}, "episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 2.804150191204162, "episode_len_mean": 71.85, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.4969197611017755, 9.535726210612806, 9.627121068375667, -2.4207825391500375, 9.975217548791035, 8.239903825601607, 9.943687493205978, 9.509711719723533, 4.541986030641901, 9.63236134166194, -40.11639765725104, 9.942281066907148, 5.077448454941762, 8.493878326657695, 8.812839267927078, -40.01938741282925, 8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339], "episode_lengths": [52, 83, 28, 90, 45, 142, 19, 60, 109, 61, 34, 4, 100, 144, 142, 9, 91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19162481316787397, "mean_inference_ms": 0.5139118884697296, "mean_action_processing_ms": 0.11575499633009546, "mean_env_wait_ms": 0.08224932191074343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003444194793701172, "StateBufferConnector_ms": 0.003072977066040039, "ViewRequirementAgentConnector_ms": 0.06512308120727539}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34152, "num_agent_steps_trained": 34152, "num_env_steps_sampled": 34152, "num_env_steps_trained": 34152, "num_env_steps_sampled_this_iter": 1308, "num_env_steps_trained_this_iter": 1308, "timesteps_total": 34152, "num_steps_trained_this_iter": 1308, "agent_timesteps_total": 34152, "timers": {"training_iteration_time_ms": 6007.085, "load_time_ms": 1.86, "load_throughput": 663936.814, "learn_time_ms": 5732.463, "learn_throughput": 215.387, "synch_weights_time_ms": 3.75}, "counters": {"num_env_steps_sampled": 34152, "num_env_steps_trained": 34152, "num_agent_steps_sampled": 34152, "num_agent_steps_trained": 34152}, "done": false, "episodes_total": 505, "training_iteration": 28, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-51", "timestamp": 1678935711, "time_this_iter_s": 6.358540058135986, "time_total_s": 166.92429113388062, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1804302b0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff180430fd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 166.92429113388062, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.42222222222222, "ram_util_percent": 21.61111111111111, "gpu_util_percent0": 0.7144444444444445, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.32373128055424305, "cur_lr": 0.00023811142701077537, "total_loss": 1.1997232193240779, "policy_loss": -0.08284258446966608, "vf_loss": 1.282080478820717, "vf_explained_var": 0.05205847611029943, "kl": 0.005890622493023645, "entropy": 0.5082927261292934, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 32190.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 35447, "num_env_steps_trained": 35447, "num_agent_steps_sampled": 35447, "num_agent_steps_trained": 35447}, "sampler_results": {"episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 3.067238156200327, "episode_len_mean": 73.58, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613], "episode_lengths": [91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19159355381763712, "mean_inference_ms": 0.5139022253219262, "mean_action_processing_ms": 0.1157608997641227, "mean_env_wait_ms": 0.08223229691527244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003435850143432617, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.06725001335144043}}, "episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 3.067238156200327, "episode_len_mean": 73.58, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.960355044331966, -1.902972187535724, 9.834534472650121, 9.429413068938715, 6.395385489120256, 7.080191634902185, 9.97544984320964, 8.426555655151873, 9.131475923667141, 9.992466909600102, 8.186307419600034, 9.863465284690601, 3.6646538845445082, 6.915981712201969, 7.744466011439692, 8.561759684305029, 9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613], "episode_lengths": [91, 60, 90, 123, 77, 106, 53, 65, 62, 12, 147, 21, 54, 124, 83, 139, 104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19159355381763712, "mean_inference_ms": 0.5139022253219262, "mean_action_processing_ms": 0.1157608997641227, "mean_env_wait_ms": 0.08223229691527244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003435850143432617, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.06725001335144043}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35447, "num_agent_steps_trained": 35447, "num_env_steps_sampled": 35447, "num_env_steps_trained": 35447, "num_env_steps_sampled_this_iter": 1295, "num_env_steps_trained_this_iter": 1295, "timesteps_total": 35447, "num_steps_trained_this_iter": 1295, "agent_timesteps_total": 35447, "timers": {"training_iteration_time_ms": 6017.261, "load_time_ms": 1.805, "load_throughput": 686095.879, "learn_time_ms": 5738.942, "learn_throughput": 215.789, "synch_weights_time_ms": 3.75}, "counters": {"num_env_steps_sampled": 35447, "num_env_steps_trained": 35447, "num_agent_steps_sampled": 35447, "num_agent_steps_trained": 35447}, "done": false, "episodes_total": 521, "training_iteration": 29, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-01-57", "timestamp": 1678935717, "time_this_iter_s": 6.1904895305633545, "time_total_s": 173.11478066444397, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9b9d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9bbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1802eb550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 173.11478066444397, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.45, "ram_util_percent": 21.6, "gpu_util_percent0": 0.7350000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.323731280554243, "cur_lr": 0.00023811142701077537, "total_loss": 0.3342103634620161, "policy_loss": -0.025064620394737294, "vf_loss": 0.3574327067115332, "vf_explained_var": 0.6032910426967164, "kl": 0.010161244571727537, "entropy": 0.5174399156091559, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 33375.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 36695, "num_env_steps_trained": 36695, "num_agent_steps_sampled": 36695, "num_agent_steps_trained": 36695}, "sampler_results": {"episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 2.8305948122443634, "episode_len_mean": 72.99, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623], "episode_lengths": [104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19179129578627185, "mean_inference_ms": 0.5144351446781501, "mean_action_processing_ms": 0.11585430507925441, "mean_env_wait_ms": 0.08231883163714543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034918785095214844, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.06731104850769043}}, "episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 2.8305948122443634, "episode_len_mean": 72.99, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.954841324164837, 8.974387849561788, 9.64716265734727, -40.00217577916035, 8.636663563205346, 8.41578847085191, 9.997320726399899, 6.507779698511884, 9.784383122622346, 8.901463634515295, 9.979918414826358, 8.675396270874302, -40.01007786729495, 9.92984334982668, 9.082334351793284, 7.647414917445758, 9.568314827773873, -40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623], "episode_lengths": [104, 89, 131, 15, 112, 58, 17, 94, 25, 126, 54, 104, 33, 23, 111, 142, 48, 25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19179129578627185, "mean_inference_ms": 0.5144351446781501, "mean_action_processing_ms": 0.11585430507925441, "mean_env_wait_ms": 0.08231883163714543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034918785095214844, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.06731104850769043}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36695, "num_agent_steps_trained": 36695, "num_env_steps_sampled": 36695, "num_env_steps_trained": 36695, "num_env_steps_sampled_this_iter": 1248, "num_env_steps_trained_this_iter": 1248, "timesteps_total": 36695, "num_steps_trained_this_iter": 1248, "agent_timesteps_total": 36695, "timers": {"training_iteration_time_ms": 6075.946, "load_time_ms": 1.921, "load_throughput": 650559.346, "learn_time_ms": 5803.653, "learn_throughput": 215.33, "synch_weights_time_ms": 3.783}, "counters": {"num_env_steps_sampled": 36695, "num_env_steps_trained": 36695, "num_agent_steps_sampled": 36695, "num_agent_steps_trained": 36695}, "done": false, "episodes_total": 537, "training_iteration": 30, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-04", "timestamp": 1678935724, "time_this_iter_s": 6.19649338722229, "time_total_s": 179.31127405166626, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301fa0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654301b80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801cab80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 179.31127405166626, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.450000000000001, "ram_util_percent": 21.674999999999997, "gpu_util_percent0": 0.7750000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.323731280554243, "cur_lr": 0.00023811142701077537, "total_loss": 1.3161162891212261, "policy_loss": -0.03515304216844404, "vf_loss": 1.3417179638780574, "vf_explained_var": 0.32164268106476873, "kl": 0.03565671666802725, "entropy": 0.7121530195841422, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 34545.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "sampler_results": {"episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 3.785966248436604, "episode_len_mean": 72.86, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314], "episode_lengths": [25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19184615140750047, "mean_inference_ms": 0.5146482840160191, "mean_action_processing_ms": 0.11591136582670318, "mean_env_wait_ms": 0.08234762251903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035347938537597656, "StateBufferConnector_ms": 0.0030486583709716797, "ViewRequirementAgentConnector_ms": 0.06904172897338867}}, "episode_reward_max": 9.997512967371193, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 3.785966248436604, "episode_len_mean": 72.86, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.25597162558517, 9.912932214814113, 8.657761777223119, 9.911680355914305, -40.00134782864644, 9.675278212113515, 9.135516417891761, 9.73954775382115, -1.1484855525386592, 9.500189103642068, 9.985219390660502, 9.9181286630503, 6.811666378162817, 9.816250585762946, 8.07666940891013, 9.552824461719242, 9.187766707770747, -40.079755118575186, 9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314], "episode_lengths": [25, 15, 58, 9, 10, 76, 33, 121, 121, 112, 63, 96, 66, 108, 57, 63, 131, 44, 108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19184615140750047, "mean_inference_ms": 0.5146482840160191, "mean_action_processing_ms": 0.11591136582670318, "mean_env_wait_ms": 0.08234762251903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035347938537597656, "StateBufferConnector_ms": 0.0030486583709716797, "ViewRequirementAgentConnector_ms": 0.06904172897338867}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968, "num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_env_steps_sampled_this_iter": 1273, "num_env_steps_trained_this_iter": 1273, "timesteps_total": 37968, "num_steps_trained_this_iter": 1273, "agent_timesteps_total": 37968, "timers": {"training_iteration_time_ms": 6108.025, "load_time_ms": 1.94, "load_throughput": 647276.137, "learn_time_ms": 5828.36, "learn_throughput": 215.429, "synch_weights_time_ms": 3.814}, "counters": {"num_env_steps_sampled": 37968, "num_env_steps_trained": 37968, "num_agent_steps_sampled": 37968, "num_agent_steps_trained": 37968}, "done": false, "episodes_total": 554, "training_iteration": 31, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-10", "timestamp": 1678935730, "time_this_iter_s": 6.201737880706787, "time_total_s": 185.51301193237305, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6541c73a0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6541c7130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801ebe50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 185.51301193237305, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.788888888888888, "ram_util_percent": 21.71111111111111, "gpu_util_percent0": 0.7077777777777778, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4855969208313647, "cur_lr": 0.00023811142701077532, "total_loss": 0.8906395459012991, "policy_loss": -0.1076398454192612, "vf_loss": 0.995801228035513, "vf_explained_var": -0.12579550903152537, "kl": 0.008656440124913302, "entropy": 0.616884041260238, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 35670.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 39134, "num_env_steps_trained": 39134, "num_agent_steps_sampled": 39134, "num_agent_steps_trained": 39134}, "sampler_results": {"episode_reward_max": 9.998358178370845, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 5.349921798855463, "episode_len_mean": 72.44, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524], "episode_lengths": [108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19192322140161225, "mean_inference_ms": 0.5147065227742423, "mean_action_processing_ms": 0.11594878155551992, "mean_env_wait_ms": 0.08233563075640533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036792755126953125, "StateBufferConnector_ms": 0.003075122833251953, "ViewRequirementAgentConnector_ms": 0.07145547866821289}}, "episode_reward_max": 9.998358178370845, "episode_reward_min": -40.48053808970273, "episode_reward_mean": 5.349921798855463, "episode_len_mean": 72.44, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.635651991203568, 9.930738659544529, 9.887221500487923, 9.940502365665429, 9.97956819495465, 9.778808906899021, -40.48053808970273, 9.233468890700367, 9.997512967371193, 9.945885327034201, -40.13391945614054, 9.831067842101584, -0.958575699438212, 9.368168710468936, 3.851368914809476, 9.93748554424874, -40.38130009921271, 9.960056241379084, 9.792875298153577, 6.500554057925952, -40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524], "episode_lengths": [108, 4, 20, 47, 39, 43, 39, 64, 18, 93, 50, 80, 118, 59, 124, 48, 75, 109, 109, 154, 88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19192322140161225, "mean_inference_ms": 0.5147065227742423, "mean_action_processing_ms": 0.11594878155551992, "mean_env_wait_ms": 0.08233563075640533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036792755126953125, "StateBufferConnector_ms": 0.003075122833251953, "ViewRequirementAgentConnector_ms": 0.07145547866821289}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39134, "num_agent_steps_trained": 39134, "num_env_steps_sampled": 39134, "num_env_steps_trained": 39134, "num_env_steps_sampled_this_iter": 1166, "num_env_steps_trained_this_iter": 1166, "timesteps_total": 39134, "num_steps_trained_this_iter": 1166, "agent_timesteps_total": 39134, "timers": {"training_iteration_time_ms": 5990.557, "load_time_ms": 1.99, "load_throughput": 621787.877, "learn_time_ms": 5714.477, "learn_throughput": 216.503, "synch_weights_time_ms": 3.821}, "counters": {"num_env_steps_sampled": 39134, "num_env_steps_trained": 39134, "num_agent_steps_sampled": 39134, "num_agent_steps_trained": 39134}, "done": false, "episodes_total": 572, "training_iteration": 32, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-16", "timestamp": 1678935736, "time_this_iter_s": 5.650158882141113, "time_total_s": 191.16317081451416, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042d040>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042da30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 191.16317081451416, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.928571428571429, "ram_util_percent": 21.685714285714283, "gpu_util_percent0": 0.7242857142857142, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4855969208313646, "cur_lr": 0.00023811142701077534, "total_loss": 1.9000311132084142, "policy_loss": -0.02627027674771107, "vf_loss": 1.9190326912540456, "vf_explained_var": 0.3080248431042508, "kl": 0.019307457700913584, "entropy": 0.753311585124817, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 36765.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 40327, "num_env_steps_trained": 40327, "num_agent_steps_sampled": 40327, "num_agent_steps_trained": 40327}, "sampler_results": {"episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 5.764027076910148, "episode_len_mean": 70.36, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163], "episode_lengths": [88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19193629270611573, "mean_inference_ms": 0.5146827575630484, "mean_action_processing_ms": 0.1159849284898139, "mean_env_wait_ms": 0.08228755393347477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036051273345947266, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.06945061683654785}}, "episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 5.764027076910148, "episode_len_mean": 70.36, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.22021733857876, 9.873505783169723, 9.953449008787125, 9.942446117730444, 8.837998445376012, 9.601785681902347, 9.093416045176298, 9.794032068136627, 0.02009595063591263, 9.831601773193684, 8.934740575190167, 4.108914888621986, -0.5981476222903339, 8.869742928195269, 9.782805032570272, 7.936324774180487, -40.341300981638824, 9.98785863821397, 9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163], "episode_lengths": [88, 40, 10, 46, 62, 42, 124, 66, 107, 18, 82, 94, 82, 82, 76, 95, 66, 17, 84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19193629270611573, "mean_inference_ms": 0.5146827575630484, "mean_action_processing_ms": 0.1159849284898139, "mean_env_wait_ms": 0.08228755393347477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036051273345947266, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.06945061683654785}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40327, "num_agent_steps_trained": 40327, "num_env_steps_sampled": 40327, "num_env_steps_trained": 40327, "num_env_steps_sampled_this_iter": 1193, "num_env_steps_trained_this_iter": 1193, "timesteps_total": 40327, "num_steps_trained_this_iter": 1193, "agent_timesteps_total": 40327, "timers": {"training_iteration_time_ms": 6025.737, "load_time_ms": 1.904, "load_throughput": 650833.936, "learn_time_ms": 5752.181, "learn_throughput": 215.379, "synch_weights_time_ms": 3.81}, "counters": {"num_env_steps_sampled": 40327, "num_env_steps_trained": 40327, "num_agent_steps_sampled": 40327, "num_agent_steps_trained": 40327}, "done": false, "episodes_total": 592, "training_iteration": 33, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-22", "timestamp": 1678935742, "time_this_iter_s": 5.937090158462524, "time_total_s": 197.10026097297668, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ed4e20>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed4f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18018cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 197.10026097297668, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.075, "ram_util_percent": 21.6375, "gpu_util_percent0": 0.6875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4855969208313646, "cur_lr": 0.00023811142701077537, "total_loss": 2.127162707558411, "policy_loss": -0.024998160706371324, "vf_loss": 2.1422145368692536, "vf_explained_var": 0.11958272319573622, "kl": 0.025128220511269173, "entropy": 0.8065462336835698, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 37905.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 41580, "num_env_steps_trained": 41580, "num_agent_steps_sampled": 41580, "num_agent_steps_trained": 41580}, "sampler_results": {"episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 6.689504677307551, "episode_len_mean": 70.92, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342], "episode_lengths": [84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19214606330205264, "mean_inference_ms": 0.5150053379620784, "mean_action_processing_ms": 0.11606774191771174, "mean_env_wait_ms": 0.08233890416467488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003639698028564453, "StateBufferConnector_ms": 0.0029735565185546875, "ViewRequirementAgentConnector_ms": 0.06925845146179199}}, "episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 6.689504677307551, "episode_len_mean": 70.92, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.916728687930245, 7.502219798542949, 8.071089805471855, 6.120792577132542, 9.243173828922584, 9.902051817148164, -40.00605495513309, 9.531174081729528, 9.24636762720577, 9.948922637269279, 9.875575186591613, 6.382553819366851, 9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342], "episode_lengths": [84, 154, 134, 162, 119, 16, 33, 50, 111, 33, 63, 116, 130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19214606330205264, "mean_inference_ms": 0.5150053379620784, "mean_action_processing_ms": 0.11606774191771174, "mean_env_wait_ms": 0.08233890416467488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003639698028564453, "StateBufferConnector_ms": 0.0029735565185546875, "ViewRequirementAgentConnector_ms": 0.06925845146179199}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41580, "num_agent_steps_trained": 41580, "num_env_steps_sampled": 41580, "num_env_steps_trained": 41580, "num_env_steps_sampled_this_iter": 1253, "num_env_steps_trained_this_iter": 1253, "timesteps_total": 41580, "num_steps_trained_this_iter": 1253, "agent_timesteps_total": 41580, "timers": {"training_iteration_time_ms": 6001.949, "load_time_ms": 2.001, "load_throughput": 615812.898, "learn_time_ms": 5722.733, "learn_throughput": 215.334, "synch_weights_time_ms": 3.811}, "counters": {"num_env_steps_sampled": 41580, "num_env_steps_trained": 41580, "num_agent_steps_sampled": 41580, "num_agent_steps_trained": 41580}, "done": false, "episodes_total": 610, "training_iteration": 34, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-28", "timestamp": 1678935748, "time_this_iter_s": 6.196561813354492, "time_total_s": 203.29682278633118, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff180430c70>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff180430190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18017ec10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 203.29682278633118, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.333333333333334, "ram_util_percent": 21.7, "gpu_util_percent0": 0.6855555555555557, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7283953812470471, "cur_lr": 0.00023811142701077534, "total_loss": 1.0177594297150077, "policy_loss": -0.024347518473023584, "vf_loss": 1.03767954359509, "vf_explained_var": 0.5827715173071506, "kl": 0.009033419288821546, "entropy": 0.7695981424228818, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 39000.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 42699, "num_env_steps_trained": 42699, "num_agent_steps_sampled": 42699, "num_agent_steps_trained": 42699}, "sampler_results": {"episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.204136182168104, "episode_len_mean": 71.36, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852], "episode_lengths": [130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1923099759857662, "mean_inference_ms": 0.5156179875510553, "mean_action_processing_ms": 0.11620806613736161, "mean_env_wait_ms": 0.08240923754278538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515481948852539, "StateBufferConnector_ms": 0.0028769969940185547, "ViewRequirementAgentConnector_ms": 0.06683063507080078}}, "episode_reward_max": 9.998868698689998, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.204136182168104, "episode_len_mean": 71.36, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.830234242217124, 9.504978061712047, -40.04066730753397, 8.598963660431812, 9.247815221835593, 9.821605176396536, 9.524213169981028, 9.448259156035027, 9.667470485949273, 9.806632713700086, 9.666025550764438, 9.197898731070625, 9.225756235512007, 9.948376412077629, 8.765040125705623, 9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852], "episode_lengths": [130, 71, 14, 113, 60, 39, 69, 89, 95, 81, 120, 90, 48, 10, 103, 82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1923099759857662, "mean_inference_ms": 0.5156179875510553, "mean_action_processing_ms": 0.11620806613736161, "mean_env_wait_ms": 0.08240923754278538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515481948852539, "StateBufferConnector_ms": 0.0028769969940185547, "ViewRequirementAgentConnector_ms": 0.06683063507080078}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42699, "num_agent_steps_trained": 42699, "num_env_steps_sampled": 42699, "num_env_steps_trained": 42699, "num_env_steps_sampled_this_iter": 1119, "num_env_steps_trained_this_iter": 1119, "timesteps_total": 42699, "num_steps_trained_this_iter": 1119, "agent_timesteps_total": 42699, "timers": {"training_iteration_time_ms": 5992.506, "load_time_ms": 2.055, "load_throughput": 599325.298, "learn_time_ms": 5712.935, "learn_throughput": 215.616, "synch_weights_time_ms": 3.861}, "counters": {"num_env_steps_sampled": 42699, "num_env_steps_trained": 42699, "num_agent_steps_sampled": 42699, "num_agent_steps_trained": 42699}, "done": false, "episodes_total": 622, "training_iteration": 35, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-33", "timestamp": 1678935753, "time_this_iter_s": 5.421099901199341, "time_total_s": 208.71792268753052, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b2af40>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9b940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 208.71792268753052, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.685714285714287, "ram_util_percent": 21.728571428571428, "gpu_util_percent0": 0.7242857142857142, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.728395381247047, "cur_lr": 0.00023811142701077537, "total_loss": 0.708757996436713, "policy_loss": -0.023881177039196094, "vf_loss": 0.7303980328436107, "vf_explained_var": 0.5659992443521817, "kl": 0.006423674999544649, "entropy": 0.8716150329758724, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 40110.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 44001, "num_env_steps_trained": 44001, "num_agent_steps_sampled": 44001, "num_agent_steps_trained": 44001}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.216912704203741, "episode_len_mean": 73.06, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675], "episode_lengths": [82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19242086954370363, "mean_inference_ms": 0.5160342041010666, "mean_action_processing_ms": 0.11631467566468615, "mean_env_wait_ms": 0.08245283084805295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.002978086471557617, "ViewRequirementAgentConnector_ms": 0.06751775741577148}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.216912704203741, "episode_len_mean": 73.06, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.383744771941004, 9.753234018137343, 7.511391154987722, 9.837534329626054, 9.405118381475623, 8.44205398536292, 9.676644093428267, 9.993718855529728, 9.837814986815388, 9.709461470452874, 7.8797420756166225, 9.995020830802947, 5.229805461261684, 9.936447904196152, 9.991474708619133, 4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675], "episode_lengths": [82, 70, 115, 87, 127, 134, 23, 38, 88, 24, 110, 30, 102, 46, 10, 114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19242086954370363, "mean_inference_ms": 0.5160342041010666, "mean_action_processing_ms": 0.11631467566468615, "mean_env_wait_ms": 0.08245283084805295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515958786010742, "StateBufferConnector_ms": 0.002978086471557617, "ViewRequirementAgentConnector_ms": 0.06751775741577148}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44001, "num_agent_steps_trained": 44001, "num_env_steps_sampled": 44001, "num_env_steps_trained": 44001, "num_env_steps_sampled_this_iter": 1302, "num_env_steps_trained_this_iter": 1302, "timesteps_total": 44001, "num_steps_trained_this_iter": 1302, "agent_timesteps_total": 44001, "timers": {"training_iteration_time_ms": 6032.535, "load_time_ms": 2.004, "load_throughput": 616341.137, "learn_time_ms": 5750.068, "learn_throughput": 214.763, "synch_weights_time_ms": 3.868}, "counters": {"num_env_steps_sampled": 44001, "num_env_steps_trained": 44001, "num_agent_steps_sampled": 44001, "num_agent_steps_trained": 44001}, "done": false, "episodes_total": 637, "training_iteration": 36, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-40", "timestamp": 1678935760, "time_this_iter_s": 6.460132837295532, "time_total_s": 215.17805552482605, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e9c070>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bd190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18018cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 215.17805552482605, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.82222222222222, "ram_util_percent": 21.688888888888886, "gpu_util_percent0": 0.7077777777777778, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.728395381247047, "cur_lr": 0.00023811142701077537, "total_loss": 0.7126863138606915, "policy_loss": -0.036332321119232056, "vf_loss": 0.7333802611517329, "vf_explained_var": 0.5085157041875725, "kl": 0.02446636859962866, "entropy": 0.7804364001394337, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 41295.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 45252, "num_env_steps_trained": 45252, "num_agent_steps_sampled": 45252, "num_agent_steps_trained": 45252}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.194961645574401, "episode_len_mean": 74.71, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677], "episode_lengths": [114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19243757988509297, "mean_inference_ms": 0.5159182478856514, "mean_action_processing_ms": 0.11628038608387303, "mean_env_wait_ms": 0.08244566804086272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034894943237304688, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.06586146354675293}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.194961645574401, "episode_len_mean": 74.71, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.767607741481775, 9.877088382754314, 9.990820578468425, 9.983105604923795, 9.98458881921552, 9.264882260464885, 9.987458997397153, 9.998358178370845, 8.478376571903537, 9.837695038277849, 9.981714170994065, 7.437001659483967, 5.669105202138563, 9.951033263055828, 5.344200894731477, 9.948981080427528, 9.755342548727967, 9.996750461998305, 9.272658809362255, 9.90935220805524, 9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677], "episode_lengths": [114, 73, 39, 89, 51, 82, 10, 12, 113, 113, 45, 77, 100, 17, 135, 49, 35, 17, 119, 63, 50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19243757988509297, "mean_inference_ms": 0.5159182478856514, "mean_action_processing_ms": 0.11628038608387303, "mean_env_wait_ms": 0.08244566804086272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034894943237304688, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.06586146354675293}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45252, "num_agent_steps_trained": 45252, "num_env_steps_sampled": 45252, "num_env_steps_trained": 45252, "num_env_steps_sampled_this_iter": 1251, "num_env_steps_trained_this_iter": 1251, "timesteps_total": 45252, "num_steps_trained_this_iter": 1251, "agent_timesteps_total": 45252, "timers": {"training_iteration_time_ms": 6059.602, "load_time_ms": 1.985, "load_throughput": 625080.161, "learn_time_ms": 5774.203, "learn_throughput": 214.887, "synch_weights_time_ms": 3.868}, "counters": {"num_env_steps_sampled": 45252, "num_env_steps_trained": 45252, "num_agent_steps_sampled": 45252, "num_agent_steps_trained": 45252}, "done": false, "episodes_total": 652, "training_iteration": 37, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-46", "timestamp": 1678935766, "time_this_iter_s": 6.0467140674591064, "time_total_s": 221.22476959228516, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1804e8e50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1804e8ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1804abb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 221.22476959228516, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.5875, "ram_util_percent": 21.737499999999997, "gpu_util_percent0": 0.7150000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0925930718705705, "cur_lr": 0.00023811142701077537, "total_loss": 0.15249000797552678, "policy_loss": -0.015954000272322445, "vf_loss": 0.15036139929303316, "vf_explained_var": 0.6042933063705762, "kl": 0.018611882291447737, "entropy": 0.805386932566762, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 42480.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 46532, "num_env_steps_trained": 46532, "num_agent_steps_sampled": 46532, "num_agent_steps_trained": 46532}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.314036558792349, "episode_len_mean": 73.98, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777], "episode_lengths": [50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19214646829849996, "mean_inference_ms": 0.5154722418153135, "mean_action_processing_ms": 0.11618862413714176, "mean_env_wait_ms": 0.08235597675814843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003429889678955078, "StateBufferConnector_ms": 0.0030450820922851562, "ViewRequirementAgentConnector_ms": 0.06410765647888184}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -40.46035605477493, "episode_reward_mean": 7.314036558792349, "episode_len_mean": 73.98, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.916938198711133, 8.82354818547052, 4.448465167198071, 9.998868698689998, 9.893725100214594, 9.655299844764874, -40.46035605477493, 6.55318620125553, 9.53511032098344, 9.713328882843008, 9.87535232310809, -40.27921959523736, 9.969005605475807, -6.431515332707367, 8.081673295584288, 9.067894519554095, 9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777], "episode_lengths": [50, 48, 58, 2, 26, 18, 30, 102, 93, 21, 93, 28, 37, 91, 125, 139, 27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19214646829849996, "mean_inference_ms": 0.5154722418153135, "mean_action_processing_ms": 0.11618862413714176, "mean_env_wait_ms": 0.08235597675814843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003429889678955078, "StateBufferConnector_ms": 0.0030450820922851562, "ViewRequirementAgentConnector_ms": 0.06410765647888184}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46532, "num_agent_steps_trained": 46532, "num_env_steps_sampled": 46532, "num_env_steps_trained": 46532, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 46532, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 46532, "timers": {"training_iteration_time_ms": 6079.548, "load_time_ms": 1.905, "load_throughput": 650002.923, "learn_time_ms": 5802.317, "learn_throughput": 213.363, "synch_weights_time_ms": 2.398}, "counters": {"num_env_steps_sampled": 46532, "num_env_steps_trained": 46532, "num_agent_steps_sampled": 46532, "num_agent_steps_trained": 46532}, "done": false, "episodes_total": 672, "training_iteration": 38, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-52", "timestamp": 1678935772, "time_this_iter_s": 6.557705640792847, "time_total_s": 227.782475233078, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9bee0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9baf0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 227.782475233078, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.988888888888889, "ram_util_percent": 21.7, "gpu_util_percent0": 0.6966666666666668, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0925930718705703, "cur_lr": 0.0002381114270107754, "total_loss": 1.00799719288888, "policy_loss": -0.047154868760129864, "vf_loss": 1.0397595790351164, "vf_explained_var": 0.4394454992131183, "kl": 0.01604980899144467, "entropy": 0.7663554652741081, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 43650.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 47749, "num_env_steps_trained": 47749, "num_agent_steps_sampled": 47749, "num_agent_steps_trained": 47749}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -40.762806040421154, "episode_reward_mean": 8.027531851898669, "episode_len_mean": 76.54, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711], "episode_lengths": [27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19182743221530563, "mean_inference_ms": 0.5145890442604288, "mean_action_processing_ms": 0.11599458305152757, "mean_env_wait_ms": 0.08223892883942967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033576488494873047, "StateBufferConnector_ms": 0.0029494762420654297, "ViewRequirementAgentConnector_ms": 0.06360530853271484}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -40.762806040421154, "episode_reward_mean": 8.027531851898669, "episode_len_mean": 76.54, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.244687744932177, 9.777698052319266, 9.703792056968139, 9.939646658569163, 9.915062019353769, 4.494130818313652, 7.433653650077975, 8.509946711474445, 9.264428165030917, 9.775186867175053, 9.533729405738613, 9.647825461053579, 0.8593581455723047, 9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711], "episode_lengths": [27, 64, 52, 89, 59, 84, 116, 95, 81, 82, 81, 20, 107, 37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19182743221530563, "mean_inference_ms": 0.5145890442604288, "mean_action_processing_ms": 0.11599458305152757, "mean_env_wait_ms": 0.08223892883942967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033576488494873047, "StateBufferConnector_ms": 0.0029494762420654297, "ViewRequirementAgentConnector_ms": 0.06360530853271484}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47749, "num_agent_steps_trained": 47749, "num_env_steps_sampled": 47749, "num_env_steps_trained": 47749, "num_env_steps_sampled_this_iter": 1217, "num_env_steps_trained_this_iter": 1217, "timesteps_total": 47749, "num_steps_trained_this_iter": 1217, "agent_timesteps_total": 47749, "timers": {"training_iteration_time_ms": 6047.374, "load_time_ms": 1.995, "load_throughput": 616732.738, "learn_time_ms": 5777.839, "learn_throughput": 212.917, "synch_weights_time_ms": 2.373}, "counters": {"num_env_steps_sampled": 47749, "num_env_steps_trained": 47749, "num_agent_steps_sampled": 47749, "num_agent_steps_trained": 47749}, "done": false, "episodes_total": 688, "training_iteration": 39, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-02-58", "timestamp": 1678935778, "time_this_iter_s": 5.8685712814331055, "time_total_s": 233.6510465145111, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301a90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9bd00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18018cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 233.6510465145111, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.012500000000001, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7175, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.995150436911828, "episode_reward_min": -40.36836363148601, "episode_reward_mean": 6.073479799852367, "episode_len_mean": 61.0, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.792525757532937, -40.36836363148601, 9.296951376691565, 9.484248355647338, 9.971332024739347, 8.047171343702761, 9.946262442648212, 9.475251027792355, 9.855552335446673, 8.91954217262059, 9.995150436911828, 9.975228701472163, 9.973423280627815, 7.363540213750978, 9.374381159686964], "episode_lengths": [22, 40, 59, 50, 64, 131, 15, 55, 41, 76, 26, 47, 51, 141, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.16375475395142122, "mean_inference_ms": 0.4648433687701338, "mean_action_processing_ms": 0.10587231266593387, "mean_env_wait_ms": 0.07579054829985735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032552083333333335, "StateBufferConnector_ms": 0.0026051203409830728, "ViewRequirementAgentConnector_ms": 0.06129264831542969}, "num_agent_steps_sampled_this_iter": 915, "num_env_steps_sampled_this_iter": 915, "timesteps_this_iter": 915, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0925930718705703, "cur_lr": 0.00023811142701077534, "total_loss": 0.06098323135494112, "policy_loss": -0.09328185307147267, "vf_loss": 0.1392223464209704, "vf_explained_var": 0.534682451980608, "kl": 0.015905570613461824, "entropy": 0.8350550658799506, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 44775.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 48963, "num_env_steps_trained": 48963, "num_agent_steps_sampled": 48963, "num_agent_steps_trained": 48963}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -40.762806040421154, "episode_reward_mean": 8.158700307690905, "episode_len_mean": 79.11, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108], "episode_lengths": [37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19156047735943524, "mean_inference_ms": 0.5140893239781019, "mean_action_processing_ms": 0.1158816481133531, "mean_env_wait_ms": 0.08216380610745772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033562183380126953, "StateBufferConnector_ms": 0.002950906753540039, "ViewRequirementAgentConnector_ms": 0.06361818313598633}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -40.762806040421154, "episode_reward_mean": 8.158700307690905, "episode_len_mean": 79.11, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.57104356092663, 9.8177435807961, 9.873585038925576, 9.393137487236338, 7.653653194230148, 9.886517934735235, 9.803918571363388, -6.301899876464379, 8.825791072773342, 9.379295250999157, 9.539254834370768, 9.88201008325006, 9.538998869661947, 9.856555908304466, 9.71316707142206, 9.870651766490985, 2.7999806210078235, 9.489975677265146, 9.915338520550947, 9.366378575092364, 7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108], "episode_lengths": [37, 31, 32, 92, 121, 20, 61, 74, 60, 76, 115, 12, 108, 111, 128, 72, 126, 51, 53, 121, 146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19156047735943524, "mean_inference_ms": 0.5140893239781019, "mean_action_processing_ms": 0.1158816481133531, "mean_env_wait_ms": 0.08216380610745772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033562183380126953, "StateBufferConnector_ms": 0.002950906753540039, "ViewRequirementAgentConnector_ms": 0.06361818313598633}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48963, "num_agent_steps_trained": 48963, "num_env_steps_sampled": 48963, "num_env_steps_trained": 48963, "num_env_steps_sampled_this_iter": 1214, "num_env_steps_trained_this_iter": 1214, "timesteps_total": 48963, "num_steps_trained_this_iter": 1214, "agent_timesteps_total": 48963, "timers": {"training_iteration_time_ms": 6010.766, "load_time_ms": 1.961, "load_throughput": 625654.724, "learn_time_ms": 5744.216, "learn_throughput": 213.571, "synch_weights_time_ms": 2.4}, "counters": {"num_env_steps_sampled": 48963, "num_env_steps_trained": 48963, "num_agent_steps_sampled": 48963, "num_agent_steps_trained": 48963}, "done": false, "episodes_total": 701, "training_iteration": 40, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-05", "timestamp": 1678935785, "time_this_iter_s": 6.325359582901001, "time_total_s": 239.9764060974121, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff180430bb0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1804309a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 239.9764060974121, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.15, "ram_util_percent": 21.775, "gpu_util_percent0": 0.78375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0925930718705705, "cur_lr": 0.00023811142701077534, "total_loss": 0.44615987521404077, "policy_loss": -0.04237699088832689, "vf_loss": 0.4857075357726047, "vf_explained_var": 0.685196317803292, "kl": 0.004630677443452046, "entropy": 0.7973476238667019, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 45960.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 50314, "num_env_steps_trained": 50314, "num_agent_steps_sampled": 50314, "num_agent_steps_trained": 50314}, "sampler_results": {"episode_reward_max": 9.999707229427967, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.897699845743439, "episode_len_mean": 77.61, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461], "episode_lengths": [146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19124277079925026, "mean_inference_ms": 0.5139423146718199, "mean_action_processing_ms": 0.11580986934617815, "mean_env_wait_ms": 0.08213039917267237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003286123275756836, "StateBufferConnector_ms": 0.0030133724212646484, "ViewRequirementAgentConnector_ms": 0.06296420097351074}}, "episode_reward_max": 9.999707229427967, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.897699845743439, "episode_len_mean": 77.61, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.846138219817852, 9.390843432089719, 9.082291470318854, 9.843491207818886, 9.999707229427967, 9.774927918626581, 9.616806839384187, 9.879958606977807, 9.969259899925827, 9.859982585326296, 7.250718227508134, -40.15902750301536, 9.913681019629813, 9.383862307766039, 9.906094856313937, 9.777655741319675, 9.741906936877117, 9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461], "episode_lengths": [146, 78, 35, 127, 4, 44, 120, 143, 125, 124, 156, 74, 45, 83, 34, 110, 23, 141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19124277079925026, "mean_inference_ms": 0.5139423146718199, "mean_action_processing_ms": 0.11580986934617815, "mean_env_wait_ms": 0.08213039917267237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003286123275756836, "StateBufferConnector_ms": 0.0030133724212646484, "ViewRequirementAgentConnector_ms": 0.06296420097351074}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50314, "num_agent_steps_trained": 50314, "num_env_steps_sampled": 50314, "num_env_steps_trained": 50314, "num_env_steps_sampled_this_iter": 1351, "num_env_steps_trained_this_iter": 1351, "timesteps_total": 50314, "num_steps_trained_this_iter": 1351, "agent_timesteps_total": 50314, "timers": {"training_iteration_time_ms": 6040.595, "load_time_ms": 1.854, "load_throughput": 665889.246, "learn_time_ms": 5777.94, "learn_throughput": 213.675, "synch_weights_time_ms": 2.389}, "counters": {"num_env_steps_sampled": 50314, "num_env_steps_trained": 50314, "num_agent_steps_sampled": 50314, "num_agent_steps_trained": 50314}, "done": false, "episodes_total": 721, "training_iteration": 41, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-11", "timestamp": 1678935791, "time_this_iter_s": 6.499590158462524, "time_total_s": 246.47599625587463, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18046a2b0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18046a460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 246.47599625587463, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.344444444444447, "ram_util_percent": 21.73333333333333, "gpu_util_percent0": 0.7233333333333334, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5462965359352853, "cur_lr": 0.00023811142701077532, "total_loss": 0.8630338493389664, "policy_loss": -0.051076344400644305, "vf_loss": 0.9027123229397317, "vf_explained_var": 0.7131001803058165, "kl": 0.024739569168972336, "entropy": 0.7570025414504387, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 47130.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 51471, "num_env_steps_trained": 51471, "num_agent_steps_sampled": 51471, "num_agent_steps_trained": 51471}, "sampler_results": {"episode_reward_max": 9.999246153522519, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.929318228274529, "episode_len_mean": 74.47, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273], "episode_lengths": [141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19091139948493513, "mean_inference_ms": 0.5133185203542502, "mean_action_processing_ms": 0.11566762717968106, "mean_env_wait_ms": 0.08203612326370394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032596588134765625, "StateBufferConnector_ms": 0.0029091835021972656, "ViewRequirementAgentConnector_ms": 0.06201004981994629}}, "episode_reward_max": 9.999246153522519, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.929318228274529, "episode_len_mean": 74.47, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.027679600719976, 9.946406207669362, 9.972351749998559, 4.80714449178417, 8.493532452699236, 9.903446527070159, 8.0853623288875, 9.999246153522519, 9.398644531711565, 9.874703143094282, 9.466922358085583, 7.964644623764065, 9.97260213822583, 7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273], "episode_lengths": [141, 41, 28, 122, 144, 115, 148, 5, 88, 122, 19, 105, 26, 124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19091139948493513, "mean_inference_ms": 0.5133185203542502, "mean_action_processing_ms": 0.11566762717968106, "mean_env_wait_ms": 0.08203612326370394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032596588134765625, "StateBufferConnector_ms": 0.0029091835021972656, "ViewRequirementAgentConnector_ms": 0.06201004981994629}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51471, "num_agent_steps_trained": 51471, "num_env_steps_sampled": 51471, "num_env_steps_trained": 51471, "num_env_steps_sampled_this_iter": 1157, "num_env_steps_trained_this_iter": 1157, "timesteps_total": 51471, "num_steps_trained_this_iter": 1157, "agent_timesteps_total": 51471, "timers": {"training_iteration_time_ms": 6044.106, "load_time_ms": 1.881, "load_throughput": 655873.356, "learn_time_ms": 5785.123, "learn_throughput": 213.254, "synch_weights_time_ms": 2.386}, "counters": {"num_env_steps_sampled": 51471, "num_env_steps_trained": 51471, "num_agent_steps_sampled": 51471, "num_agent_steps_trained": 51471}, "done": false, "episodes_total": 738, "training_iteration": 42, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-17", "timestamp": 1678935797, "time_this_iter_s": 5.685244560241699, "time_total_s": 252.16124081611633, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ebc4f0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ebc8e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801cab80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 252.16124081611633, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.275, "ram_util_percent": 21.7, "gpu_util_percent0": 0.68625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8194448039029278, "cur_lr": 0.00023811142701077534, "total_loss": 0.3670677440735482, "policy_loss": -0.115957094366486, "vf_loss": 0.48271776417606965, "vf_explained_var": 0.6706462855274613, "kl": 0.002892692766527214, "entropy": 0.7377132255751807, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 48225.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 52676, "num_env_steps_trained": 52676, "num_agent_steps_sampled": 52676, "num_agent_steps_trained": 52676}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.487193817854379, "episode_len_mean": 75.48, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545], "episode_lengths": [124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19065003693429702, "mean_inference_ms": 0.5127823864314895, "mean_action_processing_ms": 0.11555371626247884, "mean_env_wait_ms": 0.08194297209260469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003193378448486328, "StateBufferConnector_ms": 0.0028901100158691406, "ViewRequirementAgentConnector_ms": 0.06139564514160156}}, "episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.487193817854379, "episode_len_mean": 75.48, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.733507921209677, 9.934602871188002, 9.217010964815824, 8.552145983819923, 9.21398958828506, 9.844508510851583, 9.577395819916982, 9.36855027809095, 9.710139521969, 9.677315366847175, 9.69812946933409, 9.16659338857406, 9.67584752073645, 9.989047081817374, 9.968068962912232, 8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545], "episode_lengths": [124, 56, 83, 58, 45, 74, 48, 48, 120, 125, 23, 139, 103, 40, 9, 104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19065003693429702, "mean_inference_ms": 0.5127823864314895, "mean_action_processing_ms": 0.11555371626247884, "mean_env_wait_ms": 0.08194297209260469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003193378448486328, "StateBufferConnector_ms": 0.0028901100158691406, "ViewRequirementAgentConnector_ms": 0.06139564514160156}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52676, "num_agent_steps_trained": 52676, "num_env_steps_sampled": 52676, "num_env_steps_trained": 52676, "num_env_steps_sampled_this_iter": 1205, "num_env_steps_trained_this_iter": 1205, "timesteps_total": 52676, "num_steps_trained_this_iter": 1205, "agent_timesteps_total": 52676, "timers": {"training_iteration_time_ms": 6038.613, "load_time_ms": 1.95, "load_throughput": 633219.557, "learn_time_ms": 5776.004, "learn_throughput": 213.798, "synch_weights_time_ms": 3.729}, "counters": {"num_env_steps_sampled": 52676, "num_env_steps_trained": 52676, "num_agent_steps_sampled": 52676, "num_agent_steps_trained": 52676}, "done": false, "episodes_total": 751, "training_iteration": 43, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-23", "timestamp": 1678935803, "time_this_iter_s": 5.882966756820679, "time_total_s": 258.044207572937, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e79070>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e79b50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801c6e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 258.044207572937, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.3125, "ram_util_percent": 21.7, "gpu_util_percent0": 0.78, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4097224019514639, "cur_lr": 0.0002381114270107754, "total_loss": -0.021070106325491347, "policy_loss": -0.08072041063161012, "vf_loss": 0.049008500045627505, "vf_explained_var": 0.7378460816646877, "kl": 0.03113999242781288, "entropy": 0.7568869056670289, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 49350.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 53896, "num_env_steps_trained": 53896, "num_agent_steps_sampled": 53896, "num_agent_steps_trained": 53896}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.521503703148532, "episode_len_mean": 76.73, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353], "episode_lengths": [104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1903546009196498, "mean_inference_ms": 0.512152546454053, "mean_action_processing_ms": 0.1154148720271769, "mean_env_wait_ms": 0.08184110106464784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003222942352294922, "StateBufferConnector_ms": 0.0027861595153808594, "ViewRequirementAgentConnector_ms": 0.06168365478515625}}, "episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.521503703148532, "episode_len_mean": 76.73, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.425538171451597, 9.982322169269299, 9.746714009349152, 9.681958929473208, 9.979572113625128, 9.934163071700777, -40.762806040421154, 9.850294994795961, 9.990747238490995, 9.986164322758233, 9.477077738757298, 9.968620726195052, 7.573737920075426, 9.354897229092137, 9.897965138274175, 9.90373963672006, 9.574870320471923, 9.989588746118116, 9.965630367604794, 8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353], "episode_lengths": [104, 41, 47, 50, 27, 40, 90, 55, 19, 38, 31, 93, 101, 96, 98, 63, 44, 18, 72, 140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1903546009196498, "mean_inference_ms": 0.512152546454053, "mean_action_processing_ms": 0.1154148720271769, "mean_env_wait_ms": 0.08184110106464784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003222942352294922, "StateBufferConnector_ms": 0.0027861595153808594, "ViewRequirementAgentConnector_ms": 0.06168365478515625}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53896, "num_agent_steps_trained": 53896, "num_env_steps_sampled": 53896, "num_env_steps_trained": 53896, "num_env_steps_sampled_this_iter": 1220, "num_env_steps_trained_this_iter": 1220, "timesteps_total": 53896, "num_steps_trained_this_iter": 1220, "agent_timesteps_total": 53896, "timers": {"training_iteration_time_ms": 6017.63, "load_time_ms": 1.791, "load_throughput": 687843.516, "learn_time_ms": 5759.419, "learn_throughput": 213.841, "synch_weights_time_ms": 3.722}, "counters": {"num_env_steps_sampled": 53896, "num_env_steps_trained": 53896, "num_agent_steps_sampled": 53896, "num_agent_steps_trained": 53896}, "done": false, "episodes_total": 766, "training_iteration": 44, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-29", "timestamp": 1678935809, "time_this_iter_s": 5.986247301101685, "time_total_s": 264.0304548740387, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e790d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e798e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18018cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 264.0304548740387, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.975000000000001, "ram_util_percent": 21.7125, "gpu_util_percent0": 0.7275, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6145836029271958, "cur_lr": 0.00023811142701077534, "total_loss": 0.39860369916334076, "policy_loss": -0.023052575221067077, "vf_loss": 0.40729834602210724, "vf_explained_var": 0.691660090072735, "kl": 0.02715605156242034, "entropy": 0.8336810159253645, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 50475.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 55111, "num_env_steps_trained": 55111, "num_agent_steps_sampled": 55111, "num_agent_steps_trained": 55111}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.515312266856941, "episode_len_mean": 77.61, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605], "episode_lengths": [140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19024360779487295, "mean_inference_ms": 0.5122486753312078, "mean_action_processing_ms": 0.11541946113160712, "mean_env_wait_ms": 0.08184654177722944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033261775970458984, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.06402397155761719}}, "episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.515312266856941, "episode_len_mean": 77.61, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.428433997703722, 6.679198527933383, 9.832673807195711, 9.07286624359186, 9.88441104480849, 9.759977668685512, 9.994113812284095, 9.793074987925756, 9.61010777185052, 7.919489016183637, 8.356800443275912, 9.584849579003818, 9.902018755336826, 9.656850531404876, 9.198824033812613, 8.482607447639108, 9.96303688746137, 9.785877072312756, 9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605], "episode_lengths": [140, 113, 146, 114, 108, 19, 21, 106, 98, 150, 100, 114, 140, 72, 72, 100, 116, 100, 32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19024360779487295, "mean_inference_ms": 0.5122486753312078, "mean_action_processing_ms": 0.11541946113160712, "mean_env_wait_ms": 0.08184654177722944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033261775970458984, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.06402397155761719}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55111, "num_agent_steps_trained": 55111, "num_env_steps_sampled": 55111, "num_env_steps_trained": 55111, "num_env_steps_sampled_this_iter": 1215, "num_env_steps_trained_this_iter": 1215, "timesteps_total": 55111, "num_steps_trained_this_iter": 1215, "agent_timesteps_total": 55111, "timers": {"training_iteration_time_ms": 6068.771, "load_time_ms": 1.688, "load_throughput": 735431.164, "learn_time_ms": 5801.932, "learn_throughput": 213.929, "synch_weights_time_ms": 3.71}, "counters": {"num_env_steps_sampled": 55111, "num_env_steps_trained": 55111, "num_agent_steps_sampled": 55111, "num_agent_steps_trained": 55111}, "done": false, "episodes_total": 785, "training_iteration": 45, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-35", "timestamp": 1678935815, "time_this_iter_s": 5.933241367340088, "time_total_s": 269.9636962413788, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9b220>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9bcd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801cab80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 269.9636962413788, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.5625, "ram_util_percent": 21.775, "gpu_util_percent0": 0.715, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9218754043907936, "cur_lr": 0.00023811142701077537, "total_loss": 0.12827383150992333, "policy_loss": -0.026405410310969903, "vf_loss": 0.15409216502478393, "vf_explained_var": 0.38932205601635145, "kl": 0.0029715946326613236, "entropy": 0.7695485143070547, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 56362, "num_env_steps_trained": 56362, "num_agent_steps_sampled": 56362, "num_agent_steps_trained": 56362}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.052957303916121, "episode_len_mean": 71.83, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274], "episode_lengths": [32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19014005053391983, "mean_inference_ms": 0.5121567179272752, "mean_action_processing_ms": 0.11538730655591525, "mean_env_wait_ms": 0.0818279513794249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034055709838867188, "StateBufferConnector_ms": 0.0032165050506591797, "ViewRequirementAgentConnector_ms": 0.06409502029418945}}, "episode_reward_max": 10.0, "episode_reward_min": -41.272381223802434, "episode_reward_mean": 7.052957303916121, "episode_len_mean": 71.83, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.618155208295526, 8.714225561594095, 8.598421721487835, 9.85875196494595, 9.985461652690105, 9.873748218053661, 9.720937791950323, 9.953669607027999, 9.132319302696555, 9.964190896145414, -41.272381223802434, 9.724915173524272, 9.90599288384105, 9.87482226864364, 9.540155967755512, 9.981214385233883, 9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274], "episode_lengths": [32, 144, 145, 19, 28, 50, 58, 11, 107, 63, 61, 35, 28, 89, 132, 2, 14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19014005053391983, "mean_inference_ms": 0.5121567179272752, "mean_action_processing_ms": 0.11538730655591525, "mean_env_wait_ms": 0.0818279513794249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034055709838867188, "StateBufferConnector_ms": 0.0032165050506591797, "ViewRequirementAgentConnector_ms": 0.06409502029418945}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56362, "num_agent_steps_trained": 56362, "num_env_steps_sampled": 56362, "num_env_steps_trained": 56362, "num_env_steps_sampled_this_iter": 1251, "num_env_steps_trained_this_iter": 1251, "timesteps_total": 56362, "num_steps_trained_this_iter": 1251, "agent_timesteps_total": 56362, "timers": {"training_iteration_time_ms": 6032.159, "load_time_ms": 1.885, "load_throughput": 655910.528, "learn_time_ms": 5767.029, "learn_throughput": 214.339, "synch_weights_time_ms": 3.702}, "counters": {"num_env_steps_sampled": 56362, "num_env_steps_trained": 56362, "num_agent_steps_sampled": 56362, "num_agent_steps_trained": 56362}, "done": false, "episodes_total": 803, "training_iteration": 46, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-41", "timestamp": 1678935821, "time_this_iter_s": 6.094141960144043, "time_total_s": 276.0578382015228, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18044bcd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18044bf40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1801c6e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 276.0578382015228, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1625, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7475, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4609377021953969, "cur_lr": 0.00023811142701077534, "total_loss": 0.7506578088021703, "policy_loss": -0.05587278705190968, "vf_loss": 0.7999183472227054, "vf_explained_var": 0.7150901589307699, "kl": 0.018711786804887796, "entropy": 0.7196183308824763, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 52755.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 57565, "num_env_steps_trained": 57565, "num_agent_steps_sampled": 57565, "num_agent_steps_trained": 57565}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.067743568282545, "episode_reward_mean": 7.422349358047431, "episode_len_mean": 73.82, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499], "episode_lengths": [14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902930845435457, "mean_inference_ms": 0.5125848463071097, "mean_action_processing_ms": 0.11549647185611754, "mean_env_wait_ms": 0.08187014729778853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.003288745880126953, "ViewRequirementAgentConnector_ms": 0.06444001197814941}}, "episode_reward_max": 10.0, "episode_reward_min": -41.067743568282545, "episode_reward_mean": 7.422349358047431, "episode_len_mean": 73.82, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.911103242556303, 8.940432965777461, 9.16932032524111, 9.496659393482078, 9.51069116683148, 9.785389666059594, 9.600769664906045, 9.697763403317337, 9.567072641408199, 9.82056813341841, 9.50316529701643, 9.749394392042689, 9.579808613750572, -40.18850531442237, 9.37977705073077, 9.918211192265943, 9.972023632534118, 9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499], "episode_lengths": [14, 117, 92, 86, 42, 116, 28, 25, 59, 77, 20, 103, 133, 102, 67, 42, 43, 31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1902930845435457, "mean_inference_ms": 0.5125848463071097, "mean_action_processing_ms": 0.11549647185611754, "mean_env_wait_ms": 0.08187014729778853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003482818603515625, "StateBufferConnector_ms": 0.003288745880126953, "ViewRequirementAgentConnector_ms": 0.06444001197814941}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57565, "num_agent_steps_trained": 57565, "num_env_steps_sampled": 57565, "num_env_steps_trained": 57565, "num_env_steps_sampled_this_iter": 1203, "num_env_steps_trained_this_iter": 1203, "timesteps_total": 57565, "num_steps_trained_this_iter": 1203, "agent_timesteps_total": 57565, "timers": {"training_iteration_time_ms": 5983.862, "load_time_ms": 1.894, "load_throughput": 650032.916, "learn_time_ms": 5719.908, "learn_throughput": 215.266, "synch_weights_time_ms": 4.123}, "counters": {"num_env_steps_sampled": 57565, "num_env_steps_trained": 57565, "num_agent_steps_sampled": 57565, "num_agent_steps_trained": 57565}, "done": false, "episodes_total": 819, "training_iteration": 47, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-03-47", "timestamp": 1678935827, "time_this_iter_s": 5.667273283004761, "time_total_s": 281.7251114845276, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e9c520>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e9c160>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 281.7251114845276, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.975, "ram_util_percent": 20.0, "gpu_util_percent0": 0.5775, "vram_util_percent0": 0.029022216796875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4609377021953968, "cur_lr": 0.00023811142701077532, "total_loss": 0.06699880148516968, "policy_loss": -0.005579778641738273, "vf_loss": 0.06533921809975625, "vf_explained_var": 0.8650497676045806, "kl": 0.02077595882927672, "entropy": 0.8355842364331086, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 53850.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 58748, "num_env_steps_trained": 58748, "num_agent_steps_sampled": 58748, "num_agent_steps_trained": 58748}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.067743568282545, "episode_reward_mean": 7.931524284400078, "episode_len_mean": 73.99, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075], "episode_lengths": [31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19041619679623514, "mean_inference_ms": 0.513139324925641, "mean_action_processing_ms": 0.1156297422108829, "mean_env_wait_ms": 0.0819172122902358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.0035598278045654297, "ViewRequirementAgentConnector_ms": 0.06774735450744629}}, "episode_reward_max": 10.0, "episode_reward_min": -41.067743568282545, "episode_reward_mean": 7.931524284400078, "episode_len_mean": 73.99, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.995329332045728, 9.682698658594273, 7.458967198825986, 9.355341363647623, 9.634731502130379, 9.681149583823371, 10.0, 9.920144360476046, 9.406107993379193, 9.931531107114981, 8.758158162898596, 9.844089254053646, 9.816281332367785, 9.961486974782831, -41.067743568282545, 9.797152703971594, 9.332294324684804, 9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075], "episode_lengths": [31, 91, 98, 137, 132, 118, 1, 141, 99, 106, 124, 34, 76, 80, 59, 47, 142, 29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19041619679623514, "mean_inference_ms": 0.513139324925641, "mean_action_processing_ms": 0.1156297422108829, "mean_env_wait_ms": 0.0819172122902358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003682374954223633, "StateBufferConnector_ms": 0.0035598278045654297, "ViewRequirementAgentConnector_ms": 0.06774735450744629}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58748, "num_agent_steps_trained": 58748, "num_env_steps_sampled": 58748, "num_env_steps_trained": 58748, "num_env_steps_sampled_this_iter": 1183, "num_env_steps_trained_this_iter": 1183, "timesteps_total": 58748, "num_steps_trained_this_iter": 1183, "agent_timesteps_total": 58748, "timers": {"training_iteration_time_ms": 5906.412, "load_time_ms": 2.051, "load_throughput": 595543.879, "learn_time_ms": 5634.849, "learn_throughput": 216.794, "synch_weights_time_ms": 4.162}, "counters": {"num_env_steps_sampled": 58748, "num_env_steps_trained": 58748, "num_agent_steps_sampled": 58748, "num_agent_steps_trained": 58748}, "done": false, "episodes_total": 836, "training_iteration": 48, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-03", "timestamp": 1678935843, "time_this_iter_s": 5.784186124801636, "time_total_s": 287.5092976093292, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769af1dc0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769af16d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18013c670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 287.5092976093292, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 20.857142857142858, "ram_util_percent": 19.238095238095234, "gpu_util_percent0": 0.26285714285714284, "vram_util_percent0": 0.026602608816964284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6914065532930954, "cur_lr": 0.00023811142701077537, "total_loss": 0.0011376280958453814, "policy_loss": -0.07901644525874374, "vf_loss": 0.07047291740232334, "vf_explained_var": 0.7031506861886407, "kl": 0.017225582491478132, "entropy": 0.7968490831362895, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 54975.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 60027, "num_env_steps_trained": 60027, "num_agent_steps_sampled": 60027, "num_agent_steps_trained": 60027}, "sampler_results": {"episode_reward_max": 9.999861468680795, "episode_reward_min": -40.60858918227191, "episode_reward_mean": 8.432466862285986, "episode_len_mean": 71.62, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268], "episode_lengths": [29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19045982409920065, "mean_inference_ms": 0.5133946268063645, "mean_action_processing_ms": 0.11566734574156139, "mean_env_wait_ms": 0.08196154270469526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037050247192382812, "StateBufferConnector_ms": 0.003454923629760742, "ViewRequirementAgentConnector_ms": 0.06750273704528809}}, "episode_reward_max": 9.999861468680795, "episode_reward_min": -40.60858918227191, "episode_reward_mean": 8.432466862285986, "episode_len_mean": 71.62, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.950464782278416, 9.838131095783613, 9.991098973644645, 7.9925213502620585, 9.915895386098954, 9.945915247419494, 9.984387582013955, 9.889348487542744, 9.855823325245598, 9.789762982753969, 9.679675534481053, 9.747471271186601, 9.047898732416353, 9.856773938452205, 9.519034531869632, 9.689795354472395, 9.90649348561377, 9.991134968798809, 8.886689400149749, 9.993371340497196, -40.60858918227191, 9.930488691072183, 9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268], "episode_lengths": [29, 147, 20, 131, 30, 11, 99, 60, 103, 55, 93, 124, 129, 73, 59, 45, 139, 10, 140, 28, 34, 12, 6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19045982409920065, "mean_inference_ms": 0.5133946268063645, "mean_action_processing_ms": 0.11566734574156139, "mean_env_wait_ms": 0.08196154270469526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037050247192382812, "StateBufferConnector_ms": 0.003454923629760742, "ViewRequirementAgentConnector_ms": 0.06750273704528809}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60027, "num_agent_steps_trained": 60027, "num_env_steps_sampled": 60027, "num_env_steps_trained": 60027, "num_env_steps_sampled_this_iter": 1279, "num_env_steps_trained_this_iter": 1279, "timesteps_total": 60027, "num_steps_trained_this_iter": 1279, "agent_timesteps_total": 60027, "timers": {"training_iteration_time_ms": 5942.869, "load_time_ms": 2.017, "load_throughput": 608705.048, "learn_time_ms": 5668.34, "learn_throughput": 216.607, "synch_weights_time_ms": 4.246}, "counters": {"num_env_steps_sampled": 60027, "num_env_steps_trained": 60027, "num_agent_steps_sampled": 60027, "num_agent_steps_trained": 60027}, "done": false, "episodes_total": 853, "training_iteration": 49, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-09", "timestamp": 1678935849, "time_this_iter_s": 6.233499765396118, "time_total_s": 293.74279737472534, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654296790>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654296bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033a3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 293.74279737472534, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.922222222222224, "ram_util_percent": 21.655555555555555, "gpu_util_percent0": 0.65, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6914065532930954, "cur_lr": 0.00023811142701077534, "total_loss": -0.04363206632939788, "policy_loss": -0.08900052598476701, "vf_loss": 0.03417711092082683, "vf_explained_var": 0.8203551191325281, "kl": 0.01929581562911993, "entropy": 0.7686681075131192, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 56070.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 61144, "num_env_steps_trained": 61144, "num_agent_steps_sampled": 61144, "num_agent_steps_trained": 61144}, "sampler_results": {"episode_reward_max": 9.999861468680795, "episode_reward_min": -40.000393394501074, "episode_reward_mean": 8.932915779018533, "episode_len_mean": 67.08, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264], "episode_lengths": [6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19032679598118918, "mean_inference_ms": 0.5126635501891176, "mean_action_processing_ms": 0.11554998530471706, "mean_env_wait_ms": 0.08183091817506195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.003845691680908203, "ViewRequirementAgentConnector_ms": 0.06530356407165527}}, "episode_reward_max": 9.999861468680795, "episode_reward_min": -40.000393394501074, "episode_reward_mean": 8.932915779018533, "episode_len_mean": 67.08, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.998893030241664, 8.634638145015453, 9.85214294949802, 9.63074382237253, 8.529498362676765, 9.522355308287308, 9.983730838857527, 9.233599770767473, 9.961142809457353, 9.389715608814605, 9.92518533879826, 9.823147387304697, 9.981666144225413, 9.824735250674447, 9.96685609340781, 9.967874188777234, 7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264], "episode_lengths": [6, 114, 74, 48, 143, 49, 33, 76, 57, 75, 39, 23, 71, 85, 3, 84, 98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19032679598118918, "mean_inference_ms": 0.5126635501891176, "mean_action_processing_ms": 0.11554998530471706, "mean_env_wait_ms": 0.08183091817506195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036628246307373047, "StateBufferConnector_ms": 0.003845691680908203, "ViewRequirementAgentConnector_ms": 0.06530356407165527}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61144, "num_agent_steps_trained": 61144, "num_env_steps_sampled": 61144, "num_env_steps_trained": 61144, "num_env_steps_sampled_this_iter": 1117, "num_env_steps_trained_this_iter": 1117, "timesteps_total": 61144, "num_steps_trained_this_iter": 1117, "agent_timesteps_total": 61144, "timers": {"training_iteration_time_ms": 5896.178, "load_time_ms": 2.007, "load_throughput": 606995.569, "learn_time_ms": 5617.877, "learn_throughput": 216.826, "synch_weights_time_ms": 4.189}, "counters": {"num_env_steps_sampled": 61144, "num_env_steps_trained": 61144, "num_agent_steps_sampled": 61144, "num_agent_steps_trained": 61144}, "done": false, "episodes_total": 875, "training_iteration": 50, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-14", "timestamp": 1678935854, "time_this_iter_s": 5.363680124282837, "time_total_s": 299.1064774990082, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18044b9d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18044b820>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18017eb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 299.1064774990082, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.342857142857143, "ram_util_percent": 21.599999999999998, "gpu_util_percent0": 0.7557142857142856, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6914065532930954, "cur_lr": 0.00023811142701077537, "total_loss": 0.0594622757883432, "policy_loss": -0.06592300934096178, "vf_loss": 0.08758498098769148, "vf_explained_var": 0.8472174910704294, "kl": 0.05815914404980506, "entropy": 0.8621298345550895, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 57180.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 62424, "num_env_steps_trained": 62424, "num_agent_steps_sampled": 62424, "num_agent_steps_trained": 62424}, "sampler_results": {"episode_reward_max": 9.999861468680795, "episode_reward_min": -40.000393394501074, "episode_reward_mean": 8.9216528280453, "episode_len_mean": 70.08, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842], "episode_lengths": [98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19023178691968418, "mean_inference_ms": 0.5125640518720519, "mean_action_processing_ms": 0.1155114712259353, "mean_env_wait_ms": 0.08181511847616947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0036895275115966797, "ViewRequirementAgentConnector_ms": 0.06458330154418945}}, "episode_reward_max": 9.999861468680795, "episode_reward_min": -40.000393394501074, "episode_reward_mean": 8.9216528280453, "episode_len_mean": 70.08, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.958120299002493, 9.997052209227517, 9.968128460000369, 8.327860636750913, 7.963769054237851, 8.759816904759397, 7.924796534271907, -40.000393394501074, 9.92390156295977, 9.917994668265848, 9.507847739606994, 9.931356256558274, 9.954759227540832, 9.45395253813327, 9.904872806621675, 9.995667247913838, 9.997064366911086, 9.31693500234022, 9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842], "episode_lengths": [98, 7, 107, 167, 151, 114, 95, 2, 55, 55, 35, 60, 29, 88, 63, 26, 7, 75, 92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19023178691968418, "mean_inference_ms": 0.5125640518720519, "mean_action_processing_ms": 0.1155114712259353, "mean_env_wait_ms": 0.08181511847616947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003696918487548828, "StateBufferConnector_ms": 0.0036895275115966797, "ViewRequirementAgentConnector_ms": 0.06458330154418945}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62424, "num_agent_steps_trained": 62424, "num_env_steps_sampled": 62424, "num_env_steps_trained": 62424, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 62424, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 62424, "timers": {"training_iteration_time_ms": 5865.604, "load_time_ms": 1.991, "load_throughput": 608117.587, "learn_time_ms": 5593.714, "learn_throughput": 216.493, "synch_weights_time_ms": 4.186}, "counters": {"num_env_steps_sampled": 62424, "num_env_steps_trained": 62424, "num_agent_steps_sampled": 62424, "num_agent_steps_trained": 62424}, "done": false, "episodes_total": 891, "training_iteration": 51, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-21", "timestamp": 1678935861, "time_this_iter_s": 6.194124937057495, "time_total_s": 305.3006024360657, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6542bd670>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bd280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 305.3006024360657, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.0, "ram_util_percent": 21.6, "gpu_util_percent0": 0.7050000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.037109829939643, "cur_lr": 0.00023811142701077534, "total_loss": 0.07456056772760122, "policy_loss": -0.0747486925142449, "vf_loss": 0.13446277265586754, "vf_explained_var": 0.7943072307479474, "kl": 0.016484740791010297, "entropy": 0.804457597007123, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 58425.5, "diff_num_grad_updates_vs_sampler_policy": 644.5}}, "num_env_steps_sampled": 63812, "num_env_steps_trained": 63812, "num_agent_steps_sampled": 63812, "num_agent_steps_trained": 63812}, "sampler_results": {"episode_reward_max": 9.999861468680795, "episode_reward_min": -5.12500188652484, "episode_reward_mean": 9.424462477646234, "episode_len_mean": 71.62, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678], "episode_lengths": [92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19008098091901904, "mean_inference_ms": 0.5123148632742607, "mean_action_processing_ms": 0.11546759473309781, "mean_env_wait_ms": 0.08175153595520623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0034699440002441406, "ViewRequirementAgentConnector_ms": 0.06415057182312012}}, "episode_reward_max": 9.999861468680795, "episode_reward_min": -5.12500188652484, "episode_reward_mean": 9.424462477646234, "episode_len_mean": 71.62, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.875567578159426, 9.834219448199132, 9.635608283178792, 8.304530606610282, 9.770145679039622, 9.999861468680795, -5.12500188652484, 9.575887729974774, 9.98026640172605, 9.639470294709499, 9.665031091674534, 9.991924490037103, 9.906947253369076, 9.83887744031962, 9.839508514495389, 9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678], "episode_lengths": [92, 118, 46, 112, 129, 2, 119, 90, 105, 102, 90, 9, 39, 17, 47, 14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19008098091901904, "mean_inference_ms": 0.5123148632742607, "mean_action_processing_ms": 0.11546759473309781, "mean_env_wait_ms": 0.08175153595520623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037147998809814453, "StateBufferConnector_ms": 0.0034699440002441406, "ViewRequirementAgentConnector_ms": 0.06415057182312012}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63812, "num_agent_steps_trained": 63812, "num_env_steps_sampled": 63812, "num_env_steps_trained": 63812, "num_env_steps_sampled_this_iter": 1388, "num_env_steps_trained_this_iter": 1388, "timesteps_total": 63812, "num_steps_trained_this_iter": 1388, "agent_timesteps_total": 63812, "timers": {"training_iteration_time_ms": 5968.865, "load_time_ms": 2.096, "load_throughput": 588738.69, "learn_time_ms": 5692.262, "learn_throughput": 216.803, "synch_weights_time_ms": 4.178}, "counters": {"num_env_steps_sampled": 63812, "num_env_steps_trained": 63812, "num_agent_steps_sampled": 63812, "num_agent_steps_trained": 63812}, "done": false, "episodes_total": 909, "training_iteration": 52, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-27", "timestamp": 1678935867, "time_this_iter_s": 6.717526197433472, "time_total_s": 312.01812863349915, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6540d4d90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bdc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 312.01812863349915, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 14.966666666666665, "ram_util_percent": 21.61111111111111, "gpu_util_percent0": 0.6799999999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.037109829939643, "cur_lr": 0.00023811142701077537, "total_loss": 0.9526746748763527, "policy_loss": -0.06037873214381373, "vf_loss": 1.0094412724832749, "vf_explained_var": 0.6051539832710201, "kl": 0.0056362088923091426, "entropy": 0.7984631368110322, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 59655.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 65082, "num_env_steps_trained": 65082, "num_agent_steps_sampled": 65082, "num_agent_steps_trained": 65082}, "sampler_results": {"episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 8.063159533181848, "episode_len_mean": 73.15, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512], "episode_lengths": [14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18977685510415895, "mean_inference_ms": 0.5115039148247863, "mean_action_processing_ms": 0.11525932595301494, "mean_env_wait_ms": 0.08166241521571921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035767555236816406, "StateBufferConnector_ms": 0.003150463104248047, "ViewRequirementAgentConnector_ms": 0.06140494346618652}}, "episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 8.063159533181848, "episode_len_mean": 73.15, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.825618030295264, 9.111606696797113, 9.568620414110434, 9.246290993308005, 9.95548925148709, 9.952405702803665, 9.432914201100246, 9.870328469943399, 9.718953989629117, 8.918555508097786, 9.538183553292019, 9.94988250142075, 9.920651404250595, 9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512], "episode_lengths": [14, 108, 77, 73, 57, 79, 109, 74, 75, 70, 98, 147, 59, 67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18977685510415895, "mean_inference_ms": 0.5115039148247863, "mean_action_processing_ms": 0.11525932595301494, "mean_env_wait_ms": 0.08166241521571921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035767555236816406, "StateBufferConnector_ms": 0.003150463104248047, "ViewRequirementAgentConnector_ms": 0.06140494346618652}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65082, "num_agent_steps_trained": 65082, "num_env_steps_sampled": 65082, "num_env_steps_trained": 65082, "num_env_steps_sampled_this_iter": 1270, "num_env_steps_trained_this_iter": 1270, "timesteps_total": 65082, "num_steps_trained_this_iter": 1270, "agent_timesteps_total": 65082, "timers": {"training_iteration_time_ms": 5977.138, "load_time_ms": 2.055, "load_throughput": 603592.885, "learn_time_ms": 5701.851, "learn_throughput": 217.578, "synch_weights_time_ms": 2.874}, "counters": {"num_env_steps_sampled": 65082, "num_env_steps_trained": 65082, "num_agent_steps_sampled": 65082, "num_agent_steps_trained": 65082}, "done": false, "episodes_total": 924, "training_iteration": 53, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-33", "timestamp": 1678935873, "time_this_iter_s": 5.965059518814087, "time_total_s": 317.98318815231323, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6d970>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f6d790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18013c670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 317.98318815231323, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.5625, "ram_util_percent": 21.75, "gpu_util_percent0": 0.6637500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.037109829939643, "cur_lr": 0.00023811142701077534, "total_loss": 0.7169744512760172, "policy_loss": -0.013601297300820258, "vf_loss": 0.6955572785311447, "vf_explained_var": 0.6175241425341251, "kl": 0.035840762820653814, "entropy": 0.7695399136812079, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 60750.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 66196, "num_env_steps_trained": 66196, "num_agent_steps_sampled": 66196, "num_agent_steps_trained": 66196}, "sampler_results": {"episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.556166655067799, "episode_len_mean": 73.89, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373], "episode_lengths": [67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18959531315572264, "mean_inference_ms": 0.5108962469901067, "mean_action_processing_ms": 0.11514411065216519, "mean_env_wait_ms": 0.08155223880846461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0032236576080322266, "ViewRequirementAgentConnector_ms": 0.06064796447753906}}, "episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.556166655067799, "episode_len_mean": 73.89, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.75715208456714, 8.020775419156225, 9.998568587312032, 9.379442783382139, 8.012134642346183, 9.964589276689978, 9.97498297818184, 9.664063602078324, 9.979486122003935, 9.303243870163797, 9.869471449550083, 9.97098259179027, 9.252732607547772, 9.332692479215826, 9.94512964106474, 9.255878533804268, 9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373], "episode_lengths": [67, 120, 10, 42, 109, 118, 108, 113, 12, 143, 20, 65, 43, 47, 76, 127, 4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18959531315572264, "mean_inference_ms": 0.5108962469901067, "mean_action_processing_ms": 0.11514411065216519, "mean_env_wait_ms": 0.08155223880846461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003545522689819336, "StateBufferConnector_ms": 0.0032236576080322266, "ViewRequirementAgentConnector_ms": 0.06064796447753906}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66196, "num_agent_steps_trained": 66196, "num_env_steps_sampled": 66196, "num_env_steps_trained": 66196, "num_env_steps_sampled_this_iter": 1114, "num_env_steps_trained_this_iter": 1114, "timesteps_total": 66196, "num_steps_trained_this_iter": 1114, "agent_timesteps_total": 66196, "timers": {"training_iteration_time_ms": 5917.127, "load_time_ms": 2.232, "load_throughput": 551162.787, "learn_time_ms": 5643.896, "learn_throughput": 217.935, "synch_weights_time_ms": 2.977}, "counters": {"num_env_steps_sampled": 66196, "num_env_steps_trained": 66196, "num_agent_steps_sampled": 66196, "num_agent_steps_trained": 66196}, "done": false, "episodes_total": 937, "training_iteration": 54, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-39", "timestamp": 1678935879, "time_this_iter_s": 5.386939525604248, "time_total_s": 323.3701276779175, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f139d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f13790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 323.3701276779175, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.1125, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5556647449094643, "cur_lr": 0.00023811142701077537, "total_loss": -0.010297072998797282, "policy_loss": -0.08002042417597567, "vf_loss": 0.06592815868341578, "vf_explained_var": 0.7279466928070427, "kl": 0.0038857504820479106, "entropy": 0.8043601523607206, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 67462, "num_env_steps_trained": 67462, "num_agent_steps_sampled": 67462, "num_agent_steps_trained": 67462}, "sampler_results": {"episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.556857973854868, "episode_len_mean": 74.35, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772], "episode_lengths": [4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18944297248115533, "mean_inference_ms": 0.5105615175570197, "mean_action_processing_ms": 0.11506953902006027, "mean_env_wait_ms": 0.08147711952182783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003609895706176758, "StateBufferConnector_ms": 0.0032646656036376953, "ViewRequirementAgentConnector_ms": 0.06162691116333008}}, "episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.556857973854868, "episode_len_mean": 74.35, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.99211867747002, 9.49444227712081, 9.966747128872456, 9.895083907758478, 9.81679704246891, 9.90553320634856, 9.93772817249918, 8.75953345242322, 9.28898839316086, 9.951697703690716, 9.998360306096632, 8.771043713183406, 9.911369987005196, 9.63546160131145, 9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772], "episode_lengths": [4, 46, 73, 40, 40, 126, 6, 79, 62, 3, 15, 131, 9, 31, 34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18944297248115533, "mean_inference_ms": 0.5105615175570197, "mean_action_processing_ms": 0.11506953902006027, "mean_env_wait_ms": 0.08147711952182783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003609895706176758, "StateBufferConnector_ms": 0.0032646656036376953, "ViewRequirementAgentConnector_ms": 0.06162691116333008}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67462, "num_agent_steps_trained": 67462, "num_env_steps_sampled": 67462, "num_env_steps_trained": 67462, "num_env_steps_sampled_this_iter": 1266, "num_env_steps_trained_this_iter": 1266, "timesteps_total": 67462, "num_steps_trained_this_iter": 1266, "agent_timesteps_total": 67462, "timers": {"training_iteration_time_ms": 5930.357, "load_time_ms": 2.314, "load_throughput": 533763.149, "learn_time_ms": 5663.058, "learn_throughput": 218.098, "synch_weights_time_ms": 2.936}, "counters": {"num_env_steps_sampled": 67462, "num_env_steps_trained": 67462, "num_agent_steps_sampled": 67462, "num_agent_steps_trained": 67462}, "done": false, "episodes_total": 953, "training_iteration": 55, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-45", "timestamp": 1678935885, "time_this_iter_s": 6.064342737197876, "time_total_s": 329.43447041511536, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042d430>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042dc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033a3a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 329.43447041511536, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.287500000000001, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7075, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7778323724547321, "cur_lr": 0.00023811142701077534, "total_loss": -0.03490689746046498, "policy_loss": -0.10387228206303474, "vf_loss": 0.038827779658059045, "vf_explained_var": 0.8118208455609845, "kl": 0.04176302199061991, "entropy": 0.839147523622792, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 62985.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 68655, "num_env_steps_trained": 68655, "num_agent_steps_sampled": 68655, "num_agent_steps_trained": 68655}, "sampler_results": {"episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.554767079019798, "episode_len_mean": 79.63, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577], "episode_lengths": [34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18908786330608116, "mean_inference_ms": 0.5093353436139539, "mean_action_processing_ms": 0.11479930300727789, "mean_env_wait_ms": 0.08131801132009685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035932064056396484, "StateBufferConnector_ms": 0.0029366016387939453, "ViewRequirementAgentConnector_ms": 0.06111431121826172}}, "episode_reward_max": 9.999601684521297, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.554767079019798, "episode_len_mean": 79.63, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.980589979547648, 9.967686960945237, 9.18985567739352, 9.91662974373586, 9.999173264904103, 9.64318966405962, 9.918513307552004, 8.897934785488264, 9.830125904990414, 9.615541987999684, 8.835803603467614, 9.78349809584096, 8.413782244024105, 9.98327526520533, 9.999601684521297, 9.925695588874577, 9.563314564153796, 8.870162216314563, 9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577], "episode_lengths": [34, 33, 113, 107, 6, 21, 9, 129, 99, 44, 107, 78, 106, 91, 4, 89, 45, 89, 44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18908786330608116, "mean_inference_ms": 0.5093353436139539, "mean_action_processing_ms": 0.11479930300727789, "mean_env_wait_ms": 0.08131801132009685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035932064056396484, "StateBufferConnector_ms": 0.0029366016387939453, "ViewRequirementAgentConnector_ms": 0.06111431121826172}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68655, "num_agent_steps_trained": 68655, "num_env_steps_sampled": 68655, "num_env_steps_trained": 68655, "num_env_steps_sampled_this_iter": 1193, "num_env_steps_trained_this_iter": 1193, "timesteps_total": 68655, "num_steps_trained_this_iter": 1193, "agent_timesteps_total": 68655, "timers": {"training_iteration_time_ms": 5906.336, "load_time_ms": 2.264, "load_throughput": 542948.687, "learn_time_ms": 5640.91, "learn_throughput": 217.926, "synch_weights_time_ms": 2.935}, "counters": {"num_env_steps_sampled": 68655, "num_env_steps_trained": 68655, "num_agent_steps_sampled": 68655, "num_agent_steps_trained": 68655}, "done": false, "episodes_total": 967, "training_iteration": 56, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-51", "timestamp": 1678935891, "time_this_iter_s": 5.854234218597412, "time_total_s": 335.28870463371277, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b0be20>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed4190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180024a60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 335.28870463371277, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.025000000000002, "ram_util_percent": 21.7, "gpu_util_percent0": 0.6975, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1667485586820983, "cur_lr": 0.0002381114270107754, "total_loss": -0.06676160233307696, "policy_loss": -0.09979093489482214, "vf_loss": 0.01608002229232194, "vf_explained_var": 0.7669256629651053, "kl": 0.016769102603672797, "entropy": 0.9353221202890079, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 64110.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 69874, "num_env_steps_trained": 69874, "num_agent_steps_sampled": 69874, "num_agent_steps_trained": 69874}, "sampler_results": {"episode_reward_max": 9.999332056102453, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.588159866853118, "episode_len_mean": 79.78, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074], "episode_lengths": [44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18888031273870404, "mean_inference_ms": 0.5088472410109549, "mean_action_processing_ms": 0.11468394832350355, "mean_env_wait_ms": 0.08123029781003062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.0628061294555664}}, "episode_reward_max": 9.999332056102453, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.588159866853118, "episode_len_mean": 79.78, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.520766262942345, 9.58541091200499, 9.984851092503318, 9.697642767924561, 9.652485629026899, 9.837672132058842, 9.414436566291641, 9.47060829282183, 9.62344259645789, 9.382416795787787, 7.474481849429637, 9.517023995420846, 9.968526766359304, 9.623618959667716, 9.574054788358906, 9.734326819145384, 9.877073565810452, 9.510948465321647, 9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074], "episode_lengths": [44, 38, 34, 143, 149, 120, 55, 101, 39, 136, 104, 56, 13, 94, 77, 39, 104, 50, 17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18888031273870404, "mean_inference_ms": 0.5088472410109549, "mean_action_processing_ms": 0.11468394832350355, "mean_env_wait_ms": 0.08123029781003062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003774881362915039, "StateBufferConnector_ms": 0.0030236244201660156, "ViewRequirementAgentConnector_ms": 0.0628061294555664}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69874, "num_agent_steps_trained": 69874, "num_env_steps_sampled": 69874, "num_env_steps_trained": 69874, "num_env_steps_sampled_this_iter": 1219, "num_env_steps_trained_this_iter": 1219, "timesteps_total": 69874, "num_steps_trained_this_iter": 1219, "agent_timesteps_total": 69874, "timers": {"training_iteration_time_ms": 5940.789, "load_time_ms": 2.227, "load_throughput": 552616.971, "learn_time_ms": 5671.092, "learn_throughput": 217.048, "synch_weights_time_ms": 2.513}, "counters": {"num_env_steps_sampled": 69874, "num_env_steps_trained": 69874, "num_agent_steps_sampled": 69874, "num_agent_steps_trained": 69874}, "done": false, "episodes_total": 985, "training_iteration": 57, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-04-57", "timestamp": 1678935897, "time_this_iter_s": 5.908377408981323, "time_total_s": 341.1970820426941, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b0bf10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769b0b250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1805f14c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 341.1970820426941, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.0125, "ram_util_percent": 21.7, "gpu_util_percent0": 0.75375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1667485586820985, "cur_lr": 0.00023811142701077534, "total_loss": -0.04670455406570958, "policy_loss": -0.09513786637836748, "vf_loss": 0.011181253713643731, "vf_explained_var": 0.8647149843138617, "kl": 0.034119199225188745, "entropy": 0.9140290406641659, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 65235.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 71075, "num_env_steps_trained": 71075, "num_agent_steps_sampled": 71075, "num_agent_steps_trained": 71075}, "sampler_results": {"episode_reward_max": 9.999332056102453, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.636347009388101, "episode_len_mean": 77.83, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226], "episode_lengths": [17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18871485941579294, "mean_inference_ms": 0.5085336588781865, "mean_action_processing_ms": 0.11463100931220893, "mean_env_wait_ms": 0.081146523759939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641843795776367, "StateBufferConnector_ms": 0.0031287670135498047, "ViewRequirementAgentConnector_ms": 0.06367897987365723}}, "episode_reward_max": 9.999332056102453, "episode_reward_min": -40.65306112249206, "episode_reward_mean": 7.636347009388101, "episode_len_mean": 77.83, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.8919536572614, 9.981773919903867, 8.20010595248516, 8.805764498800459, 9.755306366972995, 9.278603224397678, 9.704172044324798, 9.440508050971463, -40.25876707634422, 9.583587974844665, -40.65306112249206, 9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226], "episode_lengths": [17, 70, 142, 132, 32, 127, 114, 132, 44, 113, 48, 118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18871485941579294, "mean_inference_ms": 0.5085336588781865, "mean_action_processing_ms": 0.11463100931220893, "mean_env_wait_ms": 0.081146523759939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641843795776367, "StateBufferConnector_ms": 0.0031287670135498047, "ViewRequirementAgentConnector_ms": 0.06367897987365723}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71075, "num_agent_steps_trained": 71075, "num_env_steps_sampled": 71075, "num_env_steps_trained": 71075, "num_env_steps_sampled_this_iter": 1201, "num_env_steps_trained_this_iter": 1201, "timesteps_total": 71075, "num_steps_trained_this_iter": 1201, "agent_timesteps_total": 71075, "timers": {"training_iteration_time_ms": 5950.118, "load_time_ms": 2.118, "load_throughput": 582033.337, "learn_time_ms": 5687.186, "learn_throughput": 216.75, "synch_weights_time_ms": 2.48}, "counters": {"num_env_steps_sampled": 71075, "num_env_steps_trained": 71075, "num_agent_steps_sampled": 71075, "num_agent_steps_trained": 71075}, "done": false, "episodes_total": 1003, "training_iteration": 58, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-05-03", "timestamp": 1678935903, "time_this_iter_s": 5.876829385757446, "time_total_s": 347.07391142845154, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b0ba30>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769b0b550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180025670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 347.07391142845154, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.424999999999997, "ram_util_percent": 21.725, "gpu_util_percent0": 0.6925, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7501228380231473, "cur_lr": 0.00023811142701077532, "total_loss": -0.041550401253280814, "policy_loss": -0.08762825719874215, "vf_loss": 0.01581747467250723, "vf_explained_var": 0.8953487061240055, "kl": 0.018768066977493936, "entropy": 0.924604671255306, "entropy_coeff": 0.002796916945229029}, "model": {}, "num_grad_updates_lifetime": 66330.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 72252, "num_env_steps_trained": 72252, "num_agent_steps_sampled": 72252, "num_agent_steps_trained": 72252}, "sampler_results": {"episode_reward_max": 9.999332056102453, "episode_reward_min": -40.12917762448035, "episode_reward_mean": 8.65696049603812, "episode_len_mean": 79.89, "episode_media": {}, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314], "episode_lengths": [118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1886344145628027, "mean_inference_ms": 0.508475473016055, "mean_action_processing_ms": 0.11462171003502768, "mean_env_wait_ms": 0.08111769009290622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.0031583309173583984, "ViewRequirementAgentConnector_ms": 0.06445646286010742}}, "episode_reward_max": 9.999332056102453, "episode_reward_min": -40.12917762448035, "episode_reward_mean": 8.65696049603812, "episode_len_mean": 79.89, "episodes_this_iter": 11, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.89586033323514, 9.986940839387717, 9.257096031950738, 9.283867080661961, 9.919284086397658, 9.969239580859849, -40.12917762448035, 9.882851314178122, 9.975812628679899, 8.744335805035512, 9.89794416345346, 9.785954626675116, 9.923809292514306, 9.606591729904016, 9.946721938124508, 9.860964827445299, 9.891140134751984, 8.178961717831163, 9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314], "episode_lengths": [118, 62, 87, 136, 143, 18, 31, 94, 32, 98, 76, 130, 90, 40, 118, 140, 64, 148, 30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1886344145628027, "mean_inference_ms": 0.508475473016055, "mean_action_processing_ms": 0.11462171003502768, "mean_env_wait_ms": 0.08111769009290622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003660917282104492, "StateBufferConnector_ms": 0.0031583309173583984, "ViewRequirementAgentConnector_ms": 0.06445646286010742}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72252, "num_agent_steps_trained": 72252, "num_env_steps_sampled": 72252, "num_env_steps_trained": 72252, "num_env_steps_sampled_this_iter": 1177, "num_env_steps_trained_this_iter": 1177, "timesteps_total": 72252, "num_steps_trained_this_iter": 1177, "agent_timesteps_total": 72252, "timers": {"training_iteration_time_ms": 5903.421, "load_time_ms": 2.242, "load_throughput": 545210.016, "learn_time_ms": 5639.487, "learn_throughput": 216.775, "synch_weights_time_ms": 2.401}, "counters": {"num_env_steps_sampled": 72252, "num_env_steps_trained": 72252, "num_agent_steps_sampled": 72252, "num_agent_steps_trained": 72252}, "done": false, "episodes_total": 1014, "training_iteration": 59, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-05-08", "timestamp": 1678935908, "time_this_iter_s": 5.7659592628479, "time_total_s": 352.83987069129944, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1804e8e50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1804e8460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff18033cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 352.83987069129944, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.671428571428569, "ram_util_percent": 21.714285714285715, "gpu_util_percent0": 0.7557142857142856, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.997258514295627, "episode_reward_min": -40.70259303736784, "episode_reward_mean": -0.31164799876382326, "episode_len_mean": 68.6, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.997258514295627, -40.42504470289044, 9.996673605200359, -40.70259303736784, 9.958875521003558, 9.969784767677085, 9.640772034635821, 9.26625460004734, 9.949000395380173, 9.246686629686927, 9.413792439475554, 9.725802930867756, 9.612427963934284, -40.25178309430743, 9.927371450903875], "episode_lengths": [7, 77, 12, 63, 90, 26, 109, 109, 40, 114, 134, 33, 121, 34, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15716762381083205, "mean_inference_ms": 0.45134120685827384, "mean_action_processing_ms": 0.1026684072198191, "mean_env_wait_ms": 0.0734637380321952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002991358439127604, "StateBufferConnector_ms": 0.0028467178344726562, "ViewRequirementAgentConnector_ms": 0.05596001942952474}, "num_agent_steps_sampled_this_iter": 1029, "num_env_steps_sampled_this_iter": 1029, "timesteps_this_iter": 1029, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7501228380231475, "cur_lr": 0.00023811142701077537, "total_loss": -0.04559603854703406, "policy_loss": -0.09267124814912676, "vf_loss": 0.011066432136431104, "vf_explained_var": 0.8819679214060306, "kl": 0.02215688741890822, "entropy": 0.9898398279647033, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 67470.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 73548, "num_env_steps_trained": 73548, "num_agent_steps_sampled": 73548, "num_agent_steps_trained": 73548}, "sampler_results": {"episode_reward_max": 9.999332056102453, "episode_reward_min": -40.02102264063236, "episode_reward_mean": 9.180194033751697, "episode_len_mean": 76.6, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314, 9.802082654869428, 9.983991456029099, 9.657080082467374, 9.99797605562105, 9.574946705717986, 9.777399677179778, 9.98729516907642, 9.224985158657294, 9.959865771468163, 9.67164462770573, 9.994343613557644, 9.975848196093803, 9.71533393715394, 9.709422118348801, 9.987893887089653, 9.98904701831853, 9.423798932047621, 9.768597216561634], "episode_lengths": [30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126, 123, 19, 107, 8, 48, 127, 67, 139, 26, 96, 26, 92, 19, 85, 26, 62, 88, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885828766180304, "mean_inference_ms": 0.5083088593329448, "mean_action_processing_ms": 0.11459426718293708, "mean_env_wait_ms": 0.08107821675944313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003589630126953125, "StateBufferConnector_ms": 0.0032465457916259766, "ViewRequirementAgentConnector_ms": 0.06501007080078125}}, "episode_reward_max": 9.999332056102453, "episode_reward_min": -40.02102264063236, "episode_reward_mean": 9.180194033751697, "episode_len_mean": 76.6, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.56625576041761, 9.962551354695396, -40.02102264063236, 7.718611964669499, 9.991728035280373, 9.98011133666371, 9.550551328775663, 9.624000822448846, 9.842999359919617, 9.478210362140494, 9.997412544212015, 9.78854869515981, 8.675090496700623, 9.873808185904517, 9.875853729204152, 9.540595907468116, 9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314, 9.802082654869428, 9.983991456029099, 9.657080082467374, 9.99797605562105, 9.574946705717986, 9.777399677179778, 9.98729516907642, 9.224985158657294, 9.959865771468163, 9.67164462770573, 9.994343613557644, 9.975848196093803, 9.71533393715394, 9.709422118348801, 9.987893887089653, 9.98904701831853, 9.423798932047621, 9.768597216561634], "episode_lengths": [30, 75, 61, 138, 4, 55, 76, 132, 44, 115, 13, 60, 75, 11, 135, 35, 129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126, 123, 19, 107, 8, 48, 127, 67, 139, 26, 96, 26, 92, 19, 85, 26, 62, 88, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1885828766180304, "mean_inference_ms": 0.5083088593329448, "mean_action_processing_ms": 0.11459426718293708, "mean_env_wait_ms": 0.08107821675944313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003589630126953125, "StateBufferConnector_ms": 0.0032465457916259766, "ViewRequirementAgentConnector_ms": 0.06501007080078125}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73548, "num_agent_steps_trained": 73548, "num_env_steps_sampled": 73548, "num_env_steps_trained": 73548, "num_env_steps_sampled_this_iter": 1296, "num_env_steps_trained_this_iter": 1296, "timesteps_total": 73548, "num_steps_trained_this_iter": 1296, "agent_timesteps_total": 73548, "timers": {"training_iteration_time_ms": 5989.238, "load_time_ms": 2.349, "load_throughput": 528093.089, "learn_time_ms": 5724.113, "learn_throughput": 216.697, "synch_weights_time_ms": 2.434}, "counters": {"num_env_steps_sampled": 73548, "num_env_steps_trained": 73548, "num_agent_steps_sampled": 73548, "num_agent_steps_trained": 73548}, "done": false, "episodes_total": 1032, "training_iteration": 60, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-05-15", "timestamp": 1678935915, "time_this_iter_s": 6.792237758636475, "time_total_s": 359.6321084499359, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769b0b0d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18044b040>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180025670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 359.6321084499359, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 15.089999999999998, "ram_util_percent": 21.669999999999998, "gpu_util_percent0": 0.681, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6251842570347215, "cur_lr": 0.00023811142701077537, "total_loss": -0.042161241859818496, "policy_loss": -0.08168046384428938, "vf_loss": 0.013359210781612394, "vf_explained_var": 0.9175529084106286, "kl": 0.0110134136216751, "entropy": 0.9840237390001615, "entropy_coeff": 0.0027969169452290287}, "model": {}, "num_grad_updates_lifetime": 68670.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 74844, "num_env_steps_trained": 74844, "num_agent_steps_sampled": 74844, "num_agent_steps_trained": 74844}, "sampler_results": {"episode_reward_max": 9.999332056102453, "episode_reward_min": 8.066260009574666, "episode_reward_mean": 9.716571701095878, "episode_len_mean": 78.97, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314, 9.802082654869428, 9.983991456029099, 9.657080082467374, 9.99797605562105, 9.574946705717986, 9.777399677179778, 9.98729516907642, 9.224985158657294, 9.959865771468163, 9.67164462770573, 9.994343613557644, 9.975848196093803, 9.71533393715394, 9.709422118348801, 9.987893887089653, 9.98904701831853, 9.423798932047621, 9.768597216561634, 9.970690344674658, 9.113594667194063, 9.986107986830564, 9.809912133422134, 9.715146546218412, 9.476482173842134, 9.979930256774225, 9.907162393227052, 9.863979122619721, 9.993641888020923, 9.810562742158803, 9.990156231750392, 9.915636780076987, 9.704665660432305, 9.92039290681243, 9.925012143391468], "episode_lengths": [129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126, 123, 19, 107, 8, 48, 127, 67, 139, 26, 96, 26, 92, 19, 85, 26, 62, 88, 138, 63, 139, 96, 94, 63, 82, 94, 95, 117, 43, 121, 68, 30, 68, 5, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18846271062918526, "mean_inference_ms": 0.5080687041564846, "mean_action_processing_ms": 0.1145458674605422, "mean_env_wait_ms": 0.08104504536350668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035326480865478516, "StateBufferConnector_ms": 0.0032503604888916016, "ViewRequirementAgentConnector_ms": 0.06531739234924316}}, "episode_reward_max": 9.999332056102453, "episode_reward_min": 8.066260009574666, "episode_reward_mean": 9.716571701095878, "episode_len_mean": 78.97, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.816374513077305, 8.066260009574666, 9.92687733729866, 8.773051918174621, 8.940712000838772, 8.407066016248976, 9.948804149782815, 9.652476061837906, 9.955636540833032, 9.875704370771905, 9.689778687928648, 9.451594969200727, 9.869301275179621, 9.88646094258836, 9.974587216029997, 8.795014106177048, 9.875729872762923, 9.882526862065319, 9.851135014495577, 9.577744632414964, 9.916976315250043, 9.85798564998967, 9.992744489749956, 9.566174840424118, 9.999332056102453, 9.950281897941258, 9.544455029794449, 9.98243974842654, 9.919690733598863, 9.727245384359485, 9.841911743317365, 9.39863358845673, 9.087591337395807, 9.97977751525562, 9.987623452642918, 9.998795396044292, 9.344249511186074, 9.563090197189988, 9.711433609734879, 9.593499715187262, 9.836918750543697, 9.751739769252286, 9.940996056793022, 9.686416809602191, 9.756944472554045, 9.77615649628159, 9.71630154414399, 9.994369967619363, 9.88132308507033, 9.989758970358805, 9.969030026961988, 9.86149408775307, 9.900563823433327, 9.880292590436216, 9.458172537916226, 9.324193570539515, 9.24361018016532, 9.347964961924333, 8.962965586020644, 9.976708310906835, 9.462178123090208, 9.926091818867068, 9.826890430677025, 9.890699784238212, 9.922615612470482, 9.907377777228314, 9.802082654869428, 9.983991456029099, 9.657080082467374, 9.99797605562105, 9.574946705717986, 9.777399677179778, 9.98729516907642, 9.224985158657294, 9.959865771468163, 9.67164462770573, 9.994343613557644, 9.975848196093803, 9.71533393715394, 9.709422118348801, 9.987893887089653, 9.98904701831853, 9.423798932047621, 9.768597216561634, 9.970690344674658, 9.113594667194063, 9.986107986830564, 9.809912133422134, 9.715146546218412, 9.476482173842134, 9.979930256774225, 9.907162393227052, 9.863979122619721, 9.993641888020923, 9.810562742158803, 9.990156231750392, 9.915636780076987, 9.704665660432305, 9.92039290681243, 9.925012143391468], "episode_lengths": [129, 127, 83, 115, 61, 136, 79, 63, 37, 139, 73, 137, 138, 12, 33, 108, 84, 50, 104, 134, 6, 113, 58, 134, 7, 134, 53, 36, 83, 32, 10, 134, 76, 56, 13, 7, 133, 62, 47, 33, 10, 93, 105, 97, 12, 64, 39, 39, 49, 46, 6, 104, 142, 129, 124, 127, 154, 74, 134, 94, 117, 47, 54, 132, 118, 126, 123, 19, 107, 8, 48, 127, 67, 139, 26, 96, 26, 92, 19, 85, 26, 62, 88, 138, 63, 139, 96, 94, 63, 82, 94, 95, 117, 43, 121, 68, 30, 68, 5, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18846271062918526, "mean_inference_ms": 0.5080687041564846, "mean_action_processing_ms": 0.1145458674605422, "mean_env_wait_ms": 0.08104504536350668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035326480865478516, "StateBufferConnector_ms": 0.0032503604888916016, "ViewRequirementAgentConnector_ms": 0.06531739234924316}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74844, "num_agent_steps_trained": 74844, "num_env_steps_sampled": 74844, "num_env_steps_trained": 74844, "num_env_steps_sampled_this_iter": 1296, "num_env_steps_trained_this_iter": 1296, "timesteps_total": 74844, "num_steps_trained_this_iter": 1296, "agent_timesteps_total": 74844, "timers": {"training_iteration_time_ms": 6000.769, "load_time_ms": 2.461, "load_throughput": 504735.592, "learn_time_ms": 5726.76, "learn_throughput": 216.877, "synch_weights_time_ms": 2.452}, "counters": {"num_env_steps_sampled": 74844, "num_env_steps_trained": 74844, "num_agent_steps_sampled": 74844, "num_agent_steps_trained": 74844}, "done": true, "episodes_total": 1048, "training_iteration": 61, "trial_id": "7ea15_00009", "experiment_id": "84876712b8644635bef2e924f17b5797", "date": "2023-03-15_23-05-22", "timestamp": 1678935922, "time_this_iter_s": 6.308816194534302, "time_total_s": 365.9409246444702, "pid": 16371, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ebc370>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.00023811142701077537, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.1903200898592476, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ebc5b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.6063115341335983, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0027969169452290287, "entropy_coeff_schedule": null, "clip_param": 0.21142796893211896, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff180054820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 365.9409246444702, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 8.161854982376099, "perf": {"cpu_util_percent": 16.3875, "ram_util_percent": 21.6625, "gpu_util_percent0": 0.74875, "vram_util_percent0": 0.03314208984375}}
