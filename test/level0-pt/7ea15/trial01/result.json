{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.705139452511612, "cur_lr": 0.0002839118933253797, "total_loss": 10.255772617271354, "policy_loss": 0.24957984512050946, "vf_loss": 10.0, "vf_explained_var": -0.0008104846284196183, "kl": 0.009873212442989252, "entropy": 2.736799617715784, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 1212, "num_env_steps_trained": 1212, "num_agent_steps_sampled": 1212, "num_agent_steps_trained": 1212}, "sampler_results": {"episode_reward_max": 9.978992647986246, "episode_reward_min": -43.81397219251661, "episode_reward_mean": -21.678555006720153, "episode_len_mean": 46.61538461538461, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20422115604629465, "mean_inference_ms": 0.5151996278897184, "mean_action_processing_ms": 0.11549561550188035, "mean_env_wait_ms": 0.08303099208997652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532262948843149, "StateBufferConnector_ms": 0.003742254697359525, "ViewRequirementAgentConnector_ms": 0.06599976466252254}}, "episode_reward_max": 9.978992647986246, "episode_reward_min": -43.81397219251661, "episode_reward_mean": -21.678555006720153, "episode_len_mean": 46.61538461538461, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20422115604629465, "mean_inference_ms": 0.5151996278897184, "mean_action_processing_ms": 0.11549561550188035, "mean_env_wait_ms": 0.08303099208997652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532262948843149, "StateBufferConnector_ms": 0.003742254697359525, "ViewRequirementAgentConnector_ms": 0.06599976466252254}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212, "num_agent_steps_trained": 1212, "num_env_steps_sampled": 1212, "num_env_steps_trained": 1212, "num_env_steps_sampled_this_iter": 1212, "num_env_steps_trained_this_iter": 1212, "timesteps_total": 1212, "num_steps_trained_this_iter": 1212, "agent_timesteps_total": 1212, "timers": {"training_iteration_time_ms": 5938.036, "load_time_ms": 0.919, "load_throughput": 1318334.141, "learn_time_ms": 5634.442, "learn_throughput": 215.106, "synch_weights_time_ms": 13.036}, "counters": {"num_env_steps_sampled": 1212, "num_env_steps_trained": 1212, "num_agent_steps_sampled": 1212, "num_agent_steps_trained": 1212}, "done": false, "episodes_total": 26, "training_iteration": 1, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-30-46", "timestamp": 1678933846, "time_this_iter_s": 5.943968772888184, "time_total_s": 5.943968772888184, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6a850>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6a8b0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 5.943968772888184, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 17.022222222222226, "ram_util_percent": 19.7, "gpu_util_percent0": 0.67, "vram_util_percent0": 0.032952202690972224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7051394525116118, "cur_lr": 0.0002839118933253797, "total_loss": 10.253414698101226, "policy_loss": 0.24323212583859763, "vf_loss": 10.0, "vf_explained_var": -0.00021701029368809293, "kl": 0.015465332096861122, "entropy": 2.571114737419855, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 2340, "num_env_steps_trained": 2340, "num_agent_steps_sampled": 2340, "num_agent_steps_trained": 2340}, "sampler_results": {"episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.752043883771414, "episode_len_mean": 42.54545454545455, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2037966794382055, "mean_inference_ms": 0.5137833720036326, "mean_action_processing_ms": 0.11543548050856589, "mean_env_wait_ms": 0.08325214505993897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.003943009810014205, "ViewRequirementAgentConnector_ms": 0.06531108509410512}}, "episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.752043883771414, "episode_len_mean": 42.54545454545455, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2037966794382055, "mean_inference_ms": 0.5137833720036326, "mean_action_processing_ms": 0.11543548050856589, "mean_env_wait_ms": 0.08325214505993897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036668777465820312, "StateBufferConnector_ms": 0.003943009810014205, "ViewRequirementAgentConnector_ms": 0.06531108509410512}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2340, "num_agent_steps_trained": 2340, "num_env_steps_sampled": 2340, "num_env_steps_trained": 2340, "num_env_steps_sampled_this_iter": 1128, "num_env_steps_trained_this_iter": 1128, "timesteps_total": 2340, "num_steps_trained_this_iter": 1128, "agent_timesteps_total": 2340, "timers": {"training_iteration_time_ms": 5751.312, "load_time_ms": 1.012, "load_throughput": 1156163.43, "learn_time_ms": 5478.672, "learn_throughput": 213.555, "synch_weights_time_ms": 7.605}, "counters": {"num_env_steps_sampled": 2340, "num_env_steps_trained": 2340, "num_agent_steps_sampled": 2340, "num_agent_steps_trained": 2340}, "done": false, "episodes_total": 55, "training_iteration": 2, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-30-52", "timestamp": 1678933852, "time_this_iter_s": 5.570692300796509, "time_total_s": 11.514661073684692, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dff970>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dff9d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fe8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 11.514661073684692, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 21.214285714285715, "ram_util_percent": 19.999999999999996, "gpu_util_percent0": 0.7828571428571428, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7051394525116118, "cur_lr": 0.00028391189332537973, "total_loss": 10.23369194859206, "policy_loss": 0.21703050153123007, "vf_loss": 10.0, "vf_explained_var": 0.0005701780319213867, "kl": 0.024596334424907152, "entropy": 2.428036633766059, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 3425, "num_env_steps_trained": 3425, "num_agent_steps_sampled": 3425, "num_agent_steps_trained": 3425}, "sampler_results": {"episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.491427240483954, "episode_len_mean": 43.91025641025641, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20085147329356934, "mean_inference_ms": 0.5080719584198498, "mean_action_processing_ms": 0.11433166018969305, "mean_env_wait_ms": 0.08225132559454139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003605928176488632, "StateBufferConnector_ms": 0.00362854737501878, "ViewRequirementAgentConnector_ms": 0.0632020143362192}}, "episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.491427240483954, "episode_len_mean": 43.91025641025641, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20085147329356934, "mean_inference_ms": 0.5080719584198498, "mean_action_processing_ms": 0.11433166018969305, "mean_env_wait_ms": 0.08225132559454139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003605928176488632, "StateBufferConnector_ms": 0.00362854737501878, "ViewRequirementAgentConnector_ms": 0.0632020143362192}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3425, "num_agent_steps_trained": 3425, "num_env_steps_sampled": 3425, "num_env_steps_trained": 3425, "num_env_steps_sampled_this_iter": 1085, "num_env_steps_trained_this_iter": 1085, "timesteps_total": 3425, "num_steps_trained_this_iter": 1085, "agent_timesteps_total": 3425, "timers": {"training_iteration_time_ms": 5599.972, "load_time_ms": 1.323, "load_throughput": 862740.448, "learn_time_ms": 5345.506, "learn_throughput": 213.575, "synch_weights_time_ms": 5.888}, "counters": {"num_env_steps_sampled": 3425, "num_env_steps_trained": 3425, "num_agent_steps_sampled": 3425, "num_agent_steps_trained": 3425}, "done": false, "episodes_total": 78, "training_iteration": 3, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-30-57", "timestamp": 1678933857, "time_this_iter_s": 5.303241968154907, "time_total_s": 16.8179030418396, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ed4d30>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed4b50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 16.8179030418396, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 18.228571428571428, "ram_util_percent": 20.25714285714286, "gpu_util_percent0": 0.6714285714285715, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0577091787674178, "cur_lr": 0.0002839118933253797, "total_loss": 10.224662435496295, "policy_loss": 0.2119401749085497, "vf_loss": 10.0, "vf_explained_var": 0.0003177109691831801, "kl": 0.012659629749950236, "entropy": 2.3764994700749713, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 3690.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 4603, "num_env_steps_trained": 4603, "num_agent_steps_sampled": 4603, "num_agent_steps_trained": 4603}, "sampler_results": {"episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.821341684274508, "episode_len_mean": 46.96938775510204, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024412957475696, "mean_inference_ms": 0.5074696382237117, "mean_action_processing_ms": 0.11434233383206804, "mean_env_wait_ms": 0.08216283404299721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036967043973961653, "StateBufferConnector_ms": 0.0037363597324916293, "ViewRequirementAgentConnector_ms": 0.06439320895136619}}, "episode_reward_max": 9.999835337373678, "episode_reward_min": -43.845102623667316, "episode_reward_mean": -21.821341684274508, "episode_len_mean": 46.96938775510204, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.1202531045711, -40.12247187912684, -43.81397219251661, -40.647154599629154, 9.978992647986246, 8.658526927380196, -41.23164067212605, -42.08974684440698, -40.68591576965833, 4.5689263666944, 8.620842603021543, 9.017770082333634, -40.25100887189267, -40.602410215372814, -40.19379838733793, -40.11507406432545, -40.89474462471847, 9.921197947254084, -40.390796394307394, -40.30843935399653, 9.825688830000365, 9.863611056013571, 9.209920024595533, -40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751], "episode_lengths": [26, 17, 53, 83, 4, 50, 83, 87, 61, 82, 41, 36, 22, 77, 35, 14, 46, 8, 28, 25, 12, 33, 157, 21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20024412957475696, "mean_inference_ms": 0.5074696382237117, "mean_action_processing_ms": 0.11434233383206804, "mean_env_wait_ms": 0.08216283404299721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036967043973961653, "StateBufferConnector_ms": 0.0037363597324916293, "ViewRequirementAgentConnector_ms": 0.06439320895136619}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4603, "num_agent_steps_trained": 4603, "num_env_steps_sampled": 4603, "num_env_steps_trained": 4603, "num_env_steps_sampled_this_iter": 1178, "num_env_steps_trained_this_iter": 1178, "timesteps_total": 4603, "num_steps_trained_this_iter": 1178, "agent_timesteps_total": 4603, "timers": {"training_iteration_time_ms": 5715.726, "load_time_ms": 1.332, "load_throughput": 864245.549, "learn_time_ms": 5447.38, "learn_throughput": 211.248, "synch_weights_time_ms": 4.974}, "counters": {"num_env_steps_sampled": 4603, "num_env_steps_trained": 4603, "num_agent_steps_sampled": 4603, "num_agent_steps_trained": 4603}, "done": false, "episodes_total": 98, "training_iteration": 4, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-03", "timestamp": 1678933863, "time_this_iter_s": 6.069391250610352, "time_total_s": 22.88729429244995, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769fa7910>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769fa7460>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 22.88729429244995, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 20.96666666666667, "ram_util_percent": 21.144444444444446, "gpu_util_percent0": 0.7533333333333333, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0577091787674178, "cur_lr": 0.0002839118933253797, "total_loss": 10.035420048542512, "policy_loss": -0.00284741988294145, "vf_loss": 10.0, "vf_explained_var": -0.00025634582226092997, "kl": 0.03680326201716461, "entropy": 2.3470879895310115, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 4815.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 5865, "num_env_steps_trained": 5865, "num_agent_steps_sampled": 5865, "num_agent_steps_trained": 5865}, "sampler_results": {"episode_reward_max": 9.999835337373678, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -22.688913720563235, "episode_len_mean": 47.85, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908], "episode_lengths": [21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19519753514359373, "mean_inference_ms": 0.4973608102980952, "mean_action_processing_ms": 0.11235035666288348, "mean_env_wait_ms": 0.08051955715927228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.0037658214569091797, "ViewRequirementAgentConnector_ms": 0.061681270599365234}}, "episode_reward_max": 9.999835337373678, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -22.688913720563235, "episode_len_mean": 47.85, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.2445882835086, -40.00638555518834, -40.83001205646251, 7.146053243809023, -40.2225101602593, -40.02107106832056, -40.18679115310851, 9.993562771751709, 9.979868469216063, -40.147900115501514, -40.088982724496546, -43.845102623667316, 4.853134857828988, 9.999835337373678, 9.84117716235454, -40.00147034428919, -40.143638920662866, 7.876417381779649, -40.085979057307185, 9.988375523807536, 9.792139576597034, -40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908], "episode_lengths": [21, 3, 108, 78, 41, 10, 25, 10, 9, 8, 26, 72, 111, 2, 8, 8, 16, 32, 6, 31, 26, 30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19519753514359373, "mean_inference_ms": 0.4973608102980952, "mean_action_processing_ms": 0.11235035666288348, "mean_env_wait_ms": 0.08051955715927228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036804676055908203, "StateBufferConnector_ms": 0.0037658214569091797, "ViewRequirementAgentConnector_ms": 0.061681270599365234}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5865, "num_agent_steps_trained": 5865, "num_env_steps_sampled": 5865, "num_env_steps_trained": 5865, "num_env_steps_sampled_this_iter": 1262, "num_env_steps_trained_this_iter": 1262, "timesteps_total": 5865, "num_steps_trained_this_iter": 1262, "agent_timesteps_total": 5865, "timers": {"training_iteration_time_ms": 5774.775, "load_time_ms": 1.225, "load_throughput": 957592.47, "learn_time_ms": 5510.545, "learn_throughput": 212.865, "synch_weights_time_ms": 4.463}, "counters": {"num_env_steps_sampled": 5865, "num_env_steps_trained": 5865, "num_agent_steps_sampled": 5865, "num_agent_steps_trained": 5865}, "done": false, "episodes_total": 123, "training_iteration": 5, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-09", "timestamp": 1678933869, "time_this_iter_s": 6.017223119735718, "time_total_s": 28.90451741218567, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dff730>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dff1f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fe8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 28.90451741218567, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.8625, "ram_util_percent": 21.7, "gpu_util_percent0": 0.7275, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5865637681511267, "cur_lr": 0.0002839118933253798, "total_loss": 10.13500840171935, "policy_loss": 0.12746516524089707, "vf_loss": 10.0, "vf_explained_var": 0.00031060689971560524, "kl": 0.005103342977452572, "entropy": 1.9693860645805086, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 6030.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 7213, "num_env_steps_trained": 7213, "num_agent_steps_sampled": 7213, "num_agent_steps_trained": 7213}, "sampler_results": {"episode_reward_max": 9.958678694089103, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -21.17721564298792, "episode_len_mean": 54.82, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682], "episode_lengths": [30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915572816063875, "mean_inference_ms": 0.4906318113253153, "mean_action_processing_ms": 0.11087693376106822, "mean_env_wait_ms": 0.07919302054894307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003656148910522461, "StateBufferConnector_ms": 0.0035042762756347656, "ViewRequirementAgentConnector_ms": 0.060095787048339844}}, "episode_reward_max": 9.958678694089103, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -21.17721564298792, "episode_len_mean": 54.82, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.45973539689233, -40.01521781374583, -41.172620534912994, -42.86172943821794, -40.0133200650237, -40.16894634687981, -40.33528589207141, -40.68773228857482, -40.11766669790748, 9.112357152389086, 9.272795732228541, 9.793047004135078, -41.47686090126713, -40.293324927417366, -40.63641802093331, 9.797216682732126, -40.49979579642624, 9.57164197075108, 9.657523703007282, -40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682], "episode_lengths": [30, 12, 78, 96, 44, 91, 26, 28, 19, 114, 71, 17, 101, 21, 46, 41, 90, 39, 46, 2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1915572816063875, "mean_inference_ms": 0.4906318113253153, "mean_action_processing_ms": 0.11087693376106822, "mean_env_wait_ms": 0.07919302054894307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003656148910522461, "StateBufferConnector_ms": 0.0035042762756347656, "ViewRequirementAgentConnector_ms": 0.060095787048339844}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7213, "num_agent_steps_trained": 7213, "num_env_steps_sampled": 7213, "num_env_steps_trained": 7213, "num_env_steps_sampled_this_iter": 1348, "num_env_steps_trained_this_iter": 1348, "timesteps_total": 7213, "num_steps_trained_this_iter": 1348, "agent_timesteps_total": 7213, "timers": {"training_iteration_time_ms": 5900.587, "load_time_ms": 1.461, "load_throughput": 822978.557, "learn_time_ms": 5635.618, "learn_throughput": 213.316, "synch_weights_time_ms": 4.151}, "counters": {"num_env_steps_sampled": 7213, "num_env_steps_trained": 7213, "num_agent_steps_sampled": 7213, "num_agent_steps_trained": 7213}, "done": false, "episodes_total": 144, "training_iteration": 6, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-16", "timestamp": 1678933876, "time_this_iter_s": 6.535836458206177, "time_total_s": 35.440353870391846, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ed4190>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed4bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 35.440353870391846, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.877777777777778, "ram_util_percent": 21.72222222222222, "gpu_util_percent0": 0.6888888888888888, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5865637681511264, "cur_lr": 0.0002839118933253797, "total_loss": 7.175441718724271, "policy_loss": 0.0662896186381847, "vf_loss": 7.103358002258717, "vf_explained_var": -0.3045550685745102, "kl": 0.003976372519192361, "entropy": 1.8312141891266849, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 7215.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 8397, "num_env_steps_trained": 8397, "num_agent_steps_sampled": 8397, "num_agent_steps_trained": 8397}, "sampler_results": {"episode_reward_max": 9.982080019164075, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -18.559693546488877, "episode_len_mean": 56.56, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428], "episode_lengths": [2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19037039342975046, "mean_inference_ms": 0.4890925991159723, "mean_action_processing_ms": 0.11063786516487699, "mean_env_wait_ms": 0.07886744403972348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003617525100708008, "StateBufferConnector_ms": 0.0036966800689697266, "ViewRequirementAgentConnector_ms": 0.06208014488220215}}, "episode_reward_max": 9.982080019164075, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -18.559693546488877, "episode_len_mean": 56.56, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.02403568256704, 9.725875594879154, -40.127297640272694, -41.37541368827259, -40.05338707218868, -40.202813217209204, 8.518908006616638, -40.05441633636445, -40.25878948636482, -40.4546424192735, -40.26301553874622, 9.744854942451957, 9.939553083563466, -40.705596131869875, 9.708274720715792, 7.000916750809033, -40.002764055741444, -42.136579515996374, -40.35755126648299, -40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428], "episode_lengths": [2, 30, 35, 136, 27, 37, 114, 11, 57, 20, 50, 10, 58, 46, 51, 142, 10, 66, 54, 8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.19037039342975046, "mean_inference_ms": 0.4890925991159723, "mean_action_processing_ms": 0.11063786516487699, "mean_env_wait_ms": 0.07886744403972348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003617525100708008, "StateBufferConnector_ms": 0.0036966800689697266, "ViewRequirementAgentConnector_ms": 0.06208014488220215}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8397, "num_agent_steps_trained": 8397, "num_env_steps_sampled": 8397, "num_env_steps_trained": 8397, "num_env_steps_sampled_this_iter": 1184, "num_env_steps_trained_this_iter": 1184, "timesteps_total": 8397, "num_steps_trained_this_iter": 1184, "agent_timesteps_total": 8397, "timers": {"training_iteration_time_ms": 5872.794, "load_time_ms": 1.593, "load_throughput": 752828.393, "learn_time_ms": 5604.803, "learn_throughput": 214.026, "synch_weights_time_ms": 5.604}, "counters": {"num_env_steps_sampled": 8397, "num_env_steps_trained": 8397, "num_agent_steps_sampled": 8397, "num_agent_steps_trained": 8397}, "done": false, "episodes_total": 163, "training_iteration": 7, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-22", "timestamp": 1678933882, "time_this_iter_s": 5.712700128555298, "time_total_s": 41.153053998947144, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6a3a0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6a5e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 41.153053998947144, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.1125, "ram_util_percent": 21.75, "gpu_util_percent0": 0.7662500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7932818840755633, "cur_lr": 0.00028391189332537973, "total_loss": 6.62550578357225, "policy_loss": 0.0540680919541046, "vf_loss": 6.560206307489425, "vf_explained_var": -0.4601246309777101, "kl": 0.014774545547655489, "entropy": 1.7397485143442948, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 8370.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 9696, "num_env_steps_trained": 9696, "num_agent_steps_sampled": 9696, "num_agent_steps_trained": 9696}, "sampler_results": {"episode_reward_max": 9.982080019164075, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -15.791866630209924, "episode_len_mean": 59.99, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751], "episode_lengths": [8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18790983548082443, "mean_inference_ms": 0.48405010432983275, "mean_action_processing_ms": 0.10953990098121072, "mean_env_wait_ms": 0.07793964091934505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003434419631958008, "StateBufferConnector_ms": 0.0036334991455078125, "ViewRequirementAgentConnector_ms": 0.06098365783691406}}, "episode_reward_max": 9.982080019164075, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -15.791866630209924, "episode_len_mean": 59.99, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.038024201772835, 9.845661500583624, -41.45732123566514, -40.061117585763256, -40.03073139649945, 9.892327865344022, -40.02442840848349, -40.139865492430914, -40.336153279027805, -40.13624353458967, -41.157272057567525, 9.915070686727306, -42.15167201473921, 9.762141410237446, 9.800859413032072, 9.652586116872751, -40.01940224409585, 9.887411074877798, -40.96774368819426, -40.892597487542005, -40.197569771343815, -40.09488917603757, -41.15688306332914, 9.889179693970204, -43.47449017146168, -42.14127870444758, -40.668973599818926, -40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751], "episode_lengths": [8, 24, 110, 45, 80, 49, 2, 72, 38, 104, 43, 126, 92, 11, 85, 17, 23, 22, 55, 73, 78, 10, 95, 19, 118, 83, 91, 62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18790983548082443, "mean_inference_ms": 0.48405010432983275, "mean_action_processing_ms": 0.10953990098121072, "mean_env_wait_ms": 0.07793964091934505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003434419631958008, "StateBufferConnector_ms": 0.0036334991455078125, "ViewRequirementAgentConnector_ms": 0.06098365783691406}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9696, "num_agent_steps_trained": 9696, "num_env_steps_sampled": 9696, "num_env_steps_trained": 9696, "num_env_steps_sampled_this_iter": 1299, "num_env_steps_trained_this_iter": 1299, "timesteps_total": 9696, "num_steps_trained_this_iter": 1299, "agent_timesteps_total": 9696, "timers": {"training_iteration_time_ms": 5934.419, "load_time_ms": 1.703, "load_throughput": 711650.362, "learn_time_ms": 5663.844, "learn_throughput": 213.989, "synch_weights_time_ms": 5.206}, "counters": {"num_env_steps_sampled": 9696, "num_env_steps_trained": 9696, "num_agent_steps_sampled": 9696, "num_agent_steps_trained": 9696}, "done": false, "episodes_total": 182, "training_iteration": 8, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-28", "timestamp": 1678933888, "time_this_iter_s": 6.372370719909668, "time_total_s": 47.52542471885681, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dfff70>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dff490>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 47.52542471885681, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 16.1, "ram_util_percent": 21.8, "gpu_util_percent0": 0.68125, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7932818840755634, "cur_lr": 0.0002839118933253797, "total_loss": 3.9572058795417986, "policy_loss": 0.09680833140881652, "vf_loss": 3.849381840757182, "vf_explained_var": -0.3533928919551719, "kl": 0.014491978057496734, "entropy": 1.7096928922539083, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 9555.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 10955, "num_env_steps_trained": 10955, "num_agent_steps_sampled": 10955, "num_agent_steps_trained": 10955}, "sampler_results": {"episode_reward_max": 9.990976713333234, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -12.274304304495693, "episode_len_mean": 56.85, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193], "episode_lengths": [62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18579895776628186, "mean_inference_ms": 0.48032608151903816, "mean_action_processing_ms": 0.10870567257776012, "mean_env_wait_ms": 0.07714890644265743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038480758666992188, "StateBufferConnector_ms": 0.003965854644775391, "ViewRequirementAgentConnector_ms": 0.06566619873046875}}, "episode_reward_max": 9.990976713333234, "episode_reward_min": -47.50364481304218, "episode_reward_mean": -12.274304304495693, "episode_len_mean": 56.85, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.49353298265659, 9.753819104298053, -40.5903543936633, -40.61555318994542, 9.890932386024566, 9.771768898990684, 9.820496428201276, 9.954803512878303, -41.2822602037349, -47.50364481304218, 9.958678694089103, -40.07557698511097, -41.236133621890865, 9.52246302599908, -40.06652330926304, -40.062871892660446, 9.449268444818253, 9.732532771657725, 8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193], "episode_lengths": [62, 9, 26, 29, 9, 46, 17, 4, 55, 124, 14, 46, 104, 50, 4, 16, 113, 112, 56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18579895776628186, "mean_inference_ms": 0.48032608151903816, "mean_action_processing_ms": 0.10870567257776012, "mean_env_wait_ms": 0.07714890644265743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038480758666992188, "StateBufferConnector_ms": 0.003965854644775391, "ViewRequirementAgentConnector_ms": 0.06566619873046875}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10955, "num_agent_steps_trained": 10955, "num_env_steps_sampled": 10955, "num_env_steps_trained": 10955, "num_env_steps_sampled_this_iter": 1259, "num_env_steps_trained_this_iter": 1259, "timesteps_total": 10955, "num_steps_trained_this_iter": 1259, "agent_timesteps_total": 10955, "timers": {"training_iteration_time_ms": 5945.627, "load_time_ms": 1.819, "load_throughput": 669326.579, "learn_time_ms": 5667.0, "learn_throughput": 214.791, "synch_weights_time_ms": 4.897}, "counters": {"num_env_steps_sampled": 10955, "num_env_steps_trained": 10955, "num_agent_steps_sampled": 10955, "num_agent_steps_trained": 10955}, "done": false, "episodes_total": 209, "training_iteration": 9, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-34", "timestamp": 1678933894, "time_this_iter_s": 6.041630983352661, "time_total_s": 53.56705570220947, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dcdd00>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dcd580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fe8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 53.56705570220947, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 17.575, "ram_util_percent": 21.5625, "gpu_util_percent0": 0.6950000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7932818840755634, "cur_lr": 0.0002839118933253797, "total_loss": 3.18738980676942, "policy_loss": 0.059425745229435785, "vf_loss": 3.115220820186182, "vf_explained_var": 0.1786681556294107, "kl": 0.016621878737557893, "entropy": 1.574750891302386, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 10725.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 12214, "num_env_steps_trained": 12214, "num_agent_steps_sampled": 12214, "num_agent_steps_trained": 12214}, "sampler_results": {"episode_reward_max": 9.990976713333234, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -11.31633247062397, "episode_len_mean": 61.04, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373], "episode_lengths": [56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18634163387018113, "mean_inference_ms": 0.48298329776483107, "mean_action_processing_ms": 0.10936418504905525, "mean_env_wait_ms": 0.07761631709100027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038008689880371094, "StateBufferConnector_ms": 0.003576040267944336, "ViewRequirementAgentConnector_ms": 0.06583404541015625}}, "episode_reward_max": 9.990976713333234, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -11.31633247062397, "episode_len_mean": 61.04, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.74416512991511, 9.86559734889751, -41.7457995839012, -42.1553179684371, 9.793124272002578, -40.00255734549366, 8.966823404477099, 9.531976812119446, -42.07192150713843, -40.849343560206506, -40.02516888996635, 9.940952263615074, 9.655828480034252, -41.47636303841122, 8.962718836313213, 8.98840130508771, 9.64041804581682, -40.48524578697486, 9.06020495832913, -40.458270406537835, 7.496071574943544, -40.197398369807644, -40.26057230877614, 9.982080019164075, -0.2331896523676793, -40.78432246853785, 9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373], "episode_lengths": [56, 11, 103, 140, 50, 6, 37, 130, 93, 26, 15, 7, 34, 93, 37, 148, 117, 61, 61, 38, 82, 10, 18, 22, 107, 36, 66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18634163387018113, "mean_inference_ms": 0.48298329776483107, "mean_action_processing_ms": 0.10936418504905525, "mean_env_wait_ms": 0.07761631709100027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038008689880371094, "StateBufferConnector_ms": 0.003576040267944336, "ViewRequirementAgentConnector_ms": 0.06583404541015625}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12214, "num_agent_steps_trained": 12214, "num_env_steps_sampled": 12214, "num_env_steps_trained": 12214, "num_env_steps_sampled_this_iter": 1259, "num_env_steps_trained_this_iter": 1259, "timesteps_total": 12214, "num_steps_trained_this_iter": 1259, "agent_timesteps_total": 12214, "timers": {"training_iteration_time_ms": 5952.001, "load_time_ms": 1.778, "load_throughput": 686976.735, "learn_time_ms": 5676.341, "learn_throughput": 215.174, "synch_weights_time_ms": 4.623}, "counters": {"num_env_steps_sampled": 12214, "num_env_steps_trained": 12214, "num_agent_steps_sampled": 12214, "num_agent_steps_trained": 12214}, "done": false, "episodes_total": 227, "training_iteration": 10, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-40", "timestamp": 1678933900, "time_this_iter_s": 6.015750169754028, "time_total_s": 59.5828058719635, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f7e730>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f7e610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 59.5828058719635, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.911111111111113, "ram_util_percent": 21.2, "gpu_util_percent0": 0.6788888888888889, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7932818840755633, "cur_lr": 0.0002839118933253797, "total_loss": 4.099730107576276, "policy_loss": 0.001969645669062932, "vf_loss": 4.07997770246584, "vf_explained_var": -0.08718497361297961, "kl": 0.022928902633616938, "entropy": 1.445568771812099, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 11850.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 13386, "num_env_steps_trained": 13386, "num_agent_steps_sampled": 13386, "num_agent_steps_trained": 13386}, "sampler_results": {"episode_reward_max": 9.999711550697489, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -10.68831343650138, "episode_len_mean": 57.38, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287], "episode_lengths": [66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18503497954855533, "mean_inference_ms": 0.48003250581570994, "mean_action_processing_ms": 0.10860998482346033, "mean_env_wait_ms": 0.07694829616349028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.003571033477783203, "ViewRequirementAgentConnector_ms": 0.06445765495300293}}, "episode_reward_max": 9.999711550697489, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -10.68831343650138, "episode_len_mean": 57.38, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.509938381743439, 5.219869012020154, -42.156193131025056, 9.603745558828113, -40.0, -8.736112060645436, 9.377428067136663, 9.532963627587533, 9.691886511913602, 4.055254247883428, 9.055918972122926, 7.422422158630612, 9.628465040176994, -4.317472965563079, 3.854870382203549, 8.851606542227385, -42.55148064179717, 8.848769669914802, 9.977174923875863, -40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287], "episode_lengths": [66, 148, 87, 85, 1, 112, 32, 60, 28, 130, 37, 121, 117, 192, 175, 86, 99, 44, 38, 43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18503497954855533, "mean_inference_ms": 0.48003250581570994, "mean_action_processing_ms": 0.10860998482346033, "mean_env_wait_ms": 0.07694829616349028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.003571033477783203, "ViewRequirementAgentConnector_ms": 0.06445765495300293}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13386, "num_agent_steps_trained": 13386, "num_env_steps_sampled": 13386, "num_env_steps_trained": 13386, "num_env_steps_sampled_this_iter": 1172, "num_env_steps_trained_this_iter": 1172, "timesteps_total": 13386, "num_steps_trained_this_iter": 1172, "agent_timesteps_total": 13386, "timers": {"training_iteration_time_ms": 5924.497, "load_time_ms": 1.873, "load_throughput": 650017.273, "learn_time_ms": 5656.668, "learn_throughput": 215.215, "synch_weights_time_ms": 3.557}, "counters": {"num_env_steps_sampled": 13386, "num_env_steps_trained": 13386, "num_agent_steps_sampled": 13386, "num_agent_steps_trained": 13386}, "done": false, "episodes_total": 253, "training_iteration": 11, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-46", "timestamp": 1678933906, "time_this_iter_s": 5.66984224319458, "time_total_s": 65.25264811515808, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6a940>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6a2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769d728b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 65.25264811515808, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.057142857142859, "ram_util_percent": 21.2, "gpu_util_percent0": 0.7385714285714285, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253797, "total_loss": 6.851575017492804, "policy_loss": 0.04613079661848368, "vf_loss": 6.7928888611601135, "vf_explained_var": -0.2511702532017672, "kl": 0.010927404271690967, "entropy": 1.5918400175041623, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 12930.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 14543, "num_env_steps_trained": 14543, "num_agent_steps_sampled": 14543, "num_agent_steps_trained": 14543}, "sampler_results": {"episode_reward_max": 9.999711550697489, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -15.343820610761622, "episode_len_mean": 52.37, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776], "episode_lengths": [43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18467218397390353, "mean_inference_ms": 0.4793218369717666, "mean_action_processing_ms": 0.1084571428169756, "mean_env_wait_ms": 0.07674213114797934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037584304809570312, "StateBufferConnector_ms": 0.0035247802734375, "ViewRequirementAgentConnector_ms": 0.06414914131164551}}, "episode_reward_max": 9.999711550697489, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -15.343820610761622, "episode_len_mean": 52.37, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.32771793284164, -40.04282124954318, -40.06785457489175, -40.97185091935411, 9.678005472649726, 8.69617866223221, -40.1019486564285, -40.18696297335522, 8.6822881102146, 9.277182655107751, -41.68442734034753, 9.788757914612077, 9.990976713333234, -40.34637927652477, 8.852714106872531, -40.24374942662337, -40.126169365139184, -40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776], "episode_lengths": [43, 28, 7, 58, 43, 37, 21, 12, 121, 20, 33, 78, 8, 17, 123, 32, 40, 16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18467218397390353, "mean_inference_ms": 0.4793218369717666, "mean_action_processing_ms": 0.1084571428169756, "mean_env_wait_ms": 0.07674213114797934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037584304809570312, "StateBufferConnector_ms": 0.0035247802734375, "ViewRequirementAgentConnector_ms": 0.06414914131164551}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14543, "num_agent_steps_trained": 14543, "num_env_steps_sampled": 14543, "num_env_steps_trained": 14543, "num_env_steps_sampled_this_iter": 1157, "num_env_steps_trained_this_iter": 1157, "timesteps_total": 14543, "num_steps_trained_this_iter": 1157, "agent_timesteps_total": 14543, "timers": {"training_iteration_time_ms": 5922.04, "load_time_ms": 2.034, "load_throughput": 599895.59, "learn_time_ms": 5655.046, "learn_throughput": 215.79, "synch_weights_time_ms": 3.579}, "counters": {"num_env_steps_sampled": 14543, "num_env_steps_trained": 14543, "num_agent_steps_sampled": 14543, "num_agent_steps_trained": 14543}, "done": false, "episodes_total": 272, "training_iteration": 12, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-51", "timestamp": 1678933911, "time_this_iter_s": 5.546500205993652, "time_total_s": 70.79914832115173, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ddbf10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ddbe50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fe8d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 70.79914832115173, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.8, "ram_util_percent": 21.2, "gpu_util_percent0": 0.6937500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 2.7912282709434644, "policy_loss": 0.06640088864062962, "vf_loss": 2.716297978517934, "vf_explained_var": 0.1089452177286148, "kl": 0.0074828051974212655, "entropy": 1.33261994267242, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 14040.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 15767, "num_env_steps_trained": 15767, "num_agent_steps_sampled": 15767, "num_agent_steps_trained": 15767}, "sampler_results": {"episode_reward_max": 9.999765198448749, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -13.36950303913962, "episode_len_mean": 57.4, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677], "episode_lengths": [16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18502671142791768, "mean_inference_ms": 0.4808766087864076, "mean_action_processing_ms": 0.10884530546994604, "mean_env_wait_ms": 0.07705858034189815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036673545837402344, "StateBufferConnector_ms": 0.0033524036407470703, "ViewRequirementAgentConnector_ms": 0.06256699562072754}}, "episode_reward_max": 9.999765198448749, "episode_reward_min": -44.014274228293374, "episode_reward_mean": -13.36950303913962, "episode_len_mean": 57.4, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.14226960890018, -40.24840151082236, -40.01575745559714, -40.693000399971986, -41.108710953287755, 8.656555472144715, -40.16146578035168, 8.47412503401313, 9.541545538931029, 9.981571548246748, 9.834436602662688, 9.333070353646299, -40.7395781087006, 9.49108261118621, 8.589383150611653, 9.781984402959207, 9.901156344304978, 9.959831535417662, -40.18722441442182, 8.774755532004193, -40.11307259849303, 9.972950665744927, 8.193506426385367, -40.02917130616196, 8.335292689582225, -41.31179757045216, -40.37111472081304, -44.014274228293374, 9.088151693546582, 9.196770332734705, 7.1706087938454, -40.01129617176191, -40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677], "episode_lengths": [16, 23, 2, 22, 45, 127, 54, 131, 79, 4, 10, 56, 40, 99, 40, 33, 45, 4, 37, 61, 57, 63, 114, 16, 55, 69, 38, 126, 26, 101, 150, 35, 32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18502671142791768, "mean_inference_ms": 0.4808766087864076, "mean_action_processing_ms": 0.10884530546994604, "mean_env_wait_ms": 0.07705858034189815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036673545837402344, "StateBufferConnector_ms": 0.0033524036407470703, "ViewRequirementAgentConnector_ms": 0.06256699562072754}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15767, "num_agent_steps_trained": 15767, "num_env_steps_sampled": 15767, "num_env_steps_trained": 15767, "num_env_steps_sampled_this_iter": 1224, "num_env_steps_trained_this_iter": 1224, "timesteps_total": 15767, "num_steps_trained_this_iter": 1224, "agent_timesteps_total": 15767, "timers": {"training_iteration_time_ms": 5979.015, "load_time_ms": 1.96, "load_throughput": 629658.326, "learn_time_ms": 5709.106, "learn_throughput": 216.181, "synch_weights_time_ms": 3.561}, "counters": {"num_env_steps_sampled": 15767, "num_env_steps_trained": 15767, "num_agent_steps_sampled": 15767, "num_agent_steps_trained": 15767}, "done": false, "episodes_total": 289, "training_iteration": 13, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-31-57", "timestamp": 1678933917, "time_this_iter_s": 5.873414516448975, "time_total_s": 76.67256283760071, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769de90d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769de9130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 76.67256283760071, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.862499999999999, "ram_util_percent": 21.2, "gpu_util_percent0": 0.7262500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253798, "total_loss": 3.94783048650053, "policy_loss": -0.023388377752730515, "vf_loss": 3.962955625217107, "vf_explained_var": -0.062228143942065356, "kl": 0.007230314927873853, "entropy": 1.2106842088990095, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 15225.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 17095, "num_env_steps_trained": 17095, "num_agent_steps_sampled": 17095, "num_agent_steps_trained": 17095}, "sampler_results": {"episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -11.48263542835439, "episode_len_mean": 52.9, "episode_media": {}, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124], "episode_lengths": [32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18296222087608446, "mean_inference_ms": 0.47618267849095547, "mean_action_processing_ms": 0.10771024429171756, "mean_env_wait_ms": 0.07619122722141744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003376007080078125, "StateBufferConnector_ms": 0.0035486221313476562, "ViewRequirementAgentConnector_ms": 0.0598146915435791}}, "episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -11.48263542835439, "episode_len_mean": 52.9, "episodes_this_iter": 32, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.136881026388295, 9.982374416973563, 8.273098065783707, 9.212485702964283, 8.756802666322034, 9.531061430642373, -40.00477598403412, 9.908059145717997, 9.999711550697489, -40.442256745288866, 9.673208760565718, -40.000715730060875, 9.928726666245888, -40.15808087374616, -40.026087453581056, 7.29408626461684, 9.77971658456119, 9.893345408918313, 3.945183722153385, 8.377381195228804, -40.310313977164775, -41.31227094002712, 9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124], "episode_lengths": [32, 42, 86, 43, 88, 118, 12, 50, 3, 72, 20, 5, 75, 21, 10, 155, 52, 20, 73, 91, 36, 73, 14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18296222087608446, "mean_inference_ms": 0.47618267849095547, "mean_action_processing_ms": 0.10771024429171756, "mean_env_wait_ms": 0.07619122722141744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003376007080078125, "StateBufferConnector_ms": 0.0035486221313476562, "ViewRequirementAgentConnector_ms": 0.0598146915435791}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17095, "num_agent_steps_trained": 17095, "num_env_steps_sampled": 17095, "num_env_steps_trained": 17095, "num_env_steps_sampled_this_iter": 1328, "num_env_steps_trained_this_iter": 1328, "timesteps_total": 17095, "num_steps_trained_this_iter": 1328, "agent_timesteps_total": 17095, "timers": {"training_iteration_time_ms": 5989.42, "load_time_ms": 2.091, "load_throughput": 597416.8, "learn_time_ms": 5723.961, "learn_throughput": 218.24, "synch_weights_time_ms": 3.555}, "counters": {"num_env_steps_sampled": 17095, "num_env_steps_trained": 17095, "num_agent_steps_sampled": 17095, "num_agent_steps_trained": 17095}, "done": false, "episodes_total": 321, "training_iteration": 14, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-03", "timestamp": 1678933923, "time_this_iter_s": 6.173413991928101, "time_total_s": 82.84597682952881, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dffd60>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6ac70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcfee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 82.84597682952881, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 16.200000000000003, "ram_util_percent": 21.2875, "gpu_util_percent0": 0.67375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253797, "total_loss": 4.251594893505375, "policy_loss": 0.019209843561762856, "vf_loss": 4.223786926520988, "vf_explained_var": -0.17804971541677203, "kl": 0.007526977074938362, "entropy": 1.2751459388789677, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 16365.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 18230, "num_env_steps_trained": 18230, "num_agent_steps_sampled": 18230, "num_agent_steps_trained": 18230}, "sampler_results": {"episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -11.54340214170823, "episode_len_mean": 52.48, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405], "episode_lengths": [14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18233672762942468, "mean_inference_ms": 0.4747694793890942, "mean_action_processing_ms": 0.1074352929916288, "mean_env_wait_ms": 0.07595821425457469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033130645751953125, "StateBufferConnector_ms": 0.0035560131072998047, "ViewRequirementAgentConnector_ms": 0.059798240661621094}}, "episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -11.54340214170823, "episode_len_mean": 52.48, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.824876791947963, -40.000832616354316, -40.57478633407107, 9.92859479409275, 9.535034608193541, -40.29663431983904, 8.785822436337522, 9.653975010181929, 9.471571440849658, -40.18774442972287, 8.220071751619624, -40.1014787095151, 9.355466847993355, -41.186799259670494, -40.32177625647279, -40.78622301730558, -43.133365633961354, -41.31961526075684, 9.731453996485925, -40.98148284722443, 9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405], "episode_lengths": [14, 2, 63, 6, 17, 51, 48, 66, 74, 63, 93, 24, 67, 75, 94, 75, 92, 53, 126, 42, 71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18233672762942468, "mean_inference_ms": 0.4747694793890942, "mean_action_processing_ms": 0.1074352929916288, "mean_env_wait_ms": 0.07595821425457469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033130645751953125, "StateBufferConnector_ms": 0.0035560131072998047, "ViewRequirementAgentConnector_ms": 0.059798240661621094}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18230, "num_agent_steps_trained": 18230, "num_env_steps_sampled": 18230, "num_env_steps_trained": 18230, "num_env_steps_sampled_this_iter": 1135, "num_env_steps_trained_this_iter": 1135, "timesteps_total": 18230, "num_steps_trained_this_iter": 1135, "agent_timesteps_total": 18230, "timers": {"training_iteration_time_ms": 5937.849, "load_time_ms": 2.281, "load_throughput": 542013.575, "learn_time_ms": 5674.381, "learn_throughput": 217.909, "synch_weights_time_ms": 3.596}, "counters": {"num_env_steps_sampled": 18230, "num_env_steps_trained": 18230, "num_agent_steps_sampled": 18230, "num_agent_steps_trained": 18230}, "done": false, "episodes_total": 343, "training_iteration": 15, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-09", "timestamp": 1678933929, "time_this_iter_s": 5.5014355182647705, "time_total_s": 88.34741234779358, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dcd460>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dcd4f0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 88.34741234779358, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.125, "ram_util_percent": 21.25, "gpu_util_percent0": 0.65625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.00028391189332537973, "total_loss": 4.067577459881432, "policy_loss": -0.028202894690136114, "vf_loss": 4.087513320864334, "vf_explained_var": -0.14472428475817045, "kl": 0.007237625329268373, "entropy": 1.2280197477340697, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 17490.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 19539, "num_env_steps_trained": 19539, "num_agent_steps_sampled": 19539, "num_agent_steps_trained": 19539}, "sampler_results": {"episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -9.837826027954714, "episode_len_mean": 54.12, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083], "episode_lengths": [71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1817523552584503, "mean_inference_ms": 0.4735931684950569, "mean_action_processing_ms": 0.10720335986937783, "mean_env_wait_ms": 0.07580690479109967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003410816192626953, "StateBufferConnector_ms": 0.0037746429443359375, "ViewRequirementAgentConnector_ms": 0.0608367919921875}}, "episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -9.837826027954714, "episode_len_mean": 54.12, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.510871680942007, -40.10851999461528, -40.0300012849443, -40.18846129331232, -40.170684147473764, -5.513716534569918, 9.99787650328681, -41.54072611256094, -40.114553556734776, 9.426065023722092, 9.599156957260734, -40.293038519905956, 9.477401559454252, -40.845322349373426, 9.999765198448749, 7.22251406996941, 9.782986178669235, -40.17108891779801, 8.231095681439903, -41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083], "episode_lengths": [71, 35, 25, 59, 14, 105, 8, 45, 54, 130, 103, 15, 93, 53, 2, 83, 95, 24, 145, 79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1817523552584503, "mean_inference_ms": 0.4735931684950569, "mean_action_processing_ms": 0.10720335986937783, "mean_env_wait_ms": 0.07580690479109967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003410816192626953, "StateBufferConnector_ms": 0.0037746429443359375, "ViewRequirementAgentConnector_ms": 0.0608367919921875}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19539, "num_agent_steps_trained": 19539, "num_env_steps_sampled": 19539, "num_env_steps_trained": 19539, "num_env_steps_sampled_this_iter": 1309, "num_env_steps_trained_this_iter": 1309, "timesteps_total": 19539, "num_steps_trained_this_iter": 1309, "agent_timesteps_total": 19539, "timers": {"training_iteration_time_ms": 5902.189, "load_time_ms": 2.143, "load_throughput": 575219.368, "learn_time_ms": 5639.651, "learn_throughput": 218.56, "synch_weights_time_ms": 3.584}, "counters": {"num_env_steps_sampled": 19539, "num_env_steps_trained": 19539, "num_agent_steps_sampled": 19539, "num_agent_steps_trained": 19539}, "done": false, "episodes_total": 363, "training_iteration": 16, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-15", "timestamp": 1678933935, "time_this_iter_s": 6.180011510848999, "time_total_s": 94.52742385864258, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769de9280>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769de9ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcfee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 94.52742385864258, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.912500000000001, "ram_util_percent": 21.2, "gpu_util_percent0": 0.71625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253798, "total_loss": 4.1570564715258245, "policy_loss": 0.011764397809193248, "vf_loss": 4.129816347821098, "vf_explained_var": -0.19668751694853343, "kl": 0.013281746796036767, "entropy": 1.1688350108762582, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 20894, "num_env_steps_trained": 20894, "num_agent_steps_sampled": 20894, "num_agent_steps_trained": 20894}, "sampler_results": {"episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -9.878302000020186, "episode_len_mean": 56.08, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934], "episode_lengths": [79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18128244777409616, "mean_inference_ms": 0.4727730837191476, "mean_action_processing_ms": 0.10699566715171137, "mean_env_wait_ms": 0.07567750923528051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.0038080215454101562, "ViewRequirementAgentConnector_ms": 0.061844825744628906}}, "episode_reward_max": 9.999898458252725, "episode_reward_min": -47.25454217732589, "episode_reward_mean": -9.878302000020186, "episode_len_mean": 56.08, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.005032585281235, -41.33176750360268, 9.164946153262525, -40.69607501059113, 9.891717140930904, 9.855268194824967, 9.989387810742677, -40.29417599147325, 9.988151867583417, 6.454552240227997, -40.0, -40.00032988562766, -47.25454217732589, 9.162678324652356, 9.530133234669368, 9.999898458252725, -40.00660468123605, 8.714900560734437, -41.1476811323217, -40.05634121745664, 9.673467029278935, 9.890920713796408, 9.885019842868731, 9.863159391196787, 3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934], "episode_lengths": [79, 50, 135, 90, 36, 72, 19, 13, 40, 92, 1, 4, 76, 58, 67, 2, 20, 39, 105, 8, 27, 22, 9, 20, 112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18128244777409616, "mean_inference_ms": 0.4727730837191476, "mean_action_processing_ms": 0.10699566715171137, "mean_env_wait_ms": 0.07567750923528051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034852027893066406, "StateBufferConnector_ms": 0.0038080215454101562, "ViewRequirementAgentConnector_ms": 0.061844825744628906}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20894, "num_agent_steps_trained": 20894, "num_env_steps_sampled": 20894, "num_env_steps_trained": 20894, "num_env_steps_sampled_this_iter": 1355, "num_env_steps_trained_this_iter": 1355, "timesteps_total": 20894, "num_steps_trained_this_iter": 1355, "agent_timesteps_total": 20894, "timers": {"training_iteration_time_ms": 5975.71, "load_time_ms": 2.133, "load_throughput": 585963.77, "learn_time_ms": 5714.696, "learn_throughput": 218.682, "synch_weights_time_ms": 2.38}, "counters": {"num_env_steps_sampled": 20894, "num_env_steps_trained": 20894, "num_agent_steps_sampled": 20894, "num_agent_steps_trained": 20894}, "done": false, "episodes_total": 382, "training_iteration": 17, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-22", "timestamp": 1678933942, "time_this_iter_s": 6.447641849517822, "time_total_s": 100.9750657081604, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769de9b50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769de9940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 100.9750657081604, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.644444444444446, "ram_util_percent": 21.2, "gpu_util_percent0": 0.6377777777777778, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133454, "cur_lr": 0.00028391189332537973, "total_loss": 5.669373402945848, "policy_loss": -0.015804606149292955, "vf_loss": 5.6773404184583045, "vf_explained_var": -0.4926421876507576, "kl": 0.006865985273150447, "entropy": 1.1825543618864482, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 21974, "num_env_steps_trained": 21974, "num_agent_steps_sampled": 21974, "num_agent_steps_trained": 21974}, "sampler_results": {"episode_reward_max": 9.999110485476724, "episode_reward_min": -42.633913894905525, "episode_reward_mean": -11.803494648856061, "episode_len_mean": 56.04, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139], "episode_lengths": [112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18121691029074882, "mean_inference_ms": 0.4725352461378785, "mean_action_processing_ms": 0.10692271575486512, "mean_env_wait_ms": 0.07556110643700498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.003826141357421875, "ViewRequirementAgentConnector_ms": 0.06449365615844727}}, "episode_reward_max": 9.999110485476724, "episode_reward_min": -42.633913894905525, "episode_reward_mean": -11.803494648856061, "episode_len_mean": 56.04, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.923031202194898, 7.543571104549885, 9.989901830931354, 9.9845581173325, 9.742951405317312, 9.986662909921137, 9.820344712556086, 9.869584586934165, -40.13875492307055, 9.414495298629816, -40.89128528632419, -40.17108789735167, 9.888506427310313, 0.949727383874766, 9.500991527836124, -40.00382109832628, -40.24231060873364, -40.034096201731984, 9.969124935195532, -40.742833031606416, 9.804286272908243, 9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139], "episode_lengths": [112, 135, 6, 5, 73, 10, 59, 19, 55, 28, 33, 14, 43, 79, 54, 7, 16, 29, 34, 42, 87, 57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18121691029074882, "mean_inference_ms": 0.4725352461378785, "mean_action_processing_ms": 0.10692271575486512, "mean_env_wait_ms": 0.07556110643700498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003662109375, "StateBufferConnector_ms": 0.003826141357421875, "ViewRequirementAgentConnector_ms": 0.06449365615844727}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21974, "num_agent_steps_trained": 21974, "num_env_steps_sampled": 21974, "num_env_steps_trained": 21974, "num_env_steps_sampled_this_iter": 1080, "num_env_steps_trained_this_iter": 1080, "timesteps_total": 21974, "num_steps_trained_this_iter": 1080, "agent_timesteps_total": 21974, "timers": {"training_iteration_time_ms": 5851.243, "load_time_ms": 2.166, "load_throughput": 566898.917, "learn_time_ms": 5595.139, "learn_throughput": 219.44, "synch_weights_time_ms": 2.36}, "counters": {"num_env_steps_sampled": 21974, "num_env_steps_trained": 21974, "num_agent_steps_sampled": 21974, "num_agent_steps_trained": 21974}, "done": false, "episodes_total": 406, "training_iteration": 18, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-27", "timestamp": 1678933947, "time_this_iter_s": 5.127584457397461, "time_total_s": 106.10265016555786, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dc5520>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dc50d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 106.10265016555786, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 16.071428571428573, "ram_util_percent": 21.2, "gpu_util_percent0": 0.6200000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253797, "total_loss": 5.30904104136517, "policy_loss": -0.004529993456822854, "vf_loss": 5.295279898281809, "vf_explained_var": -0.22378323354102947, "kl": 0.015639410398095327, "entropy": 1.1333449983210475, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 20880.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 23150, "num_env_steps_trained": 23150, "num_agent_steps_sampled": 23150, "num_agent_steps_trained": 23150}, "sampler_results": {"episode_reward_max": 9.999110485476724, "episode_reward_min": -42.91518257096248, "episode_reward_mean": -14.26210790592961, "episode_len_mean": 58.4, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323], "episode_lengths": [57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18128169318793053, "mean_inference_ms": 0.47322991900509154, "mean_action_processing_ms": 0.10718014345357511, "mean_env_wait_ms": 0.07577014828217392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036864280700683594, "StateBufferConnector_ms": 0.0038661956787109375, "ViewRequirementAgentConnector_ms": 0.06436300277709961}}, "episode_reward_max": 9.999110485476724, "episode_reward_min": -42.91518257096248, "episode_reward_mean": -14.26210790592961, "episode_len_mean": 58.4, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.547695434821831, 9.8964271667965, 9.794733650166064, 9.992941615935546, -40.36094244852975, 0.9677646574461285, 6.205400101429855, 9.755532513138057, -40.11045176959424, -40.25075729832312, -41.966133545981144, 9.998119601537958, 8.762797961714224, 6.047609829253872, 9.284641840114524, 9.771457938084405, -40.063878501545, -40.0720843319599, 9.96494200250916, 9.940345084739858, 9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323], "episode_lengths": [57, 20, 86, 2, 42, 121, 53, 28, 43, 45, 53, 10, 133, 112, 51, 64, 6, 5, 37, 4, 110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18128169318793053, "mean_inference_ms": 0.47322991900509154, "mean_action_processing_ms": 0.10718014345357511, "mean_env_wait_ms": 0.07577014828217392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036864280700683594, "StateBufferConnector_ms": 0.0038661956787109375, "ViewRequirementAgentConnector_ms": 0.06436300277709961}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23150, "num_agent_steps_trained": 23150, "num_env_steps_sampled": 23150, "num_env_steps_trained": 23150, "num_env_steps_sampled_this_iter": 1176, "num_env_steps_trained_this_iter": 1176, "timesteps_total": 23150, "num_steps_trained_this_iter": 1176, "agent_timesteps_total": 23150, "timers": {"training_iteration_time_ms": 5806.654, "load_time_ms": 2.152, "load_throughput": 566697.363, "learn_time_ms": 5560.262, "learn_throughput": 219.324, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 23150, "num_env_steps_trained": 23150, "num_agent_steps_sampled": 23150, "num_agent_steps_trained": 23150}, "done": false, "episodes_total": 427, "training_iteration": 19, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-32", "timestamp": 1678933952, "time_this_iter_s": 5.596343755722046, "time_total_s": 111.69899392127991, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d87fd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d87f10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcfee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 111.69899392127991, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.9875, "ram_util_percent": 21.275, "gpu_util_percent0": 0.65625, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.945299249504561, "episode_reward_min": -41.801405345242, "episode_reward_mean": -18.12374934988846, "episode_len_mean": 40.333333333333336, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.711471128623492, 9.945299249504561, -40.39083675703883, 0.041211449890658614, 7.052166052266539, -40.00068416804407, -41.00355012426221, -40.15369346371749, -40.017800436548384, -41.801405345242, -41.055106386446624, 9.87952170791895, 9.29905723269449, -40.5599733780278, 7.198082990101771], "episode_lengths": [29, 5, 30, 76, 104, 5, 71, 26, 3, 87, 45, 7, 32, 31, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15350941287557746, "mean_inference_ms": 0.41919916033577453, "mean_action_processing_ms": 0.09444459106726065, "mean_env_wait_ms": 0.06883212523424097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003631114959716797, "StateBufferConnector_ms": 0.008120536804199219, "ViewRequirementAgentConnector_ms": 0.07320801417032878}, "num_agent_steps_sampled_this_iter": 605, "num_env_steps_sampled_this_iter": 605, "timesteps_this_iter": 605, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 4.755232949574527, "policy_loss": -0.04212483006872629, "vf_loss": 4.781560403515336, "vf_explained_var": 0.12866625268208354, "kl": 0.0135191578595065, "entropy": 1.0295470869593453, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 21990.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 24366, "num_env_steps_trained": 24366, "num_agent_steps_sampled": 24366, "num_agent_steps_trained": 24366}, "sampler_results": {"episode_reward_max": 9.999110485476724, "episode_reward_min": -42.91518257096248, "episode_reward_mean": -14.880246689572608, "episode_len_mean": 60.84, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707], "episode_lengths": [110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18120731079219168, "mean_inference_ms": 0.4735752423297376, "mean_action_processing_ms": 0.107245624167215, "mean_env_wait_ms": 0.07583807074615122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.003628253936767578, "ViewRequirementAgentConnector_ms": 0.06379580497741699}}, "episode_reward_max": 9.999110485476724, "episode_reward_min": -42.91518257096248, "episode_reward_mean": -14.880246689572608, "episode_len_mean": 60.84, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.651123313671915, 8.576200711445315, -40.67627598872845, 7.702931962449869, 7.493547117557306, 9.825948605594117, -41.839833533135234, 9.916724319601592, -40.345709533330485, -4.455925940522981, 9.737646205499894, 6.33820311082177, 9.999110485476724, -40.175764102728124, -5.0682437928465145, -40.27526682641083, 9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707], "episode_lengths": [110, 123, 24, 114, 149, 52, 113, 16, 26, 70, 70, 123, 4, 109, 83, 71, 9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18120731079219168, "mean_inference_ms": 0.4735752423297376, "mean_action_processing_ms": 0.107245624167215, "mean_env_wait_ms": 0.07583807074615122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733396530151367, "StateBufferConnector_ms": 0.003628253936767578, "ViewRequirementAgentConnector_ms": 0.06379580497741699}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24366, "num_agent_steps_trained": 24366, "num_env_steps_sampled": 24366, "num_env_steps_trained": 24366, "num_env_steps_sampled_this_iter": 1216, "num_env_steps_trained_this_iter": 1216, "timesteps_total": 24366, "num_steps_trained_this_iter": 1216, "agent_timesteps_total": 24366, "timers": {"training_iteration_time_ms": 5787.926, "load_time_ms": 2.199, "load_throughput": 552607.305, "learn_time_ms": 5542.361, "learn_throughput": 219.257, "synch_weights_time_ms": 2.362}, "counters": {"num_env_steps_sampled": 24366, "num_env_steps_trained": 24366, "num_agent_steps_sampled": 24366, "num_agent_steps_trained": 24366}, "done": false, "episodes_total": 447, "training_iteration": 20, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-39", "timestamp": 1678933959, "time_this_iter_s": 6.191558361053467, "time_total_s": 117.89055228233337, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6e0a0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6e100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 117.89055228233337, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.912500000000001, "ram_util_percent": 21.25, "gpu_util_percent0": 0.775, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 3.9034305439016217, "policy_loss": -0.03138552723277328, "vf_loss": 3.9239927903567957, "vf_explained_var": 0.08955997040129116, "kl": 0.009335997120119555, "entropy": 1.01698256320933, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 23145.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 25626, "num_env_steps_trained": 25626, "num_agent_steps_sampled": 25626, "num_agent_steps_trained": 25626}, "sampler_results": {"episode_reward_max": 9.996094073036078, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -14.643370186377128, "episode_len_mean": 60.87, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474], "episode_lengths": [9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18108482646816806, "mean_inference_ms": 0.47374819229367093, "mean_action_processing_ms": 0.10729439409875952, "mean_env_wait_ms": 0.07582621783975597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003621816635131836, "StateBufferConnector_ms": 0.0035200119018554688, "ViewRequirementAgentConnector_ms": 0.06274938583374023}}, "episode_reward_max": 9.996094073036078, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -14.643370186377128, "episode_len_mean": 60.87, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.985680839488085, 7.977432145835322, -41.399941082346544, -41.69020753324382, 8.94955272914029, -40.13280372078881, 8.260882240344095, -40.221867517344826, 3.0104079030327533, -40.008027631416105, -40.849689080697495, 9.023513424543136, 6.580236383125385, -40.188498062948874, -40.00662786742217, 9.048334039744853, 9.913863464052412, -42.633913894905525, 4.605696157164934, -40.00664253980352, 9.498878429233816, 9.945414843981517, 9.60837425239209, -40.36625150376625, 9.891993062445204, -40.002802784012175, -40.015580077648, -40.449658466534906, -40.16144341926115, 9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474], "episode_lengths": [9, 119, 125, 74, 72, 52, 122, 10, 52, 9, 33, 124, 127, 42, 29, 114, 38, 75, 129, 33, 50, 58, 18, 18, 30, 6, 2, 67, 10, 118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18108482646816806, "mean_inference_ms": 0.47374819229367093, "mean_action_processing_ms": 0.10729439409875952, "mean_env_wait_ms": 0.07582621783975597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003621816635131836, "StateBufferConnector_ms": 0.0035200119018554688, "ViewRequirementAgentConnector_ms": 0.06274938583374023}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25626, "num_agent_steps_trained": 25626, "num_env_steps_sampled": 25626, "num_env_steps_trained": 25626, "num_env_steps_sampled_this_iter": 1260, "num_env_steps_trained_this_iter": 1260, "timesteps_total": 25626, "num_steps_trained_this_iter": 1260, "agent_timesteps_total": 25626, "timers": {"training_iteration_time_ms": 5816.646, "load_time_ms": 2.28, "load_throughput": 536775.485, "learn_time_ms": 5567.924, "learn_throughput": 219.831, "synch_weights_time_ms": 2.349}, "counters": {"num_env_steps_sampled": 25626, "num_env_steps_trained": 25626, "num_agent_steps_sampled": 25626, "num_agent_steps_trained": 25626}, "done": false, "episodes_total": 463, "training_iteration": 21, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-45", "timestamp": 1678933965, "time_this_iter_s": 5.95674467086792, "time_total_s": 123.8472969532013, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dff400>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769dffbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 123.8472969532013, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.024999999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.67625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.00028391189332537973, "total_loss": 4.72989493364165, "policy_loss": -0.0109042328273401, "vf_loss": 4.7269175003192485, "vf_explained_var": -0.010414231239363204, "kl": 0.011884995312505801, "entropy": 0.9270056721776031, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 24375.5, "diff_num_grad_updates_vs_sampler_policy": 644.5}}, "num_env_steps_sampled": 27008, "num_env_steps_trained": 27008, "num_agent_steps_sampled": 27008, "num_agent_steps_trained": 27008}, "sampler_results": {"episode_reward_max": 9.99961421681211, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -12.874436901355246, "episode_len_mean": 58.22, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885], "episode_lengths": [118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18113069107185786, "mean_inference_ms": 0.4734981314168465, "mean_action_processing_ms": 0.10712802577896398, "mean_env_wait_ms": 0.07590588477527578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033783912658691406, "StateBufferConnector_ms": 0.0037789344787597656, "ViewRequirementAgentConnector_ms": 0.06119728088378906}}, "episode_reward_max": 9.99961421681211, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -12.874436901355246, "episode_len_mean": 58.22, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.133130429761003, 9.627112971854036, 9.604746314106752, -40.35087937454205, -40.13988784701915, -40.79316071499472, -40.08137724394658, -40.21426070070628, 9.874690316801093, -40.1378871321631, -40.29009311191548, -41.49042826560606, 9.91322741550032, 5.155171040362139, 9.89325000611833, -40.18283740170908, 9.747121112886342, 9.485471514168538, -40.2882852167647, 9.009179181703686, -40.60246284709565, 8.840219863532202, -41.876131059376476, -41.09136286189654, 9.152096307937235, -42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885], "episode_lengths": [118, 57, 69, 76, 62, 60, 39, 30, 13, 13, 31, 108, 18, 94, 14, 10, 36, 76, 27, 82, 78, 92, 73, 119, 111, 103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18113069107185786, "mean_inference_ms": 0.4734981314168465, "mean_action_processing_ms": 0.10712802577896398, "mean_env_wait_ms": 0.07590588477527578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033783912658691406, "StateBufferConnector_ms": 0.0037789344787597656, "ViewRequirementAgentConnector_ms": 0.06119728088378906}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27008, "num_agent_steps_trained": 27008, "num_env_steps_sampled": 27008, "num_env_steps_trained": 27008, "num_env_steps_sampled_this_iter": 1382, "num_env_steps_trained_this_iter": 1382, "timesteps_total": 27008, "num_steps_trained_this_iter": 1382, "agent_timesteps_total": 27008, "timers": {"training_iteration_time_ms": 5930.495, "load_time_ms": 2.292, "load_throughput": 543805.446, "learn_time_ms": 5678.51, "learn_throughput": 219.512, "synch_weights_time_ms": 2.326}, "counters": {"num_env_steps_sampled": 27008, "num_env_steps_trained": 27008, "num_agent_steps_sampled": 27008, "num_agent_steps_trained": 27008}, "done": false, "episodes_total": 492, "training_iteration": 22, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-51", "timestamp": 1678933971, "time_this_iter_s": 6.685009002685547, "time_total_s": 130.53230595588684, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e790a0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e79100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 130.53230595588684, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.933333333333334, "ram_util_percent": 21.3, "gpu_util_percent0": 0.6911111111111112, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253798, "total_loss": 4.300075945788919, "policy_loss": -0.045694365370564344, "vf_loss": 4.336628532703356, "vf_explained_var": -0.07080842188703336, "kl": 0.007908582843686807, "entropy": 0.956454441024036, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 25635.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 28334, "num_env_steps_trained": 28334, "num_agent_steps_sampled": 28334, "num_agent_steps_trained": 28334}, "sampler_results": {"episode_reward_max": 9.99961421681211, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -12.013088487254022, "episode_len_mean": 56.42, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512], "episode_lengths": [103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18062408749595893, "mean_inference_ms": 0.472334551047624, "mean_action_processing_ms": 0.10680547386732389, "mean_env_wait_ms": 0.07571520833684053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003225088119506836, "StateBufferConnector_ms": 0.004118204116821289, "ViewRequirementAgentConnector_ms": 0.059689998626708984}}, "episode_reward_max": 9.99961421681211, "episode_reward_min": -43.992981671352105, "episode_reward_mean": -12.013088487254022, "episode_len_mean": 56.42, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.91518257096248, 9.289063774633942, -40.33775187886018, -40.19774571139705, -40.07240202836431, -40.76793139384915, -40.0, -40.000307276083355, 9.91070029550646, 5.307521150864323, 1.2003379003737003, 9.612451184922044, -40.00695168216, -40.193988730468135, -40.002361736516086, -2.979236437984122, 9.991307357845356, -40.566224557952964, 9.909826843060555, 9.611548205877616, 9.967628308874083, -42.06274208801733, 4.671379437966847, -40.666815219339966, -40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512], "episode_lengths": [103, 135, 33, 39, 34, 23, 1, 2, 5, 83, 57, 68, 29, 98, 13, 81, 14, 76, 56, 73, 53, 65, 113, 59, 11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18062408749595893, "mean_inference_ms": 0.472334551047624, "mean_action_processing_ms": 0.10680547386732389, "mean_env_wait_ms": 0.07571520833684053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003225088119506836, "StateBufferConnector_ms": 0.004118204116821289, "ViewRequirementAgentConnector_ms": 0.059689998626708984}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28334, "num_agent_steps_trained": 28334, "num_env_steps_sampled": 28334, "num_env_steps_trained": 28334, "num_env_steps_sampled_this_iter": 1326, "num_env_steps_trained_this_iter": 1326, "timesteps_total": 28334, "num_steps_trained_this_iter": 1326, "agent_timesteps_total": 28334, "timers": {"training_iteration_time_ms": 5944.367, "load_time_ms": 2.26, "load_throughput": 556110.467, "learn_time_ms": 5691.919, "learn_throughput": 220.787, "synch_weights_time_ms": 2.328}, "counters": {"num_env_steps_sampled": 28334, "num_env_steps_trained": 28334, "num_agent_steps_sampled": 28334, "num_agent_steps_trained": 28334}, "done": false, "episodes_total": 517, "training_iteration": 23, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-32-57", "timestamp": 1678933977, "time_this_iter_s": 6.011950492858887, "time_total_s": 136.54425644874573, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e79610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e796a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 136.54425644874573, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.866666666666667, "ram_util_percent": 21.3, "gpu_util_percent0": 0.68, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253797, "total_loss": 5.855460984581926, "policy_loss": -0.0709797878421981, "vf_loss": 5.919144225236528, "vf_explained_var": -0.0645297548837132, "kl": 0.006330595299975077, "entropy": 0.8409762515238037, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 26790.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 29487, "num_env_steps_trained": 29487, "num_agent_steps_sampled": 29487, "num_agent_steps_trained": 29487}, "sampler_results": {"episode_reward_max": 9.99961421681211, "episode_reward_min": -45.804274950721386, "episode_reward_mean": -10.838737508666973, "episode_len_mean": 54.82, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973], "episode_lengths": [11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1804378320213434, "mean_inference_ms": 0.4725634218541633, "mean_action_processing_ms": 0.10682168246272092, "mean_env_wait_ms": 0.07570983295309147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003245830535888672, "StateBufferConnector_ms": 0.004063844680786133, "ViewRequirementAgentConnector_ms": 0.06023573875427246}}, "episode_reward_max": 9.99961421681211, "episode_reward_min": -45.804274950721386, "episode_reward_mean": -10.838737508666973, "episode_len_mean": 54.82, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.05867376948111, 9.964504111785136, 8.554886670923272, 9.08662303072927, 9.94440462080656, 9.314379686210707, 9.714942981732488, 9.176374008746494, -40.480582558832445, 9.996094073036078, -40.04599716113266, 9.41556584507559, -43.992981671352105, 9.792435014117533, -40.12906979189353, 8.153014881154391, 7.4569436734693735, 9.720680464456926, 8.704765246543584, -40.1281076507385, 9.69125533630952, 3.0467337432711474, -40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973], "episode_lengths": [11, 51, 87, 129, 4, 79, 93, 86, 64, 18, 53, 78, 98, 92, 106, 117, 96, 64, 54, 28, 82, 131, 40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1804378320213434, "mean_inference_ms": 0.4725634218541633, "mean_action_processing_ms": 0.10682168246272092, "mean_env_wait_ms": 0.07570983295309147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003245830535888672, "StateBufferConnector_ms": 0.004063844680786133, "ViewRequirementAgentConnector_ms": 0.06023573875427246}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29487, "num_agent_steps_trained": 29487, "num_env_steps_sampled": 29487, "num_env_steps_trained": 29487, "num_env_steps_sampled_this_iter": 1153, "num_env_steps_trained_this_iter": 1153, "timesteps_total": 29487, "num_steps_trained_this_iter": 1153, "agent_timesteps_total": 29487, "timers": {"training_iteration_time_ms": 5884.694, "load_time_ms": 2.084, "load_throughput": 594539.306, "learn_time_ms": 5635.01, "learn_throughput": 219.911, "synch_weights_time_ms": 2.362}, "counters": {"num_env_steps_sampled": 29487, "num_env_steps_trained": 29487, "num_agent_steps_sampled": 29487, "num_agent_steps_trained": 29487}, "done": false, "episodes_total": 541, "training_iteration": 24, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-03", "timestamp": 1678933983, "time_this_iter_s": 5.576343297958374, "time_total_s": 142.1205997467041, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e7ee20>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e7ee80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcfee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 142.1205997467041, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 16.485714285714284, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7842857142857144, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 3.7680337870262797, "policy_loss": -0.026455003076845462, "vf_loss": 3.7865559408260796, "vf_explained_var": -0.004398687734260215, "kl": 0.006875610892143219, "entropy": 0.8845084105794494, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 27885.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 30697, "num_env_steps_trained": 30697, "num_agent_steps_sampled": 30697, "num_agent_steps_trained": 30697}, "sampler_results": {"episode_reward_max": 9.99961421681211, "episode_reward_min": -45.804274950721386, "episode_reward_mean": -12.326775427529608, "episode_len_mean": 50.71, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681], "episode_lengths": [40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18031178104463397, "mean_inference_ms": 0.4722364761745399, "mean_action_processing_ms": 0.10669991812047114, "mean_env_wait_ms": 0.07565936718089758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032813549041748047, "StateBufferConnector_ms": 0.00443720817565918, "ViewRequirementAgentConnector_ms": 0.062169790267944336}}, "episode_reward_max": 9.99961421681211, "episode_reward_min": -45.804274950721386, "episode_reward_mean": -12.326775427529608, "episode_len_mean": 50.71, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.30160851203172, -40.11669322078343, -6.256574609136006, -1.7864515146148552, 9.9979672230636, 7.732188067854233, 9.741714800438007, -40.4265451268099, -40.05532787692216, 9.342224858516442, 9.901523551222123, 9.991165950061408, -40.000310388261326, -40.02463658544986, -40.02194214864854, 9.705512229086155, -41.95510774719103, 9.648367375576168, 6.057333479432722, 8.619675307038744, -40.013411016115604, 9.976834746853589, -3.3143630902494134, -40.05339295870386, 9.961150229926341, 9.908696375191088, 9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681], "episode_lengths": [40, 12, 106, 107, 7, 133, 126, 70, 8, 50, 5, 3, 2, 6, 6, 42, 98, 113, 46, 147, 2, 30, 71, 30, 12, 13, 25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18031178104463397, "mean_inference_ms": 0.4722364761745399, "mean_action_processing_ms": 0.10669991812047114, "mean_env_wait_ms": 0.07565936718089758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032813549041748047, "StateBufferConnector_ms": 0.00443720817565918, "ViewRequirementAgentConnector_ms": 0.062169790267944336}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30697, "num_agent_steps_trained": 30697, "num_env_steps_sampled": 30697, "num_env_steps_trained": 30697, "num_env_steps_sampled_this_iter": 1210, "num_env_steps_trained_this_iter": 1210, "timesteps_total": 30697, "num_steps_trained_this_iter": 1210, "agent_timesteps_total": 30697, "timers": {"training_iteration_time_ms": 5905.009, "load_time_ms": 1.942, "load_throughput": 642056.776, "learn_time_ms": 5654.681, "learn_throughput": 220.472, "synch_weights_time_ms": 2.325}, "counters": {"num_env_steps_sampled": 30697, "num_env_steps_trained": 30697, "num_agent_steps_sampled": 30697, "num_agent_steps_trained": 30697}, "done": false, "episodes_total": 563, "training_iteration": 25, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-09", "timestamp": 1678933989, "time_this_iter_s": 5.704686403274536, "time_total_s": 147.82528614997864, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e79d60>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e79490>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769cad8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 147.82528614997864, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.925, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7275, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.0002839118933253798, "total_loss": 4.236491215662137, "policy_loss": -0.03934087298992203, "vf_loss": 4.263513433397937, "vf_explained_var": -0.07087588286012168, "kl": 0.010566174021735843, "entropy": 0.9046753030724641, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 29055.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 32009, "num_env_steps_trained": 32009, "num_agent_steps_sampled": 32009, "num_agent_steps_trained": 32009}, "sampler_results": {"episode_reward_max": 9.99961421681211, "episode_reward_min": -46.17527321329547, "episode_reward_mean": -13.09067221057397, "episode_len_mean": 50.98, "episode_media": {}, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386], "episode_lengths": [25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18021003028207713, "mean_inference_ms": 0.4723270955964004, "mean_action_processing_ms": 0.10678152339599344, "mean_env_wait_ms": 0.07548220509930786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003442525863647461, "StateBufferConnector_ms": 0.004005908966064453, "ViewRequirementAgentConnector_ms": 0.0640404224395752}}, "episode_reward_max": 9.99961421681211, "episode_reward_min": -46.17527321329547, "episode_reward_mean": -13.09067221057397, "episode_len_mean": 50.98, "episodes_this_iter": 26, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.175371739996084, 9.99961421681211, -40.37334212157885, 9.978785793747669, -40.21131837522799, -41.49696679759291, -40.00134851445118, 7.980239345333139, 9.045005704261165, -40.0352562114032, -40.004983095477115, -40.00540589326103, 9.795504138045443, 9.965297043907754, 7.34618149473442, 7.067728085260358, -40.02839057563923, -40.5448449632364, -41.66525020594452, 9.83243121838774, 9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386], "episode_lengths": [25, 3, 69, 47, 64, 85, 8, 144, 118, 9, 9, 14, 27, 33, 77, 144, 32, 19, 55, 69, 16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18021003028207713, "mean_inference_ms": 0.4723270955964004, "mean_action_processing_ms": 0.10678152339599344, "mean_env_wait_ms": 0.07548220509930786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003442525863647461, "StateBufferConnector_ms": 0.004005908966064453, "ViewRequirementAgentConnector_ms": 0.0640404224395752}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32009, "num_agent_steps_trained": 32009, "num_env_steps_sampled": 32009, "num_env_steps_trained": 32009, "num_env_steps_sampled_this_iter": 1312, "num_env_steps_trained_this_iter": 1312, "timesteps_total": 32009, "num_steps_trained_this_iter": 1312, "agent_timesteps_total": 32009, "timers": {"training_iteration_time_ms": 5925.078, "load_time_ms": 2.082, "load_throughput": 599028.448, "learn_time_ms": 5670.323, "learn_throughput": 219.917, "synch_weights_time_ms": 2.297}, "counters": {"num_env_steps_sampled": 32009, "num_env_steps_trained": 32009, "num_agent_steps_sampled": 32009, "num_agent_steps_trained": 32009}, "done": false, "episodes_total": 589, "training_iteration": 26, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-15", "timestamp": 1678933995, "time_this_iter_s": 6.379802942276001, "time_total_s": 154.20508909225464, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d591f0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d59250>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 154.20508909225464, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.966666666666665, "ram_util_percent": 21.333333333333336, "gpu_util_percent0": 0.6322222222222221, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 6.786773117778084, "policy_loss": -0.036931535615040374, "vf_loss": 6.811484941993714, "vf_explained_var": -0.19994320053238052, "kl": 0.010486991667392703, "entropy": 0.9213984819414379, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 33221, "num_env_steps_trained": 33221, "num_agent_steps_sampled": 33221, "num_agent_steps_trained": 33221}, "sampler_results": {"episode_reward_max": 9.99745170130916, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -12.877217033143527, "episode_len_mean": 52.59, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508], "episode_lengths": [16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1804174651414644, "mean_inference_ms": 0.4729157853121271, "mean_action_processing_ms": 0.1069846278052832, "mean_env_wait_ms": 0.0755675345210654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034608840942382812, "StateBufferConnector_ms": 0.0038001537322998047, "ViewRequirementAgentConnector_ms": 0.06457805633544922}}, "episode_reward_max": 9.99745170130916, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -12.877217033143527, "episode_len_mean": 52.59, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.995157315608578, 9.614591080999615, 4.855461988209434, -40.069099135363025, 9.91311139843912, 9.99745170130916, -41.56353904588812, -1.7293393876410512, 5.812771715774374, 9.881110120020246, -40.00904321647181, -9.790588539914442, -40.00102823182589, -45.804274950721386, -43.45009656010028, 9.79801193417169, -40.22432225481491, 9.88583165388665, -0.22281609596915963, 5.760169502487187, 9.921241959322717, -40.02054893092791, -40.186095437974856, -40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508], "episode_lengths": [16, 76, 51, 41, 5, 7, 61, 115, 71, 44, 2, 109, 4, 92, 57, 30, 16, 19, 64, 63, 11, 26, 31, 57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1804174651414644, "mean_inference_ms": 0.4729157853121271, "mean_action_processing_ms": 0.1069846278052832, "mean_env_wait_ms": 0.0755675345210654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034608840942382812, "StateBufferConnector_ms": 0.0038001537322998047, "ViewRequirementAgentConnector_ms": 0.06457805633544922}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33221, "num_agent_steps_trained": 33221, "num_env_steps_sampled": 33221, "num_env_steps_trained": 33221, "num_env_steps_sampled_this_iter": 1212, "num_env_steps_trained_this_iter": 1212, "timesteps_total": 33221, "num_steps_trained_this_iter": 1212, "agent_timesteps_total": 33221, "timers": {"training_iteration_time_ms": 5861.42, "load_time_ms": 1.944, "load_throughput": 634223.711, "learn_time_ms": 5609.288, "learn_throughput": 219.76, "synch_weights_time_ms": 3.45}, "counters": {"num_env_steps_sampled": 33221, "num_env_steps_trained": 33221, "num_agent_steps_sampled": 33221, "num_agent_steps_trained": 33221}, "done": false, "episodes_total": 609, "training_iteration": 27, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-21", "timestamp": 1678934001, "time_this_iter_s": 5.811737537384033, "time_total_s": 160.01682662963867, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e7e220>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e7e0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 160.01682662963867, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.850000000000001, "ram_util_percent": 21.2875, "gpu_util_percent0": 0.665, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 6.371938569768257, "policy_loss": -0.03091592965899287, "vf_loss": 6.3942297861181405, "vf_explained_var": -0.3542458865019652, "kl": 0.007473094814761429, "entropy": 0.9523946835651054, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 31335.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 34429, "num_env_steps_trained": 34429, "num_agent_steps_sampled": 34429, "num_agent_steps_trained": 34429}, "sampler_results": {"episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -13.665940319458635, "episode_len_mean": 54.56, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378], "episode_lengths": [57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18028985001991876, "mean_inference_ms": 0.47281483828320164, "mean_action_processing_ms": 0.10690256853836408, "mean_env_wait_ms": 0.07543884377751608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.0034668445587158203, "ViewRequirementAgentConnector_ms": 0.06356453895568848}}, "episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -13.665940319458635, "episode_len_mean": 54.56, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.6327043520649, 9.687034065846518, 9.278870263942295, 9.950625040867406, -11.921121087018381, 9.940449173880134, -40.978915577990165, -40.031490735326, 9.494151547595973, 9.377854640707701, -40.12964100328128, -40.521027114521154, -40.177461040629126, 0.953046602860482, 8.899680250050768, -42.60955463982437, -40.00092490420242, -40.02569527071697, 9.96684765438134, 9.978615937394894, 9.74351692905288, 8.739299527298519, 8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378], "episode_lengths": [57, 90, 27, 16, 105, 63, 79, 3, 74, 28, 61, 75, 21, 93, 112, 120, 6, 6, 39, 47, 40, 125, 99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18028985001991876, "mean_inference_ms": 0.47281483828320164, "mean_action_processing_ms": 0.10690256853836408, "mean_env_wait_ms": 0.07543884377751608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.0034668445587158203, "ViewRequirementAgentConnector_ms": 0.06356453895568848}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34429, "num_agent_steps_trained": 34429, "num_env_steps_sampled": 34429, "num_env_steps_trained": 34429, "num_env_steps_sampled_this_iter": 1208, "num_env_steps_trained_this_iter": 1208, "timesteps_total": 34429, "num_steps_trained_this_iter": 1208, "agent_timesteps_total": 34429, "timers": {"training_iteration_time_ms": 5922.289, "load_time_ms": 1.787, "load_throughput": 696998.75, "learn_time_ms": 5670.593, "learn_throughput": 219.642, "synch_weights_time_ms": 3.505}, "counters": {"num_env_steps_sampled": 34429, "num_env_steps_trained": 34429, "num_agent_steps_sampled": 34429, "num_agent_steps_trained": 34429}, "done": false, "episodes_total": 632, "training_iteration": 28, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-27", "timestamp": 1678934007, "time_this_iter_s": 5.7368786334991455, "time_total_s": 165.75370526313782, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4f910>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d4f970>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769cad8b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 165.75370526313782, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.299999999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7457142857142858, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1899228261133452, "cur_lr": 0.00028391189332537973, "total_loss": 6.17442708209157, "policy_loss": -0.07633823634435734, "vf_loss": 6.241342163743102, "vf_explained_var": -0.2118541363378366, "kl": 0.008138684348147468, "entropy": 0.9294753169020017, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 32490.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 35715, "num_env_steps_trained": 35715, "num_agent_steps_sampled": 35715, "num_agent_steps_trained": 35715}, "sampler_results": {"episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -14.242682707916254, "episode_len_mean": 54.55, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099], "episode_lengths": [99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18029338638698963, "mean_inference_ms": 0.47300840896898066, "mean_action_processing_ms": 0.10698199625870783, "mean_env_wait_ms": 0.07540679430918855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035479068756103516, "StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.06280112266540527}}, "episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -14.242682707916254, "episode_len_mean": 54.55, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.48581007063157, -40.005124833898265, 9.802242955039727, -40.24982597721896, 8.771683447817198, -40.23778193242272, 9.927456391794703, 8.178207308010673, 9.227173900348681, 9.8939634813581, 9.808302293970383, -40.55822695611204, 7.04478690609438, 8.610199067959929, -40.84410121849741, -41.09076895045067, 9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099], "episode_lengths": [99, 3, 29, 28, 75, 28, 9, 70, 96, 30, 17, 36, 82, 139, 72, 41, 47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18029338638698963, "mean_inference_ms": 0.47300840896898066, "mean_action_processing_ms": 0.10698199625870783, "mean_env_wait_ms": 0.07540679430918855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035479068756103516, "StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.06280112266540527}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35715, "num_agent_steps_trained": 35715, "num_env_steps_sampled": 35715, "num_env_steps_trained": 35715, "num_env_steps_sampled_this_iter": 1286, "num_env_steps_trained_this_iter": 1286, "timesteps_total": 35715, "num_steps_trained_this_iter": 1286, "agent_timesteps_total": 35715, "timers": {"training_iteration_time_ms": 5989.594, "load_time_ms": 1.727, "load_throughput": 727658.987, "learn_time_ms": 5738.512, "learn_throughput": 218.959, "synch_weights_time_ms": 3.547}, "counters": {"num_env_steps_sampled": 35715, "num_env_steps_trained": 35715, "num_agent_steps_sampled": 35715, "num_agent_steps_trained": 35715}, "done": false, "episodes_total": 654, "training_iteration": 29, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-33", "timestamp": 1678934013, "time_this_iter_s": 6.2687859535217285, "time_total_s": 172.02249121665955, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4fa90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d4fd60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769d5bb80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 172.02249121665955, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.488888888888889, "ram_util_percent": 21.3, "gpu_util_percent0": 0.6922222222222222, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 6.687726567705504, "policy_loss": -0.071396763342568, "vf_loss": 6.747397234790728, "vf_explained_var": -0.108273533012113, "kl": 0.010070488409029276, "entropy": 0.9144025899151451, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 33675.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 36975, "num_env_steps_trained": 36975, "num_agent_steps_sampled": 36975, "num_agent_steps_trained": 36975}, "sampler_results": {"episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -14.635155993984986, "episode_len_mean": 58.61, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847], "episode_lengths": [47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18039736136124163, "mean_inference_ms": 0.4735224824667085, "mean_action_processing_ms": 0.10707235169761471, "mean_env_wait_ms": 0.07558188077619753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003280162811279297, "StateBufferConnector_ms": 0.0030541419982910156, "ViewRequirementAgentConnector_ms": 0.05957317352294922}}, "episode_reward_max": 9.996522499759788, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -14.635155993984986, "episode_len_mean": 58.61, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.974241053039856, -40.00365380318501, 9.777690314827568, -40.572864303528135, -40.0, 5.027413390716984, 8.391195238127809, 9.996522499759788, -40.004741565658954, -46.17527321329547, 9.958398275133963, -40.04977616330651, -40.16587286043595, 5.478253971809656, 9.844902598133789, -40.645789331909214, 6.806795223241199, -40.05034492870745, 9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847], "episode_lengths": [47, 22, 16, 50, 1, 119, 109, 5, 20, 94, 15, 6, 11, 125, 18, 53, 61, 52, 71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18039736136124163, "mean_inference_ms": 0.4735224824667085, "mean_action_processing_ms": 0.10707235169761471, "mean_env_wait_ms": 0.07558188077619753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003280162811279297, "StateBufferConnector_ms": 0.0030541419982910156, "ViewRequirementAgentConnector_ms": 0.05957317352294922}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36975, "num_agent_steps_trained": 36975, "num_env_steps_sampled": 36975, "num_env_steps_trained": 36975, "num_env_steps_sampled_this_iter": 1260, "num_env_steps_trained_this_iter": 1260, "timesteps_total": 36975, "num_steps_trained_this_iter": 1260, "agent_timesteps_total": 36975, "timers": {"training_iteration_time_ms": 6009.703, "load_time_ms": 1.816, "load_throughput": 694515.669, "learn_time_ms": 5757.254, "learn_throughput": 219.011, "synch_weights_time_ms": 3.542}, "counters": {"num_env_steps_sampled": 36975, "num_env_steps_trained": 36975, "num_agent_steps_sampled": 36975, "num_agent_steps_trained": 36975}, "done": false, "episodes_total": 670, "training_iteration": 30, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-39", "timestamp": 1678934019, "time_this_iter_s": 6.029429912567139, "time_total_s": 178.05192112922668, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4f760>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d4f100>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 178.05192112922668, "timesteps_since_restore": 0, "iterations_since_restore": 30, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.774999999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7012499999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 4.573213043875802, "policy_loss": -0.11383813041397649, "vf_loss": 4.665576510564782, "vf_explained_var": -0.21824011466442012, "kl": 0.01824001900055228, "entropy": 0.8167316935510717, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 34845.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 38244, "num_env_steps_trained": 38244, "num_agent_steps_sampled": 38244, "num_agent_steps_trained": 38244}, "sampler_results": {"episode_reward_max": 9.995040552895068, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -13.235801077669986, "episode_len_mean": 63.06, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616], "episode_lengths": [71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18010209235255062, "mean_inference_ms": 0.4728873713113515, "mean_action_processing_ms": 0.10697256585015108, "mean_env_wait_ms": 0.07549957280840106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003328084945678711, "StateBufferConnector_ms": 0.002789735794067383, "ViewRequirementAgentConnector_ms": 0.058457136154174805}}, "episode_reward_max": 9.995040552895068, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -13.235801077669986, "episode_len_mean": 63.06, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.417060075820386, 9.8764120702999, -41.929140546162486, -40.30145732465549, -40.13896755254452, 9.628805454136769, -40.30942194863208, 6.930111283456132, -0.9387251082004742, 9.08788833280011, 9.792611832977638, 9.994331676641472, -42.754065799170114, -45.34888708282086, -40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616], "episode_lengths": [71, 17, 91, 46, 62, 37, 27, 31, 108, 141, 16, 4, 133, 48, 113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18010209235255062, "mean_inference_ms": 0.4728873713113515, "mean_action_processing_ms": 0.10697256585015108, "mean_env_wait_ms": 0.07549957280840106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003328084945678711, "StateBufferConnector_ms": 0.002789735794067383, "ViewRequirementAgentConnector_ms": 0.058457136154174805}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38244, "num_agent_steps_trained": 38244, "num_env_steps_sampled": 38244, "num_env_steps_trained": 38244, "num_env_steps_sampled_this_iter": 1269, "num_env_steps_trained_this_iter": 1269, "timesteps_total": 38244, "num_steps_trained_this_iter": 1269, "agent_timesteps_total": 38244, "timers": {"training_iteration_time_ms": 6016.094, "load_time_ms": 1.835, "load_throughput": 687544.37, "learn_time_ms": 5763.946, "learn_throughput": 218.913, "synch_weights_time_ms": 3.542}, "counters": {"num_env_steps_sampled": 38244, "num_env_steps_trained": 38244, "num_agent_steps_sampled": 38244, "num_agent_steps_trained": 38244}, "done": false, "episodes_total": 688, "training_iteration": 31, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-45", "timestamp": 1678934025, "time_this_iter_s": 6.0206427574157715, "time_total_s": 184.07256388664246, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6edf0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6e0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 184.07256388664246, "timesteps_since_restore": 0, "iterations_since_restore": 31, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.7375, "ram_util_percent": 21.3, "gpu_util_percent0": 0.6900000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.189922826113345, "cur_lr": 0.0002839118933253797, "total_loss": 4.946059906152119, "policy_loss": -0.049028797300012264, "vf_loss": 4.968801390169071, "vf_explained_var": 0.18065020345352792, "kl": 0.022284443351882087, "entropy": 0.8163934754493001, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 35985.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 39455, "num_env_steps_trained": 39455, "num_agent_steps_sampled": 39455, "num_agent_steps_trained": 39455}, "sampler_results": {"episode_reward_max": 9.995040552895068, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -10.93066775568329, "episode_len_mean": 66.85, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471], "episode_lengths": [113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17971935444893614, "mean_inference_ms": 0.4719390233109096, "mean_action_processing_ms": 0.10673998544516529, "mean_env_wait_ms": 0.07528898038921658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033059120178222656, "StateBufferConnector_ms": 0.002716541290283203, "ViewRequirementAgentConnector_ms": 0.05721783638000488}}, "episode_reward_max": 9.995040552895068, "episode_reward_min": -48.60157521534256, "episode_reward_mean": -10.93066775568329, "episode_len_mean": 66.85, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.7768459287444, 4.357734937001998, 9.15339534441311, -40.208185193742494, -48.60157521534256, 9.869619616222726, 9.780930921783508, -40.33803397094882, 9.973051504441619, 9.95314997534169, -40.37142377040558, 0.8172448188307584, -40.05148806199598, -40.04725192679481, -40.06136853321603, -40.041691721528494, 0.960158644385718, 9.337779072027384, -40.345030592321834, 9.98588533802332, -40.133790970433836, -40.91548162316705, 8.59646476513623, -40.56285385297989, 9.940301820886335, 9.96484763274366, 6.625522208244664, 5.320754562889418, -47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471], "episode_lengths": [113, 81, 65, 19, 85, 16, 72, 28, 29, 17, 22, 99, 17, 61, 59, 17, 96, 67, 26, 18, 29, 88, 45, 74, 16, 19, 121, 102, 38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17971935444893614, "mean_inference_ms": 0.4719390233109096, "mean_action_processing_ms": 0.10673998544516529, "mean_env_wait_ms": 0.07528898038921658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033059120178222656, "StateBufferConnector_ms": 0.002716541290283203, "ViewRequirementAgentConnector_ms": 0.05721783638000488}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39455, "num_agent_steps_trained": 39455, "num_env_steps_sampled": 39455, "num_env_steps_trained": 39455, "num_env_steps_sampled_this_iter": 1211, "num_env_steps_trained_this_iter": 1211, "timesteps_total": 39455, "num_steps_trained_this_iter": 1211, "agent_timesteps_total": 39455, "timers": {"training_iteration_time_ms": 5915.413, "load_time_ms": 1.82, "load_throughput": 683733.899, "learn_time_ms": 5666.798, "learn_throughput": 219.648, "synch_weights_time_ms": 3.544}, "counters": {"num_env_steps_sampled": 39455, "num_env_steps_trained": 39455, "num_agent_steps_sampled": 39455, "num_agent_steps_trained": 39455}, "done": false, "episodes_total": 702, "training_iteration": 32, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-51", "timestamp": 1678934031, "time_this_iter_s": 5.677682399749756, "time_total_s": 189.7502462863922, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ceaaf0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ceabe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769d5bdc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 189.7502462863922, "timesteps_since_restore": 0, "iterations_since_restore": 32, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.737499999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7837500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.784884239170017, "cur_lr": 0.0002839118933253797, "total_loss": 5.516363742614671, "policy_loss": -0.11249646032065676, "vf_loss": 5.61774836526285, "vf_explained_var": -0.04105041189151898, "kl": 0.006347891576479029, "entropy": 0.7771541237373624, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 37110.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 40679, "num_env_steps_trained": 40679, "num_agent_steps_sampled": 40679, "num_agent_steps_trained": 40679}, "sampler_results": {"episode_reward_max": 9.998802743227468, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -10.039804765420202, "episode_len_mean": 64.08, "episode_media": {}, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755], "episode_lengths": [38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17978429312791616, "mean_inference_ms": 0.47266476408140085, "mean_action_processing_ms": 0.10691117683156393, "mean_env_wait_ms": 0.07548508988552119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.0030679702758789062, "ViewRequirementAgentConnector_ms": 0.061109304428100586}}, "episode_reward_max": 9.998802743227468, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -10.039804765420202, "episode_len_mean": 64.08, "episodes_this_iter": 28, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-47.88663730178049, 2.7716819337267378, 8.85900655812061, 9.980604518782028, 9.357627672489402, 1.9822632351645986, 9.64129234711161, 8.291087620690824, -41.55059129830758, -5.161842254390832, -40.063710669879995, 5.041943585644882, 9.877137800333204, 7.504746641452771, -40.56886386472233, -40.20170678549575, 9.813748538878656, -40.99432686283987, -47.95843238870391, -40.00415591270734, 9.967067796291419, -41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755], "episode_lengths": [38, 120, 20, 3, 40, 103, 74, 79, 115, 88, 34, 44, 38, 135, 29, 35, 44, 54, 66, 16, 21, 69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17978429312791616, "mean_inference_ms": 0.47266476408140085, "mean_action_processing_ms": 0.10691117683156393, "mean_env_wait_ms": 0.07548508988552119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034711360931396484, "StateBufferConnector_ms": 0.0030679702758789062, "ViewRequirementAgentConnector_ms": 0.061109304428100586}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40679, "num_agent_steps_trained": 40679, "num_env_steps_sampled": 40679, "num_env_steps_trained": 40679, "num_env_steps_sampled_this_iter": 1224, "num_env_steps_trained_this_iter": 1224, "timesteps_total": 40679, "num_steps_trained_this_iter": 1224, "agent_timesteps_total": 40679, "timers": {"training_iteration_time_ms": 5917.785, "load_time_ms": 2.017, "load_throughput": 611976.065, "learn_time_ms": 5663.866, "learn_throughput": 217.961, "synch_weights_time_ms": 3.58}, "counters": {"num_env_steps_sampled": 40679, "num_env_steps_trained": 40679, "num_agent_steps_sampled": 40679, "num_agent_steps_trained": 40679}, "done": false, "episodes_total": 730, "training_iteration": 33, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-33-57", "timestamp": 1678934037, "time_this_iter_s": 6.036302804946899, "time_total_s": 195.7865490913391, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e7ed60>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce7550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769d5bf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 195.7865490913391, "timesteps_since_restore": 0, "iterations_since_restore": 33, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.825, "ram_util_percent": 21.3, "gpu_util_percent0": 0.61, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7848842391700177, "cur_lr": 0.0002839118933253797, "total_loss": 3.82216465163419, "policy_loss": -0.04991772293647313, "vf_loss": 3.8588429608062715, "vf_explained_var": 0.026309517785614613, "kl": 0.007538419312314724, "entropy": 0.7677615684877132, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 38190.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 41792, "num_env_steps_trained": 41792, "num_agent_steps_sampled": 41792, "num_agent_steps_trained": 41792}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -7.95901079553913, "episode_len_mean": 63.25, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278], "episode_lengths": [69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1799555002524503, "mean_inference_ms": 0.47336275871652744, "mean_action_processing_ms": 0.10708821137650075, "mean_env_wait_ms": 0.07567153088960463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034117698669433594, "StateBufferConnector_ms": 0.003156423568725586, "ViewRequirementAgentConnector_ms": 0.0615081787109375}}, "episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -7.95901079553913, "episode_len_mean": 63.25, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.72378846376683, -40.151626746232296, -40.63026400537099, 7.0351621569024605, -10.241249332561434, -8.356401785239196, 9.521432651412674, -9.857556750862287, -41.074005049455195, 9.907654343220818, 9.663964651305768, 2.856078009988547, 7.332873232741731, -43.92019731656884, -44.77281147459901, -46.61532691515113, -2.230178693157171, 9.801357620812967, -41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278], "episode_lengths": [69, 72, 107, 90, 104, 115, 92, 114, 118, 6, 36, 63, 137, 42, 72, 97, 65, 27, 82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1799555002524503, "mean_inference_ms": 0.47336275871652744, "mean_action_processing_ms": 0.10708821137650075, "mean_env_wait_ms": 0.07567153088960463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034117698669433594, "StateBufferConnector_ms": 0.003156423568725586, "ViewRequirementAgentConnector_ms": 0.0615081787109375}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41792, "num_agent_steps_trained": 41792, "num_env_steps_sampled": 41792, "num_env_steps_trained": 41792, "num_env_steps_sampled_this_iter": 1113, "num_env_steps_trained_this_iter": 1113, "timesteps_total": 41792, "num_steps_trained_this_iter": 1113, "agent_timesteps_total": 41792, "timers": {"training_iteration_time_ms": 5892.613, "load_time_ms": 2.015, "load_throughput": 610584.91, "learn_time_ms": 5639.52, "learn_throughput": 218.192, "synch_weights_time_ms": 3.555}, "counters": {"num_env_steps_sampled": 41792, "num_env_steps_trained": 41792, "num_agent_steps_sampled": 41792, "num_agent_steps_trained": 41792}, "done": false, "episodes_total": 751, "training_iteration": 34, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-02", "timestamp": 1678934042, "time_this_iter_s": 5.3246612548828125, "time_total_s": 201.11121034622192, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce78b0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce73a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 201.11121034622192, "timesteps_since_restore": 0, "iterations_since_restore": 34, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.762500000000001, "ram_util_percent": 21.3, "gpu_util_percent0": 0.69375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7848842391700173, "cur_lr": 0.0002839118933253797, "total_loss": 4.6162081980620755, "policy_loss": -0.023999916403381914, "vf_loss": 4.600265561653025, "vf_explained_var": 0.058630518780814274, "kl": 0.0225253584523334, "entropy": 0.9343496038405984, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 39240.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 42960, "num_env_steps_trained": 42960, "num_agent_steps_sampled": 42960, "num_agent_steps_trained": 42960}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -6.3612136761014435, "episode_len_mean": 60.67, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705], "episode_lengths": [82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1799793247720493, "mean_inference_ms": 0.47381412306634696, "mean_action_processing_ms": 0.10719938203918283, "mean_env_wait_ms": 0.07570374635680109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.0033655166625976562, "ViewRequirementAgentConnector_ms": 0.06277656555175781}}, "episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -6.3612136761014435, "episode_len_mean": 60.67, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-41.53412800123847, 8.950378450763047, 9.117777589053707, -40.20403359870413, 9.876606019443944, 5.661611807592273, 9.995040552895068, -44.354130567556346, 7.314646357255655, -40.43667028935073, 9.68001276967336, -1.0943299685021728, -40.5912758302432, 9.966494725937432, -40.562341169610725, 9.639156491269322, 6.004039534301249, 9.78446848500768, -41.2248633329616, 6.550608766095913, 9.833486136095285, 9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705], "episode_lengths": [82, 119, 24, 64, 29, 134, 10, 103, 132, 60, 95, 44, 76, 15, 109, 55, 87, 45, 68, 131, 53, 104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1799793247720493, "mean_inference_ms": 0.47381412306634696, "mean_action_processing_ms": 0.10719938203918283, "mean_env_wait_ms": 0.07570374635680109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.0033655166625976562, "ViewRequirementAgentConnector_ms": 0.06277656555175781}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 42960, "num_agent_steps_trained": 42960, "num_env_steps_sampled": 42960, "num_env_steps_trained": 42960, "num_env_steps_sampled_this_iter": 1168, "num_env_steps_trained_this_iter": 1168, "timesteps_total": 42960, "num_steps_trained_this_iter": 1168, "agent_timesteps_total": 42960, "timers": {"training_iteration_time_ms": 5873.532, "load_time_ms": 2.131, "load_throughput": 575345.645, "learn_time_ms": 5620.907, "learn_throughput": 218.168, "synch_weights_time_ms": 3.544}, "counters": {"num_env_steps_sampled": 42960, "num_env_steps_trained": 42960, "num_agent_steps_sampled": 42960, "num_agent_steps_trained": 42960}, "done": false, "episodes_total": 769, "training_iteration": 35, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-08", "timestamp": 1678934048, "time_this_iter_s": 5.514026880264282, "time_total_s": 206.6252372264862, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce7fd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdab80>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 206.6252372264862, "timesteps_since_restore": 0, "iterations_since_restore": 35, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.028571428571428, "ram_util_percent": 21.314285714285717, "gpu_util_percent0": 0.772857142857143, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.677326358755026, "cur_lr": 0.0002839118933253797, "total_loss": 4.61809503680789, "policy_loss": -0.011842958614522335, "vf_loss": 4.6068884065959095, "vf_explained_var": 0.08667245127406775, "kl": 0.008690918986824335, "entropy": 0.7786022969758978, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 40290.5, "diff_num_grad_updates_vs_sampler_policy": 509.5}}, "num_env_steps_sampled": 44071, "num_env_steps_trained": 44071, "num_agent_steps_sampled": 44071, "num_agent_steps_trained": 44071}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -7.030849173730822, "episode_len_mean": 56.43, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298], "episode_lengths": [104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18010028846875503, "mean_inference_ms": 0.4743389752962504, "mean_action_processing_ms": 0.10731468046853991, "mean_env_wait_ms": 0.07579892615324763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035233497619628906, "StateBufferConnector_ms": 0.0035963058471679688, "ViewRequirementAgentConnector_ms": 0.06328296661376953}}, "episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -7.030849173730822, "episode_len_mean": 56.43, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.307435493348436, 3.192799981657795, 1.2257109834694155, 2.170730949478081, -10.098001599732399, 9.152825284122763, 9.660167676413192, -1.4523049096453846, 9.990371902286636, 5.342631811380391, -5.955003426531617, -5.401571485822471, 9.975781339577846, -40.10155783494393, -40.03824594176547, 9.948401668256889, 9.592518868189048, 9.591472131001641, -40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298], "episode_lengths": [104, 72, 113, 61, 120, 76, 29, 72, 3, 165, 110, 102, 11, 35, 20, 40, 40, 120, 50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18010028846875503, "mean_inference_ms": 0.4743389752962504, "mean_action_processing_ms": 0.10731468046853991, "mean_env_wait_ms": 0.07579892615324763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035233497619628906, "StateBufferConnector_ms": 0.0035963058471679688, "ViewRequirementAgentConnector_ms": 0.06328296661376953}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44071, "num_agent_steps_trained": 44071, "num_env_steps_sampled": 44071, "num_env_steps_trained": 44071, "num_env_steps_sampled_this_iter": 1111, "num_env_steps_trained_this_iter": 1111, "timesteps_total": 44071, "num_steps_trained_this_iter": 1111, "agent_timesteps_total": 44071, "timers": {"training_iteration_time_ms": 5769.049, "load_time_ms": 1.956, "load_throughput": 616701.142, "learn_time_ms": 5522.806, "learn_throughput": 218.403, "synch_weights_time_ms": 3.622}, "counters": {"num_env_steps_sampled": 44071, "num_env_steps_trained": 44071, "num_agent_steps_sampled": 44071, "num_agent_steps_trained": 44071}, "done": false, "episodes_total": 790, "training_iteration": 36, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-13", "timestamp": 1678934053, "time_this_iter_s": 5.33654260635376, "time_total_s": 211.96177983283997, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ceaac0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ceac40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 211.96177983283997, "timesteps_since_restore": 0, "iterations_since_restore": 36, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.92857142857143, "ram_util_percent": 21.3, "gpu_util_percent0": 0.6714285714285715, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.677326358755026, "cur_lr": 0.0002839118933253797, "total_loss": 3.4082473643443416, "policy_loss": -0.08850750815300715, "vf_loss": 3.4826019570941016, "vf_explained_var": -0.0010299305688767206, "kl": 0.005370390369256127, "entropy": 0.8018101630324409, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 41325.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 45201, "num_env_steps_trained": 45201, "num_agent_steps_sampled": 45201, "num_agent_steps_trained": 45201}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -8.387639020945038, "episode_len_mean": 54.8, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318], "episode_lengths": [50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18024616022988318, "mean_inference_ms": 0.4747052797722022, "mean_action_processing_ms": 0.1073835142943956, "mean_env_wait_ms": 0.07589032221659317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035855770111083984, "StateBufferConnector_ms": 0.0036029815673828125, "ViewRequirementAgentConnector_ms": 0.06336307525634766}}, "episode_reward_max": 10.0, "episode_reward_min": -49.186753803473344, "episode_reward_mean": -8.387639020945038, "episode_len_mean": 54.8, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.11876818015549, 9.911766403869722, -40.71369108101314, -42.025499369450344, -40.087200229780045, 9.955239774314471, 9.998802743227468, 9.873045451991464, 9.998797022232406, 0.6871255585586233, -40.21613159100783, -40.5229532363624, 9.997886976078345, 9.989526574366442, -49.186753803473344, 8.541014488440375, -42.71625188596325, 7.810341995744462, -6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318], "episode_lengths": [50, 14, 52, 55, 24, 28, 7, 19, 5, 56, 18, 42, 10, 21, 75, 91, 37, 67, 82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18024616022988318, "mean_inference_ms": 0.4747052797722022, "mean_action_processing_ms": 0.1073835142943956, "mean_env_wait_ms": 0.07589032221659317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035855770111083984, "StateBufferConnector_ms": 0.0036029815673828125, "ViewRequirementAgentConnector_ms": 0.06336307525634766}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45201, "num_agent_steps_trained": 45201, "num_env_steps_sampled": 45201, "num_env_steps_trained": 45201, "num_env_steps_sampled_this_iter": 1130, "num_env_steps_trained_this_iter": 1130, "timesteps_total": 45201, "num_steps_trained_this_iter": 1130, "agent_timesteps_total": 45201, "timers": {"training_iteration_time_ms": 5733.211, "load_time_ms": 1.954, "load_throughput": 613188.87, "learn_time_ms": 5487.904, "learn_throughput": 218.298, "synch_weights_time_ms": 2.477}, "counters": {"num_env_steps_sampled": 45201, "num_env_steps_trained": 45201, "num_agent_steps_sampled": 45201, "num_agent_steps_trained": 45201}, "done": false, "episodes_total": 808, "training_iteration": 37, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-19", "timestamp": 1678934059, "time_this_iter_s": 5.452239990234375, "time_total_s": 217.41401982307434, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9bd30>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9beb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 217.41401982307434, "timesteps_since_restore": 0, "iterations_since_restore": 37, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.799999999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.7875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.677326358755026, "cur_lr": 0.0002839118933253797, "total_loss": 3.6804643433018214, "policy_loss": -0.012857375447556638, "vf_loss": 3.68156237725675, "vf_explained_var": 0.04591488179407622, "kl": 0.004475236761655873, "entropy": 0.7911137415128842, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 42420.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 46448, "num_env_steps_trained": 46448, "num_agent_steps_sampled": 46448, "num_agent_steps_trained": 46448}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -6.028333373995548, "episode_len_mean": 60.56, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357], "episode_lengths": [82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17970797412699327, "mean_inference_ms": 0.47283888136668734, "mean_action_processing_ms": 0.10702127573598577, "mean_env_wait_ms": 0.07549056322003576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.003310680389404297, "ViewRequirementAgentConnector_ms": 0.061454057693481445}}, "episode_reward_max": 10.0, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -6.028333373995548, "episode_len_mean": 60.56, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-6.179157985165844, 1.1321859606052591, -40.111775093548395, 6.2821981032342755, 9.895518290221004, 9.918207080131646, 5.868229262066496, 9.919036400467787, 9.997370611192423, 1.0618544624472275, 3.587986431973534, -40.49036258636514, 9.660896438121137, 10.0, -46.18534630271843, -40.012018745997935, -45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357], "episode_lengths": [82, 82, 26, 97, 41, 23, 137, 30, 15, 69, 68, 27, 14, 1, 109, 14, 32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17970797412699327, "mean_inference_ms": 0.47283888136668734, "mean_action_processing_ms": 0.10702127573598577, "mean_env_wait_ms": 0.07549056322003576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034737586975097656, "StateBufferConnector_ms": 0.003310680389404297, "ViewRequirementAgentConnector_ms": 0.061454057693481445}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46448, "num_agent_steps_trained": 46448, "num_env_steps_sampled": 46448, "num_env_steps_trained": 46448, "num_env_steps_sampled_this_iter": 1247, "num_env_steps_trained_this_iter": 1247, "timesteps_total": 46448, "num_steps_trained_this_iter": 1247, "agent_timesteps_total": 46448, "timers": {"training_iteration_time_ms": 5756.687, "load_time_ms": 1.974, "load_throughput": 608862.02, "learn_time_ms": 5509.462, "learn_throughput": 218.152, "synch_weights_time_ms": 2.416}, "counters": {"num_env_steps_sampled": 46448, "num_env_steps_trained": 46448, "num_agent_steps_sampled": 46448, "num_agent_steps_trained": 46448}, "done": false, "episodes_total": 826, "training_iteration": 38, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-25", "timestamp": 1678934065, "time_this_iter_s": 5.97069239616394, "time_total_s": 223.38471221923828, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9b280>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9bcd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 223.38471221923828, "timesteps_since_restore": 0, "iterations_since_restore": 38, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.787500000000001, "ram_util_percent": 21.3, "gpu_util_percent0": 0.75375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3386631793775132, "cur_lr": 0.0002839118933253797, "total_loss": 5.037606361559313, "policy_loss": -0.11082082845461674, "vf_loss": 5.137880581195673, "vf_explained_var": -0.07297020574920197, "kl": 0.00807433441298359, "entropy": 0.9328756958500952, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 43575.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 47710, "num_env_steps_trained": 47710, "num_agent_steps_sampled": 47710, "num_agent_steps_trained": 47710}, "sampler_results": {"episode_reward_max": 9.998201048633993, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -6.968577933201995, "episode_len_mean": 64.83, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974], "episode_lengths": [32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794057219190414, "mean_inference_ms": 0.4721779835207911, "mean_action_processing_ms": 0.10685224000170067, "mean_env_wait_ms": 0.07532418854646639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427743911743164, "StateBufferConnector_ms": 0.0031816959381103516, "ViewRequirementAgentConnector_ms": 0.05990433692932129}}, "episode_reward_max": 9.998201048633993, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -6.968577933201995, "episode_len_mean": 64.83, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-45.07316088069514, 9.670065288017161, 9.321800430209526, 9.783163949324395, 8.45031665915948, 9.862942186259337, 8.317085879118608, 3.872086562555335, -0.6483335175227278, 9.915694131074089, -43.479025778684615, -5.461733786425928, 8.152636394169448, 9.946942399685241, -40.34206322163588, -41.91359131104139, -40.812722981051216, 6.693199481825916, 9.952652427090383, 9.784861301285147, 9.981906531208523, 9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974], "episode_lengths": [32, 48, 120, 26, 114, 9, 88, 47, 81, 9, 106, 95, 109, 5, 35, 97, 46, 48, 23, 89, 12, 2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794057219190414, "mean_inference_ms": 0.4721779835207911, "mean_action_processing_ms": 0.10685224000170067, "mean_env_wait_ms": 0.07532418854646639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427743911743164, "StateBufferConnector_ms": 0.0031816959381103516, "ViewRequirementAgentConnector_ms": 0.05990433692932129}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47710, "num_agent_steps_trained": 47710, "num_env_steps_sampled": 47710, "num_env_steps_trained": 47710, "num_env_steps_sampled_this_iter": 1262, "num_env_steps_trained_this_iter": 1262, "timesteps_total": 47710, "num_steps_trained_this_iter": 1262, "agent_timesteps_total": 47710, "timers": {"training_iteration_time_ms": 5737.396, "load_time_ms": 1.862, "load_throughput": 644182.797, "learn_time_ms": 5490.261, "learn_throughput": 218.478, "synch_weights_time_ms": 2.379}, "counters": {"num_env_steps_sampled": 47710, "num_env_steps_trained": 47710, "num_agent_steps_sampled": 47710, "num_agent_steps_trained": 47710}, "done": false, "episodes_total": 842, "training_iteration": 39, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-31", "timestamp": 1678934071, "time_this_iter_s": 6.075958490371704, "time_total_s": 229.46067070960999, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ccee80>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cce130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769d68dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 229.46067070960999, "timesteps_since_restore": 0, "iterations_since_restore": 39, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.6375, "ram_util_percent": 21.3375, "gpu_util_percent0": 0.6275, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.985082250801987, "episode_reward_min": -43.09391103322032, "episode_reward_mean": -27.933402603000946, "episode_len_mean": 53.06666666666667, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.621055402935035, -43.09391103322032, -40.32515507557512, -40.27713353549017, -40.17983392954732, 9.985082250801987, -42.92074103309493, -40.013724147284364, -40.81910532002829, 8.818193664571478, -40.18905234477301, -42.11109776238648, 2.9763950302390176, 9.770099593708359, -40.0], "episode_lengths": [41, 88, 36, 30, 87, 2, 81, 17, 22, 118, 45, 51, 111, 66, 1]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15633848496611633, "mean_inference_ms": 0.4340328958166148, "mean_action_processing_ms": 0.09817857641212349, "mean_env_wait_ms": 0.07134340929273593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032440821329752603, "StateBufferConnector_ms": 0.0034284591674804688, "ViewRequirementAgentConnector_ms": 0.05727608998616537}, "num_agent_steps_sampled_this_iter": 796, "num_env_steps_sampled_this_iter": 796, "timesteps_this_iter": 796, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3386631793775132, "cur_lr": 0.00028391189332537973, "total_loss": 5.604502263428488, "policy_loss": -0.07268648575991392, "vf_loss": 5.667337404725452, "vf_explained_var": -0.289672338416179, "kl": 0.0075444075227642385, "entropy": 0.8826094474891821, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 44760.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 49014, "num_env_steps_trained": 49014, "num_agent_steps_sampled": 49014, "num_agent_steps_trained": 49014}, "sampler_results": {"episode_reward_max": 9.998201048633993, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -7.45299114010032, "episode_len_mean": 65.48, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625], "episode_lengths": [2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17916627835980578, "mean_inference_ms": 0.47178978056018583, "mean_action_processing_ms": 0.10680032406666744, "mean_env_wait_ms": 0.0752208947665094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033528804779052734, "StateBufferConnector_ms": 0.003082275390625, "ViewRequirementAgentConnector_ms": 0.0595853328704834}}, "episode_reward_max": 9.998201048633993, "episode_reward_min": -47.77850805059647, "episode_reward_mean": -7.45299114010032, "episode_len_mean": 65.48, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.989722366797258, 8.050395785402346, 8.86060513380176, -0.6166619675224521, -40.04076264706715, 7.662773818277705, 9.72692779472206, -40.500729758750644, 9.361740046330166, 2.5172948330328087, 8.890550223421815, -40.13668778266264, -40.56982646743565, -40.96254364914399, -47.77850805059647, -40.36498312312714, 8.52949012097156, 9.967195091083218, -43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625], "episode_lengths": [2, 107, 139, 90, 39, 117, 38, 66, 61, 91, 59, 16, 26, 51, 70, 57, 111, 4, 47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17916627835980578, "mean_inference_ms": 0.47178978056018583, "mean_action_processing_ms": 0.10680032406666744, "mean_env_wait_ms": 0.0752208947665094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033528804779052734, "StateBufferConnector_ms": 0.003082275390625, "ViewRequirementAgentConnector_ms": 0.0595853328704834}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49014, "num_agent_steps_trained": 49014, "num_env_steps_sampled": 49014, "num_env_steps_trained": 49014, "num_env_steps_sampled_this_iter": 1304, "num_env_steps_trained_this_iter": 1304, "timesteps_total": 49014, "num_steps_trained_this_iter": 1304, "agent_timesteps_total": 49014, "timers": {"training_iteration_time_ms": 5753.651, "load_time_ms": 1.798, "load_throughput": 669644.668, "learn_time_ms": 5507.202, "learn_throughput": 218.605, "synch_weights_time_ms": 2.389}, "counters": {"num_env_steps_sampled": 49014, "num_env_steps_trained": 49014, "num_agent_steps_sampled": 49014, "num_agent_steps_trained": 49014}, "done": false, "episodes_total": 863, "training_iteration": 40, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-37", "timestamp": 1678934077, "time_this_iter_s": 6.621466159820557, "time_total_s": 236.08213686943054, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdb310>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdb370>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 236.08213686943054, "timesteps_since_restore": 0, "iterations_since_restore": 40, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.655555555555557, "ram_util_percent": 21.34444444444445, "gpu_util_percent0": 0.7166666666666666, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 5.0311309675060985, "policy_loss": -0.041340065878388045, "vf_loss": 5.061689698597131, "vf_explained_var": -0.26791546479001777, "kl": 0.00823771187377887, "entropy": 0.8758718553427104, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 45915.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 50226, "num_env_steps_trained": 50226, "num_agent_steps_sampled": 50226, "num_agent_steps_trained": 50226}, "sampler_results": {"episode_reward_max": 9.998201048633993, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.887614790388291, "episode_len_mean": 66.16, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682], "episode_lengths": [47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1789050778816249, "mean_inference_ms": 0.47135468066583114, "mean_action_processing_ms": 0.10669142376754479, "mean_env_wait_ms": 0.07508606658468638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401041030883789, "StateBufferConnector_ms": 0.0031118392944335938, "ViewRequirementAgentConnector_ms": 0.059522151947021484}}, "episode_reward_max": 9.998201048633993, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.887614790388291, "episode_len_mean": 66.16, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-43.86454723728045, 9.98352121864275, -41.90116836577486, 9.267970977007131, 9.023614712787358, 8.804907320061588, -14.570452561774143, 9.998201048633993, 9.987038774130298, 9.345618258089338, 7.059237200047337, -40.171102694979844, -41.216349394241355, 9.985328029171539, 1.4768513464020234, 8.44373374730019, 7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682], "episode_lengths": [47, 2, 22, 89, 100, 79, 101, 19, 2, 29, 68, 19, 65, 33, 64, 88, 130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1789050778816249, "mean_inference_ms": 0.47135468066583114, "mean_action_processing_ms": 0.10669142376754479, "mean_env_wait_ms": 0.07508606658468638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003401041030883789, "StateBufferConnector_ms": 0.0031118392944335938, "ViewRequirementAgentConnector_ms": 0.059522151947021484}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50226, "num_agent_steps_trained": 50226, "num_env_steps_sampled": 50226, "num_env_steps_trained": 50226, "num_env_steps_sampled_this_iter": 1212, "num_env_steps_trained_this_iter": 1212, "timesteps_total": 50226, "num_steps_trained_this_iter": 1212, "agent_timesteps_total": 50226, "timers": {"training_iteration_time_ms": 5729.112, "load_time_ms": 1.646, "load_throughput": 728107.305, "learn_time_ms": 5482.094, "learn_throughput": 218.566, "synch_weights_time_ms": 2.389}, "counters": {"num_env_steps_sampled": 50226, "num_env_steps_trained": 50226, "num_agent_steps_sampled": 50226, "num_agent_steps_trained": 50226}, "done": false, "episodes_total": 881, "training_iteration": 41, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-43", "timestamp": 1678934083, "time_this_iter_s": 5.775012254714966, "time_total_s": 241.8571491241455, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9b1c0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d9b610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 241.8571491241455, "timesteps_since_restore": 0, "iterations_since_restore": 41, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.037500000000001, "ram_util_percent": 21.3, "gpu_util_percent0": 0.64625, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 5.636105771047307, "policy_loss": -0.015707086389129227, "vf_loss": 5.638379620532463, "vf_explained_var": -0.38461512348673366, "kl": 0.010245212929197127, "entropy": 1.0020245351501413, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 47025.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 51431, "num_env_steps_trained": 51431, "num_agent_steps_sampled": 51431, "num_agent_steps_trained": 51431}, "sampler_results": {"episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -6.766937165471642, "episode_len_mean": 69.94, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715], "episode_lengths": [130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17898337667529732, "mean_inference_ms": 0.47186547988015237, "mean_action_processing_ms": 0.10681308135269972, "mean_env_wait_ms": 0.07520169698487542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.003075838088989258, "ViewRequirementAgentConnector_ms": 0.06018686294555664}}, "episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -6.766937165471642, "episode_len_mean": 69.94, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.7820817927586265, 9.268744991083457, 9.987606198131642, 9.932003974526339, -40.82877780647201, -40.0, 9.100995479321332, -41.674477553574526, 9.99398313925374, 7.321552257374958, -45.38185079487318, -40.074834093851535, -41.0400412106723, 9.880358123625069, 7.821408674368916, 9.74589434198757, 7.38984264961768, 7.701962134499953, 2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715], "episode_lengths": [130, 82, 21, 72, 34, 1, 136, 76, 13, 88, 111, 65, 83, 35, 89, 21, 39, 98, 50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17898337667529732, "mean_inference_ms": 0.47186547988015237, "mean_action_processing_ms": 0.10681308135269972, "mean_env_wait_ms": 0.07520169698487542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034885406494140625, "StateBufferConnector_ms": 0.003075838088989258, "ViewRequirementAgentConnector_ms": 0.06018686294555664}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51431, "num_agent_steps_trained": 51431, "num_env_steps_sampled": 51431, "num_env_steps_trained": 51431, "num_env_steps_sampled_this_iter": 1205, "num_env_steps_trained_this_iter": 1205, "timesteps_total": 51431, "num_steps_trained_this_iter": 1205, "agent_timesteps_total": 51431, "timers": {"training_iteration_time_ms": 5742.882, "load_time_ms": 1.649, "load_throughput": 726217.105, "learn_time_ms": 5490.005, "learn_throughput": 218.142, "synch_weights_time_ms": 2.425}, "counters": {"num_env_steps_sampled": 51431, "num_env_steps_trained": 51431, "num_agent_steps_sampled": 51431, "num_agent_steps_trained": 51431}, "done": false, "episodes_total": 897, "training_iteration": 42, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-49", "timestamp": 1678934089, "time_this_iter_s": 5.815576791763306, "time_total_s": 247.6727259159088, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce40d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce4130>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 247.6727259159088, "timesteps_since_restore": 0, "iterations_since_restore": 42, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.962499999999999, "ram_util_percent": 21.3, "gpu_util_percent0": 0.70875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 3.2874007058534684, "policy_loss": -0.0260106698765109, "vf_loss": 3.302355863409186, "vf_explained_var": -0.08288141577332109, "kl": 0.008465276995344483, "entropy": 0.984301592492395, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 48120.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 52598, "num_env_steps_trained": 52598, "num_agent_steps_sampled": 52598, "num_agent_steps_trained": 52598}, "sampler_results": {"episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.455970465832342, "episode_len_mean": 69.67, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625], "episode_lengths": [50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788513883860447, "mean_inference_ms": 0.47139693880694933, "mean_action_processing_ms": 0.10670639193938576, "mean_env_wait_ms": 0.07510387409143063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036106109619140625, "StateBufferConnector_ms": 0.0032210350036621094, "ViewRequirementAgentConnector_ms": 0.06094479560852051}}, "episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.455970465832342, "episode_len_mean": 69.67, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.6180206906677936, 9.961338187712851, -3.7835588041538344, 9.642261365540922, 9.338198270191668, 1.5061316310543411, 7.932739851128613, -40.01158977959252, 9.339280660286473, 9.941467780032678, 9.197981834122357, 9.964331933384084, -44.824575925670786, 8.850802029955057, 9.065770346881969, -5.183667535077467, 9.275323908190728, 9.990111961644159, -1.7602376431423803, -40.784701496341846, 8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625], "episode_lengths": [50, 19, 98, 128, 32, 132, 143, 11, 76, 45, 83, 38, 71, 139, 40, 87, 42, 41, 113, 75, 103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788513883860447, "mean_inference_ms": 0.47139693880694933, "mean_action_processing_ms": 0.10670639193938576, "mean_env_wait_ms": 0.07510387409143063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036106109619140625, "StateBufferConnector_ms": 0.0032210350036621094, "ViewRequirementAgentConnector_ms": 0.06094479560852051}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52598, "num_agent_steps_trained": 52598, "num_env_steps_sampled": 52598, "num_env_steps_trained": 52598, "num_env_steps_sampled_this_iter": 1167, "num_env_steps_trained_this_iter": 1167, "timesteps_total": 52598, "num_steps_trained_this_iter": 1167, "agent_timesteps_total": 52598, "timers": {"training_iteration_time_ms": 5695.924, "load_time_ms": 1.522, "load_throughput": 783179.43, "learn_time_ms": 5449.533, "learn_throughput": 218.716, "synch_weights_time_ms": 2.42}, "counters": {"num_env_steps_sampled": 52598, "num_env_steps_trained": 52598, "num_agent_steps_sampled": 52598, "num_agent_steps_trained": 52598}, "done": false, "episodes_total": 915, "training_iteration": 43, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-34-55", "timestamp": 1678934095, "time_this_iter_s": 5.566195487976074, "time_total_s": 253.2389214038849, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4550>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce44c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769cc9e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 253.2389214038849, "timesteps_since_restore": 0, "iterations_since_restore": 43, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.9, "ram_util_percent": 21.3, "gpu_util_percent0": 0.6174999999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 3.2739690314969736, "policy_loss": -0.08964415935937453, "vf_loss": 3.342179203795321, "vf_explained_var": -0.07446979930003485, "kl": 0.01619778706737837, "entropy": 0.8873565419404595, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 49200.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 53777, "num_env_steps_trained": 53777, "num_agent_steps_sampled": 53777, "num_agent_steps_trained": 53777}, "sampler_results": {"episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.258849416374545, "episode_len_mean": 66.83, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309], "episode_lengths": [103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17867112996370973, "mean_inference_ms": 0.4708336184871163, "mean_action_processing_ms": 0.10654220066937599, "mean_env_wait_ms": 0.07497960968543721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003599882125854492, "StateBufferConnector_ms": 0.003187417984008789, "ViewRequirementAgentConnector_ms": 0.06026458740234375}}, "episode_reward_max": 9.996737679313396, "episode_reward_min": -48.17943888798419, "episode_reward_mean": -5.258849416374545, "episode_len_mean": 66.83, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.138858686231536, 9.66101381199715, 8.174560193379618, -41.262190035653205, -41.325888475985835, -45.411090658405456, -42.248054695366974, 9.655750083591494, -40.63941094765961, -7.558692515229438, 9.996737679313396, 9.872681630291094, 7.526849650422612, 9.75092849714779, 9.995420080701942, 9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309], "episode_lengths": [103, 59, 135, 72, 81, 40, 126, 23, 27, 85, 5, 41, 105, 28, 7, 62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17867112996370973, "mean_inference_ms": 0.4708336184871163, "mean_action_processing_ms": 0.10654220066937599, "mean_env_wait_ms": 0.07497960968543721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003599882125854492, "StateBufferConnector_ms": 0.003187417984008789, "ViewRequirementAgentConnector_ms": 0.06026458740234375}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53777, "num_agent_steps_trained": 53777, "num_env_steps_sampled": 53777, "num_env_steps_trained": 53777, "num_env_steps_sampled_this_iter": 1179, "num_env_steps_trained_this_iter": 1179, "timesteps_total": 53777, "num_steps_trained_this_iter": 1179, "agent_timesteps_total": 53777, "timers": {"training_iteration_time_ms": 5722.085, "load_time_ms": 1.642, "load_throughput": 729801.589, "learn_time_ms": 5475.314, "learn_throughput": 218.892, "synch_weights_time_ms": 2.413}, "counters": {"num_env_steps_sampled": 53777, "num_env_steps_trained": 53777, "num_agent_steps_sampled": 53777, "num_agent_steps_trained": 53777}, "done": false, "episodes_total": 935, "training_iteration": 44, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-00", "timestamp": 1678934100, "time_this_iter_s": 5.5859599113464355, "time_total_s": 258.8248813152313, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d9b370>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2070>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 258.8248813152313, "timesteps_since_restore": 0, "iterations_since_restore": 44, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 16.04285714285714, "ram_util_percent": 21.32857142857143, "gpu_util_percent0": 0.7457142857142858, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3386631793775132, "cur_lr": 0.0002839118933253798, "total_loss": 4.980589381679022, "policy_loss": -0.027375946949970552, "vf_loss": 4.989086291480174, "vf_explained_var": 0.037944079220779546, "kl": 0.014309781773417638, "entropy": 0.9853706337329818, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 50355.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 55118, "num_env_steps_trained": 55118, "num_agent_steps_sampled": 55118, "num_agent_steps_trained": 55118}, "sampler_results": {"episode_reward_max": 9.99659577365799, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -5.15750604609064, "episode_len_mean": 70.87, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482], "episode_lengths": [62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17876198920704675, "mean_inference_ms": 0.4711339913871737, "mean_action_processing_ms": 0.10658045647845826, "mean_env_wait_ms": 0.07507861496754505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003635883331298828, "StateBufferConnector_ms": 0.0030841827392578125, "ViewRequirementAgentConnector_ms": 0.06070113182067871}}, "episode_reward_max": 9.99659577365799, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -5.15750604609064, "episode_len_mean": 70.87, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.782867880228062, 3.7810791114044386, -40.826743115884504, 8.387391785694334, 9.228781415898467, 9.575157567709187, -41.74364628185005, -41.27155136359931, 5.574248199751678, -41.72730740684259, 7.9620458005274575, -40.33715887907114, 0.5479725815477625, 9.883364750091198, 3.252391912011319, 7.208341848969345, 8.57558784325233, -40.04523545513279, 5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482], "episode_lengths": [62, 58, 71, 39, 46, 43, 59, 103, 53, 95, 128, 104, 122, 40, 99, 30, 35, 4, 51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17876198920704675, "mean_inference_ms": 0.4711339913871737, "mean_action_processing_ms": 0.10658045647845826, "mean_env_wait_ms": 0.07507861496754505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003635883331298828, "StateBufferConnector_ms": 0.0030841827392578125, "ViewRequirementAgentConnector_ms": 0.06070113182067871}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55118, "num_agent_steps_trained": 55118, "num_env_steps_sampled": 55118, "num_env_steps_trained": 55118, "num_env_steps_sampled_this_iter": 1341, "num_env_steps_trained_this_iter": 1341, "timesteps_total": 55118, "num_steps_trained_this_iter": 1341, "agent_timesteps_total": 55118, "timers": {"training_iteration_time_ms": 5803.133, "load_time_ms": 1.668, "load_throughput": 728969.723, "learn_time_ms": 5552.791, "learn_throughput": 218.953, "synch_weights_time_ms": 2.406}, "counters": {"num_env_steps_sampled": 55118, "num_env_steps_trained": 55118, "num_agent_steps_sampled": 55118, "num_agent_steps_trained": 55118}, "done": false, "episodes_total": 950, "training_iteration": 45, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-07", "timestamp": 1678934107, "time_this_iter_s": 6.324160814285278, "time_total_s": 265.1490421295166, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2400>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2a90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 265.1490421295166, "timesteps_since_restore": 0, "iterations_since_restore": 45, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.744444444444444, "ram_util_percent": 21.4, "gpu_util_percent0": 0.6988888888888889, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 3.2394238339982144, "policy_loss": -0.013044177995700585, "vf_loss": 3.2356645401354815, "vf_explained_var": -0.028157941866339298, "kl": 0.012744054479142581, "entropy": 0.9126933592191914, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 51540.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 56342, "num_env_steps_trained": 56342, "num_agent_steps_sampled": 56342, "num_agent_steps_trained": 56342}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -3.6787799133288086, "episode_len_mean": 71.2, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053], "episode_lengths": [51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17878401813632508, "mean_inference_ms": 0.4711337215431229, "mean_action_processing_ms": 0.10656436872340187, "mean_env_wait_ms": 0.07509181512320172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759622573852539, "StateBufferConnector_ms": 0.003208160400390625, "ViewRequirementAgentConnector_ms": 0.06189084053039551}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -3.6787799133288086, "episode_len_mean": 71.2, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [5.933131051240979, -48.17943888798419, 9.97562225598144, 5.213441597759475, -4.206125753170063, 8.541506712884047, -42.70721644402836, -4.550360939538431, 9.855972963437637, 9.99108145679716, -4.210811363196104, 5.122884813715705, 9.46948837564682, -41.120106623679014, 8.727946851764882, 9.875280405162519, -40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053], "episode_lengths": [51, 111, 18, 142, 126, 93, 113, 61, 9, 2, 54, 109, 115, 142, 134, 18, 37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17878401813632508, "mean_inference_ms": 0.4711337215431229, "mean_action_processing_ms": 0.10656436872340187, "mean_env_wait_ms": 0.07509181512320172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759622573852539, "StateBufferConnector_ms": 0.003208160400390625, "ViewRequirementAgentConnector_ms": 0.06189084053039551}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56342, "num_agent_steps_trained": 56342, "num_env_steps_sampled": 56342, "num_env_steps_trained": 56342, "num_env_steps_sampled_this_iter": 1224, "num_env_steps_trained_this_iter": 1224, "timesteps_total": 56342, "num_steps_trained_this_iter": 1224, "agent_timesteps_total": 56342, "timers": {"training_iteration_time_ms": 5865.685, "load_time_ms": 1.667, "load_throughput": 736239.638, "learn_time_ms": 5612.169, "learn_throughput": 218.65, "synch_weights_time_ms": 2.331}, "counters": {"num_env_steps_sampled": 56342, "num_env_steps_trained": 56342, "num_agent_steps_sampled": 56342, "num_agent_steps_trained": 56342}, "done": false, "episodes_total": 968, "training_iteration": 46, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-12", "timestamp": 1678934112, "time_this_iter_s": 5.960455417633057, "time_total_s": 271.10949754714966, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2b50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2be0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 271.10949754714966, "timesteps_since_restore": 0, "iterations_since_restore": 46, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.887500000000001, "ram_util_percent": 21.375, "gpu_util_percent0": 0.63, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 5.687539462712372, "policy_loss": -0.04548034830462365, "vf_loss": 5.720992920143264, "vf_explained_var": -0.02802697851544335, "kl": 0.009175078942924821, "entropy": 0.9089225679636002, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 52635.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 57490, "num_env_steps_trained": 57490, "num_agent_steps_sampled": 57490, "num_agent_steps_trained": 57490}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -4.065182240693731, "episode_len_mean": 69.7, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107], "episode_lengths": [37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1787827481553964, "mean_inference_ms": 0.47091240662648737, "mean_action_processing_ms": 0.10650307715131714, "mean_env_wait_ms": 0.07508837240209668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.0031321048736572266, "ViewRequirementAgentConnector_ms": 0.061986684799194336}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -4.065182240693731, "episode_len_mean": 69.7, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.1411860969852, -40.384804243378774, 4.466140192100289, -45.326364810241905, -41.18629427862084, 9.96359580947893, -41.17260807129651, 6.456284517431074, 7.010257288737977, 2.4861796795250584, 9.92615021358256, 9.797666877188227, 4.3420271591185715, 3.304829842649453, -40.01314508326436, 3.7047274803992813, 9.99659577365799, -2.720445702136102, 7.244288958627569, 2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107], "episode_lengths": [37, 35, 116, 79, 131, 4, 37, 127, 130, 131, 10, 16, 58, 68, 25, 149, 16, 71, 151, 79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1787827481553964, "mean_inference_ms": 0.47091240662648737, "mean_action_processing_ms": 0.10650307715131714, "mean_env_wait_ms": 0.07508837240209668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036923885345458984, "StateBufferConnector_ms": 0.0031321048736572266, "ViewRequirementAgentConnector_ms": 0.061986684799194336}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57490, "num_agent_steps_trained": 57490, "num_env_steps_sampled": 57490, "num_env_steps_trained": 57490, "num_env_steps_sampled_this_iter": 1148, "num_env_steps_trained_this_iter": 1148, "timesteps_total": 57490, "num_steps_trained_this_iter": 1148, "agent_timesteps_total": 57490, "timers": {"training_iteration_time_ms": 5872.087, "load_time_ms": 1.781, "load_throughput": 690195.526, "learn_time_ms": 5618.135, "learn_throughput": 218.738, "synch_weights_time_ms": 3.406}, "counters": {"num_env_steps_sampled": 57490, "num_env_steps_trained": 57490, "num_agent_steps_sampled": 57490, "num_agent_steps_trained": 57490}, "done": false, "episodes_total": 984, "training_iteration": 47, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-18", "timestamp": 1678934118, "time_this_iter_s": 5.516849994659424, "time_total_s": 276.6263475418091, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2550>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2610>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 276.6263475418091, "timesteps_since_restore": 0, "iterations_since_restore": 47, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.9625, "ram_util_percent": 21.4, "gpu_util_percent0": 0.71375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.338663179377513, "cur_lr": 0.0002839118933253797, "total_loss": 4.653635693611871, "policy_loss": -0.07499896904772467, "vf_loss": 4.722542657899494, "vf_explained_var": 0.007530126593134425, "kl": 0.004723331992516276, "entropy": 0.8217080901603441, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 53715.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 58682, "num_env_steps_trained": 58682, "num_agent_steps_sampled": 58682, "num_agent_steps_trained": 58682}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.7218746667326374, "episode_len_mean": 67.71, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887], "episode_lengths": [79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17882142970324724, "mean_inference_ms": 0.4711299421207555, "mean_action_processing_ms": 0.10650228051804625, "mean_env_wait_ms": 0.07511071259578216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.003153085708618164, "ViewRequirementAgentConnector_ms": 0.06254982948303223}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.7218746667326374, "episode_len_mean": 67.71, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.561091771911318, 7.336079925340982, 9.995148177967618, 9.986988593400515, 9.481387120057333, 9.04017501287171, 9.593425871918809, 9.928796145705734, 9.05047905111367, 9.970305720023797, -40.00803186877707, -40.429574530432625, 6.325295833687446, -3.2073083861470195, -40.536937189288054, 9.911429679756155, -46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887], "episode_lengths": [79, 139, 20, 4, 94, 126, 20, 6, 126, 25, 14, 34, 145, 69, 103, 60, 81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17882142970324724, "mean_inference_ms": 0.4711299421207555, "mean_action_processing_ms": 0.10650228051804625, "mean_env_wait_ms": 0.07511071259578216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.003153085708618164, "ViewRequirementAgentConnector_ms": 0.06254982948303223}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58682, "num_agent_steps_trained": 58682, "num_env_steps_sampled": 58682, "num_env_steps_trained": 58682, "num_env_steps_sampled_this_iter": 1192, "num_env_steps_trained_this_iter": 1192, "timesteps_total": 58682, "num_steps_trained_this_iter": 1192, "agent_timesteps_total": 58682, "timers": {"training_iteration_time_ms": 5850.445, "load_time_ms": 1.72, "load_throughput": 711387.824, "learn_time_ms": 5593.859, "learn_throughput": 218.704, "synch_weights_time_ms": 3.402}, "counters": {"num_env_steps_sampled": 58682, "num_env_steps_trained": 58682, "num_agent_steps_sampled": 58682, "num_agent_steps_trained": 58682}, "done": false, "episodes_total": 1003, "training_iteration": 48, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-24", "timestamp": 1678934124, "time_this_iter_s": 5.754518032073975, "time_total_s": 282.38086557388306, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2760>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce23a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 282.38086557388306, "timesteps_since_restore": 0, "iterations_since_restore": 48, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.0, "ram_util_percent": 21.357142857142858, "gpu_util_percent0": 0.7542857142857142, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6693315896887565, "cur_lr": 0.0002839118933253797, "total_loss": 4.214024434186209, "policy_loss": -0.08734758596932679, "vf_loss": 4.286073966477099, "vf_explained_var": -0.08725734473320476, "kl": 0.023188195500245815, "entropy": 0.7918373010137625, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 54840.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 59906, "num_env_steps_trained": 59906, "num_agent_steps_sampled": 59906, "num_agent_steps_trained": 59906}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.9993016471031353, "episode_len_mean": 69.31, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753], "episode_lengths": [81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1789224198066873, "mean_inference_ms": 0.47177796479669004, "mean_action_processing_ms": 0.10667943807786823, "mean_env_wait_ms": 0.0752352703518019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003362894058227539, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.062230587005615234}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.9993016471031353, "episode_len_mean": 69.31, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-46.2948766689434, -40.605104755523726, 9.285199087490414, 9.781826388453045, 8.409672922178741, 9.505144236371398, 9.738595709556105, 8.942342933639821, 9.86380575462332, 8.04555549570461, 9.461563474335872, 9.88642552152611, 9.8989198818994, 9.682035397957236, 9.946266686990175, -8.05231779167309, 6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753], "episode_lengths": [81, 37, 44, 19, 107, 70, 88, 24, 14, 27, 67, 35, 24, 56, 16, 93, 112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1789224198066873, "mean_inference_ms": 0.47177796479669004, "mean_action_processing_ms": 0.10667943807786823, "mean_env_wait_ms": 0.0752352703518019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003362894058227539, "StateBufferConnector_ms": 0.0029647350311279297, "ViewRequirementAgentConnector_ms": 0.062230587005615234}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59906, "num_agent_steps_trained": 59906, "num_env_steps_sampled": 59906, "num_env_steps_trained": 59906, "num_env_steps_sampled_this_iter": 1224, "num_env_steps_trained_this_iter": 1224, "timesteps_total": 59906, "num_steps_trained_this_iter": 1224, "agent_timesteps_total": 59906, "timers": {"training_iteration_time_ms": 5845.496, "load_time_ms": 1.8, "load_throughput": 677541.843, "learn_time_ms": 5587.86, "learn_throughput": 218.259, "synch_weights_time_ms": 3.444}, "counters": {"num_env_steps_sampled": 59906, "num_env_steps_trained": 59906, "num_agent_steps_sampled": 59906, "num_agent_steps_trained": 59906}, "done": false, "episodes_total": 1019, "training_iteration": 49, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-30", "timestamp": 1678934130, "time_this_iter_s": 6.026095628738403, "time_total_s": 288.40696120262146, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2220>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769bf8dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 288.40696120262146, "timesteps_since_restore": 0, "iterations_since_restore": 49, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.422222222222224, "ram_util_percent": 21.333333333333336, "gpu_util_percent0": 0.6922222222222222, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.003997384533135, "cur_lr": 0.00028391189332537973, "total_loss": 2.8434119623639464, "policy_loss": -0.09748795981518925, "vf_loss": 2.914250869787453, "vf_explained_var": -0.2818673980732759, "kl": 0.02677433436713425, "entropy": 0.8265456653386355, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 56010.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 61211, "num_env_steps_trained": 61211, "num_agent_steps_sampled": 61211, "num_agent_steps_trained": 61211}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.633403431620662, "episode_len_mean": 74.34, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305], "episode_lengths": [112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17891171972607672, "mean_inference_ms": 0.472125490288217, "mean_action_processing_ms": 0.10681574721837954, "mean_env_wait_ms": 0.07526820285469285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033631324768066406, "StateBufferConnector_ms": 0.0029938220977783203, "ViewRequirementAgentConnector_ms": 0.06264853477478027}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -52.336108441782024, "episode_reward_mean": -1.633403431620662, "episode_len_mean": 74.34, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.9981924703370915, 9.655976421562832, 8.52203538746902, -49.1577734990001, 4.600269538415587, 1.0940652705958733, -4.077853073721958, 9.10949468745477, 9.78069846155584, -40.79655158943996, -52.336108441782024, 0.4641545738078712, -40.002804670368214, 9.937561522069089, 0.6704529542108482, 9.979592308628938, 6.562945029446254, 9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305], "episode_lengths": [112, 26, 165, 64, 172, 85, 106, 131, 88, 33, 132, 77, 18, 30, 102, 2, 156, 46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17891171972607672, "mean_inference_ms": 0.472125490288217, "mean_action_processing_ms": 0.10681574721837954, "mean_env_wait_ms": 0.07526820285469285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033631324768066406, "StateBufferConnector_ms": 0.0029938220977783203, "ViewRequirementAgentConnector_ms": 0.06264853477478027}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61211, "num_agent_steps_trained": 61211, "num_env_steps_sampled": 61211, "num_env_steps_trained": 61211, "num_env_steps_sampled_this_iter": 1305, "num_env_steps_trained_this_iter": 1305, "timesteps_total": 61211, "num_steps_trained_this_iter": 1305, "agent_timesteps_total": 61211, "timers": {"training_iteration_time_ms": 5852.599, "load_time_ms": 1.716, "load_throughput": 710941.464, "learn_time_ms": 5591.839, "learn_throughput": 218.121, "synch_weights_time_ms": 3.489}, "counters": {"num_env_steps_sampled": 61211, "num_env_steps_trained": 61211, "num_agent_steps_sampled": 61211, "num_agent_steps_trained": 61211}, "done": false, "episodes_total": 1035, "training_iteration": 50, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-36", "timestamp": 1678934136, "time_this_iter_s": 6.263747453689575, "time_total_s": 294.67070865631104, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2f10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2fa0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 294.67070865631104, "timesteps_since_restore": 0, "iterations_since_restore": 50, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.85, "ram_util_percent": 21.4, "gpu_util_percent0": 0.7324999999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997023, "cur_lr": 0.0002839118933253797, "total_loss": 3.728359829497317, "policy_loss": -0.09491936250502228, "vf_loss": 3.794294916225486, "vf_explained_var": -0.3190422280731364, "kl": 0.019394030778637238, "entropy": 0.7936080844229103, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 62459, "num_env_steps_trained": 62459, "num_agent_steps_sampled": 62459, "num_agent_steps_trained": 62459}, "sampler_results": {"episode_reward_max": 9.998964904461033, "episode_reward_min": -42.37370711892385, "episode_reward_mean": -1.119718197447699, "episode_len_mean": 71.83, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457], "episode_lengths": [46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17893959792119524, "mean_inference_ms": 0.4724895097531707, "mean_action_processing_ms": 0.10692097869437762, "mean_env_wait_ms": 0.0753090962516818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033774375915527344, "StateBufferConnector_ms": 0.0030221939086914062, "ViewRequirementAgentConnector_ms": 0.0625307559967041}}, "episode_reward_max": 9.998964904461033, "episode_reward_min": -42.37370711892385, "episode_reward_mean": -1.119718197447699, "episode_len_mean": 71.83, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.596842395405972, 7.696467302020604, -40.57765203021199, 9.582855127597208, 4.306643293777725, 9.859184211112051, 9.998964904461033, 9.707570699122181, 9.143713387863816, -40.24502473296688, 8.068305807479385, 1.4860625098763052, -40.02531133183237, 0.8618444567048087, 1.5279507274473119, 8.149247404956053, -42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457], "episode_lengths": [46, 122, 37, 97, 35, 56, 8, 71, 120, 83, 92, 82, 14, 60, 82, 61, 97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17893959792119524, "mean_inference_ms": 0.4724895097531707, "mean_action_processing_ms": 0.10692097869437762, "mean_env_wait_ms": 0.0753090962516818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033774375915527344, "StateBufferConnector_ms": 0.0030221939086914062, "ViewRequirementAgentConnector_ms": 0.0625307559967041}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62459, "num_agent_steps_trained": 62459, "num_env_steps_sampled": 62459, "num_env_steps_trained": 62459, "num_env_steps_sampled_this_iter": 1248, "num_env_steps_trained_this_iter": 1248, "timesteps_total": 62459, "num_steps_trained_this_iter": 1248, "agent_timesteps_total": 62459, "timers": {"training_iteration_time_ms": 5874.315, "load_time_ms": 2.798, "load_throughput": 437282.001, "learn_time_ms": 5611.251, "learn_throughput": 218.008, "synch_weights_time_ms": 3.488}, "counters": {"num_env_steps_sampled": 62459, "num_env_steps_trained": 62459, "num_agent_steps_sampled": 62459, "num_agent_steps_trained": 62459}, "done": false, "episodes_total": 1052, "training_iteration": 51, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-42", "timestamp": 1678934142, "time_this_iter_s": 5.992069244384766, "time_total_s": 300.6627779006958, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc400>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdca90>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769eb0d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 300.6627779006958, "timesteps_since_restore": 0, "iterations_since_restore": 51, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.825, "ram_util_percent": 21.4, "gpu_util_percent0": 0.6925000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 5.343604976731442, "policy_loss": -0.058174074552299684, "vf_loss": 5.380974801095497, "vf_explained_var": -0.23551244751403205, "kl": 0.01397149937841741, "entropy": 0.8423937111700835, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 58350.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 63693, "num_env_steps_trained": 63693, "num_agent_steps_sampled": 63693, "num_agent_steps_trained": 63693}, "sampler_results": {"episode_reward_max": 9.984015133613523, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -1.8859089433248526, "episode_len_mean": 73.51, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754], "episode_lengths": [97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788199555762347, "mean_inference_ms": 0.47253694855907225, "mean_action_processing_ms": 0.10698278497871483, "mean_env_wait_ms": 0.07527367821953826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033311843872070312, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.06166219711303711}}, "episode_reward_max": 9.984015133613523, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -1.8859089433248526, "episode_len_mean": 73.51, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-42.37370711892385, 9.735414078940991, 9.797972730124753, -40.237278152707624, -40.00309703549694, 9.56464133121398, 1.1549794116681724, 5.263684170446104, 9.840612006066577, 0.364339574382857, 3.3542318724440516, -0.5120644263155807, 5.437485317915486, 1.1413847765498932, -40.534536070880705, 7.098001270874107, 7.55833253758638, 1.099905433013209, 1.9375032619210657, 6.665780120097854, 9.913985823167502, 8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754], "episode_lengths": [97, 23, 34, 15, 9, 40, 79, 129, 21, 130, 67, 131, 97, 114, 47, 115, 76, 88, 41, 63, 37, 86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1788199555762347, "mean_inference_ms": 0.47253694855907225, "mean_action_processing_ms": 0.10698278497871483, "mean_env_wait_ms": 0.07527367821953826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033311843872070312, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.06166219711303711}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63693, "num_agent_steps_trained": 63693, "num_env_steps_sampled": 63693, "num_env_steps_trained": 63693, "num_env_steps_sampled_this_iter": 1234, "num_env_steps_trained_this_iter": 1234, "timesteps_total": 63693, "num_steps_trained_this_iter": 1234, "agent_timesteps_total": 63693, "timers": {"training_iteration_time_ms": 5876.814, "load_time_ms": 2.753, "load_throughput": 445336.321, "learn_time_ms": 5618.276, "learn_throughput": 218.252, "synch_weights_time_ms": 3.479}, "counters": {"num_env_steps_sampled": 63693, "num_env_steps_trained": 63693, "num_agent_steps_sampled": 63693, "num_agent_steps_trained": 63693}, "done": false, "episodes_total": 1068, "training_iteration": 52, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-48", "timestamp": 1678934148, "time_this_iter_s": 5.840386390686035, "time_total_s": 306.50316429138184, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2af0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2bb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f4cca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 306.50316429138184, "timesteps_since_restore": 0, "iterations_since_restore": 52, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.850000000000001, "ram_util_percent": 21.4, "gpu_util_percent0": 0.77375, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997023, "cur_lr": 0.0002839118933253797, "total_loss": 3.774095605696655, "policy_loss": -0.0919399560601623, "vf_loss": 3.8489946197463993, "vf_explained_var": -0.04545164654652278, "kl": 0.01147388713772537, "entropy": 0.8491975840043139, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 59460.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 64869, "num_env_steps_trained": 64869, "num_agent_steps_sampled": 64869, "num_agent_steps_trained": 64869}, "sampler_results": {"episode_reward_max": 9.991308302469454, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -2.4595661693797553, "episode_len_mean": 70.74, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454], "episode_lengths": [86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.178909765219067, "mean_inference_ms": 0.4729752863116128, "mean_action_processing_ms": 0.10702847505121887, "mean_env_wait_ms": 0.07539166301417546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033724308013916016, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06167483329772949}}, "episode_reward_max": 9.991308302469454, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -2.4595661693797553, "episode_len_mean": 70.74, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.886037498148612, 3.5182324378452563, 5.786092096577475, 8.836745507802757, 3.8040535118587346, 3.326428076241039, 8.353425780568466, 4.570807357173558, -40.41156877903097, 7.490654247835865, 9.979388631718829, 0.7908041127801191, 0.09857992872304244, 9.879465318653887, 7.518934148405437, 9.959455452386022, 9.762014293190937, 9.977380526985149, -41.14333289017092, 0.03676815391501442, 7.880503453773676, 9.637621328444116, -5.063105377242449, -2.328809751038813, 7.113727782365507, 7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454], "episode_lengths": [86, 75, 33, 78, 96, 35, 56, 30, 72, 111, 5, 80, 110, 20, 126, 30, 44, 18, 117, 60, 92, 44, 95, 109, 82, 144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.178909765219067, "mean_inference_ms": 0.4729752863116128, "mean_action_processing_ms": 0.10702847505121887, "mean_env_wait_ms": 0.07539166301417546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033724308013916016, "StateBufferConnector_ms": 0.0029027462005615234, "ViewRequirementAgentConnector_ms": 0.06167483329772949}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64869, "num_agent_steps_trained": 64869, "num_env_steps_sampled": 64869, "num_env_steps_trained": 64869, "num_env_steps_sampled_this_iter": 1176, "num_env_steps_trained_this_iter": 1176, "timesteps_total": 64869, "num_steps_trained_this_iter": 1176, "agent_timesteps_total": 64869, "timers": {"training_iteration_time_ms": 5876.022, "load_time_ms": 2.884, "load_throughput": 425526.691, "learn_time_ms": 5618.993, "learn_throughput": 218.384, "synch_weights_time_ms": 3.448}, "counters": {"num_env_steps_sampled": 64869, "num_env_steps_trained": 64869, "num_agent_steps_sampled": 64869, "num_agent_steps_trained": 64869}, "done": false, "episodes_total": 1089, "training_iteration": 53, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-35-54", "timestamp": 1678934154, "time_this_iter_s": 5.55847430229187, "time_total_s": 312.0616385936737, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2d90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2850>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 312.0616385936737, "timesteps_since_restore": 0, "iterations_since_restore": 53, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.850000000000001, "ram_util_percent": 21.4, "gpu_util_percent0": 0.65875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997023, "cur_lr": 0.00028391189332537973, "total_loss": 2.101656272854554, "policy_loss": -0.05745513207758918, "vf_loss": 2.144087512363595, "vf_explained_var": -0.33227744138602056, "kl": 0.010130952203458457, "entropy": 0.8300251191764166, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 60660.5, "diff_num_grad_updates_vs_sampler_policy": 659.5}}, "num_env_steps_sampled": 66294, "num_env_steps_trained": 66294, "num_agent_steps_sampled": 66294, "num_agent_steps_trained": 66294}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -1.3192084927628471, "episode_len_mean": 67.95, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272], "episode_lengths": [144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17858396536711368, "mean_inference_ms": 0.47204487685842395, "mean_action_processing_ms": 0.10683769975465054, "mean_env_wait_ms": 0.0751789103420798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033354759216308594, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.05978965759277344}}, "episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -1.3192084927628471, "episode_len_mean": 67.95, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.994155971844005, 8.493333985410434, -40.09611490882974, -41.289663233270566, 2.803183955892753, 5.113548669780885, 8.617287540237278, 3.8110725963636067, 9.56187808182862, 9.106847179396148, 8.519091719665692, 0.37376516625092115, 9.21572942269399, -2.8373970666888138, 7.903757594736172, 9.876761692738254, 6.216838026645208, 9.984015133613523, 9.714228522195981, 9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272], "episode_lengths": [144, 35, 37, 60, 131, 74, 22, 134, 63, 135, 58, 124, 44, 108, 133, 56, 151, 11, 22, 93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17858396536711368, "mean_inference_ms": 0.47204487685842395, "mean_action_processing_ms": 0.10683769975465054, "mean_env_wait_ms": 0.0751789103420798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033354759216308594, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.05978965759277344}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66294, "num_agent_steps_trained": 66294, "num_env_steps_sampled": 66294, "num_env_steps_trained": 66294, "num_env_steps_sampled_this_iter": 1425, "num_env_steps_trained_this_iter": 1425, "timesteps_total": 66294, "num_steps_trained_this_iter": 1425, "agent_timesteps_total": 66294, "timers": {"training_iteration_time_ms": 6005.704, "load_time_ms": 2.778, "load_throughput": 450598.249, "learn_time_ms": 5745.881, "learn_throughput": 217.843, "synch_weights_time_ms": 3.45}, "counters": {"num_env_steps_sampled": 66294, "num_env_steps_trained": 66294, "num_agent_steps_sampled": 66294, "num_agent_steps_trained": 66294}, "done": false, "episodes_total": 1114, "training_iteration": 54, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-01", "timestamp": 1678934161, "time_this_iter_s": 6.883037805557251, "time_total_s": 318.94467639923096, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cce9d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce7580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769c71b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 318.94467639923096, "timesteps_since_restore": 0, "iterations_since_restore": 54, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.52222222222222, "ram_util_percent": 21.4, "gpu_util_percent0": 0.6977777777777777, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.505996076799702, "cur_lr": 0.00028391189332537973, "total_loss": 5.459504850590601, "policy_loss": -0.04722433318694433, "vf_loss": 5.495641881236806, "vf_explained_var": -0.28474495629469554, "kl": 0.007527267863918807, "entropy": 0.884928803841273, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 67598, "num_env_steps_trained": 67598, "num_agent_steps_sampled": 67598, "num_agent_steps_trained": 67598}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -3.5416482324552536, "episode_len_mean": 65.57, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913], "episode_lengths": [93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17847848894091858, "mean_inference_ms": 0.4723283259823014, "mean_action_processing_ms": 0.10689338967524954, "mean_env_wait_ms": 0.0751943073157957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034606456756591797, "StateBufferConnector_ms": 0.002917766571044922, "ViewRequirementAgentConnector_ms": 0.060538530349731445}}, "episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -3.5416482324552536, "episode_len_mean": 65.57, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.436107488819166, -40.528655945443305, 9.981974679200885, 1.120300852087496, 9.9361131029976, 9.878795396994374, 7.834372177663072, 9.499219205532938, 9.261944198558089, 9.6998990764117, -40.250143497213166, 8.092801014638049, 9.031588438493616, -40.47347984623867, 0.9912454599671072, 9.905213480760644, -40.059743215154036, -41.67420740437812, 9.596977648216457, 9.722133503590216, 8.465956935372478, 9.94063526394492, -2.184041501733482, 7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913], "episode_lengths": [93, 77, 3, 106, 15, 46, 100, 49, 142, 105, 84, 134, 86, 45, 84, 15, 27, 106, 101, 23, 107, 32, 63, 60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17847848894091858, "mean_inference_ms": 0.4723283259823014, "mean_action_processing_ms": 0.10689338967524954, "mean_env_wait_ms": 0.0751943073157957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034606456756591797, "StateBufferConnector_ms": 0.002917766571044922, "ViewRequirementAgentConnector_ms": 0.060538530349731445}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67598, "num_agent_steps_trained": 67598, "num_env_steps_sampled": 67598, "num_env_steps_trained": 67598, "num_env_steps_sampled_this_iter": 1304, "num_env_steps_trained_this_iter": 1304, "timesteps_total": 67598, "num_steps_trained_this_iter": 1304, "agent_timesteps_total": 67598, "timers": {"training_iteration_time_ms": 5990.919, "load_time_ms": 2.619, "load_throughput": 476595.077, "learn_time_ms": 5732.094, "learn_throughput": 217.721, "synch_weights_time_ms": 3.426}, "counters": {"num_env_steps_sampled": 67598, "num_env_steps_trained": 67598, "num_agent_steps_sampled": 67598, "num_agent_steps_trained": 67598}, "done": false, "episodes_total": 1133, "training_iteration": 55, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-07", "timestamp": 1678934167, "time_this_iter_s": 6.176256418228149, "time_total_s": 325.1209328174591, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4c40>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce40d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ca3430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 325.1209328174591, "timesteps_since_restore": 0, "iterations_since_restore": 55, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.777777777777779, "ram_util_percent": 21.42222222222222, "gpu_util_percent0": 0.7166666666666667, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 2.427192739788275, "policy_loss": -0.0380480558796039, "vf_loss": 2.4531626589898323, "vf_explained_var": -0.141162813300485, "kl": 0.008173729771313969, "entropy": 0.8235557553601695, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 63075.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 68796, "num_env_steps_trained": 68796, "num_agent_steps_sampled": 68796, "num_agent_steps_trained": 68796}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -2.386749710119464, "episode_len_mean": 61.12, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195], "episode_lengths": [60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17852844052703346, "mean_inference_ms": 0.4731960941696303, "mean_action_processing_ms": 0.10709035388528985, "mean_env_wait_ms": 0.07530980545868567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.00293731689453125, "ViewRequirementAgentConnector_ms": 0.061385154724121094}}, "episode_reward_max": 10.0, "episode_reward_min": -44.442383116943574, "episode_reward_mean": -2.386749710119464, "episode_len_mean": 61.12, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.0644532183892075, 5.8128531278775375, 9.281991136555957, -44.442383116943574, -40.307929342478104, -0.03961120250257011, -7.369376011703544, 6.464199270403508, -41.73489794598798, 8.931795046525652, -40.88086808507327, 3.7936792488609754, 9.20309709780529, 5.695184320672582, -41.41317419139952, -42.83918260570984, 8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195], "episode_lengths": [60, 42, 88, 46, 42, 116, 87, 92, 139, 71, 104, 122, 88, 41, 122, 45, 76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17852844052703346, "mean_inference_ms": 0.4731960941696303, "mean_action_processing_ms": 0.10709035388528985, "mean_env_wait_ms": 0.07530980545868567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003504514694213867, "StateBufferConnector_ms": 0.00293731689453125, "ViewRequirementAgentConnector_ms": 0.061385154724121094}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68796, "num_agent_steps_trained": 68796, "num_env_steps_sampled": 68796, "num_env_steps_trained": 68796, "num_env_steps_sampled_this_iter": 1198, "num_env_steps_trained_this_iter": 1198, "timesteps_total": 68796, "num_steps_trained_this_iter": 1198, "agent_timesteps_total": 68796, "timers": {"training_iteration_time_ms": 5969.228, "load_time_ms": 2.618, "load_throughput": 475684.461, "learn_time_ms": 5709.289, "learn_throughput": 218.136, "synch_weights_time_ms": 3.446}, "counters": {"num_env_steps_sampled": 68796, "num_env_steps_trained": 68796, "num_agent_steps_sampled": 68796, "num_agent_steps_trained": 68796}, "done": false, "episodes_total": 1156, "training_iteration": 56, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-13", "timestamp": 1678934173, "time_this_iter_s": 5.744575262069702, "time_total_s": 330.8655080795288, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769dc5100>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce20a0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769c71b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 330.8655080795288, "timesteps_since_restore": 0, "iterations_since_restore": 56, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.171428571428573, "ram_util_percent": 21.400000000000002, "gpu_util_percent0": 0.7871428571428571, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997023, "cur_lr": 0.0002839118933253798, "total_loss": 3.4570130576553746, "policy_loss": -0.04591398694650914, "vf_loss": 3.4899261661419057, "vf_explained_var": -0.22394067078101926, "kl": 0.008798345899571354, "entropy": 0.8873797960034231, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 64245.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 70120, "num_env_steps_trained": 70120, "num_agent_steps_sampled": 70120, "num_agent_steps_trained": 70120}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.18283217709941, "episode_reward_mean": -0.6253883031797447, "episode_len_mean": 61.31, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236], "episode_lengths": [76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.178486659802215, "mean_inference_ms": 0.47316338134262226, "mean_action_processing_ms": 0.10701251661849216, "mean_env_wait_ms": 0.07525614507130314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003566741943359375, "StateBufferConnector_ms": 0.002965688705444336, "ViewRequirementAgentConnector_ms": 0.06185293197631836}}, "episode_reward_max": 10.0, "episode_reward_min": -44.18283217709941, "episode_reward_mean": -0.6253883031797447, "episode_len_mean": 61.31, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.927614673339598, -40.001171496079664, 8.79765375034178, 9.388039944592794, 8.711781725503503, 9.89296356122097, 9.839202441093706, -40.80750734705031, 1.6027461892916879, 9.62330112646824, -40.03741478313358, -2.109579112613927, 8.286358231781174, 9.837561632155671, 6.816766344579697, -40.50370149873139, 9.991308302469454, 9.99951315865549, 4.024184676218429, 9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236], "episode_lengths": [76, 7, 99, 18, 105, 19, 34, 34, 56, 69, 36, 109, 43, 10, 121, 25, 19, 4, 64, 22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.178486659802215, "mean_inference_ms": 0.47316338134262226, "mean_action_processing_ms": 0.10701251661849216, "mean_env_wait_ms": 0.07525614507130314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003566741943359375, "StateBufferConnector_ms": 0.002965688705444336, "ViewRequirementAgentConnector_ms": 0.06185293197631836}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70120, "num_agent_steps_trained": 70120, "num_env_steps_sampled": 70120, "num_env_steps_trained": 70120, "num_env_steps_sampled_this_iter": 1324, "num_env_steps_trained_this_iter": 1324, "timesteps_total": 70120, "num_steps_trained_this_iter": 1324, "agent_timesteps_total": 70120, "timers": {"training_iteration_time_ms": 6048.419, "load_time_ms": 2.551, "load_throughput": 495043.029, "learn_time_ms": 5784.674, "learn_throughput": 218.336, "synch_weights_time_ms": 2.367}, "counters": {"num_env_steps_sampled": 70120, "num_env_steps_trained": 70120, "num_agent_steps_sampled": 70120, "num_agent_steps_trained": 70120}, "done": false, "episodes_total": 1172, "training_iteration": 57, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-19", "timestamp": 1678934179, "time_this_iter_s": 6.30821418762207, "time_total_s": 337.1737222671509, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4e80>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce4ee0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 337.1737222671509, "timesteps_since_restore": 0, "iterations_since_restore": 57, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.711111111111112, "ram_util_percent": 21.4, "gpu_util_percent0": 0.7811111111111111, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997023, "cur_lr": 0.00028391189332537973, "total_loss": 1.4280852241697901, "policy_loss": 0.0038072613089583643, "vf_loss": 1.4061603720252973, "vf_explained_var": -0.015362246276796327, "kl": 0.012197594484444057, "entropy": 0.896360263852186, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 65505.5, "diff_num_grad_updates_vs_sampler_policy": 644.5}}, "num_env_steps_sampled": 71515, "num_env_steps_trained": 71515, "num_agent_steps_sampled": 71515, "num_agent_steps_trained": 71515}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.6104895380364723, "episode_len_mean": 65.78, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239], "episode_lengths": [22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17844951267704975, "mean_inference_ms": 0.47346207422433473, "mean_action_processing_ms": 0.10709553069029289, "mean_env_wait_ms": 0.07524479878130266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034682750701904297, "StateBufferConnector_ms": 0.0028846263885498047, "ViewRequirementAgentConnector_ms": 0.06119728088378906}}, "episode_reward_max": 10.0, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.6104895380364723, "episode_len_mean": 65.78, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.877893246644549, 9.958007670388172, 10.0, 9.861090283697704, 9.946313981647267, 8.831630684144189, 9.929488372678335, 8.246894417347393, 9.442740208424595, 7.865839881467717, 5.260198502002751, -41.93513167208577, 8.346594276953608, 9.777791145432237, 9.31423047477243, 9.84226721628815, 7.572794289662475, 3.932392604309065, 5.478784388471664, 9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239], "episode_lengths": [22, 10, 1, 21, 13, 40, 18, 127, 90, 91, 69, 111, 44, 11, 126, 44, 82, 69, 121, 28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17844951267704975, "mean_inference_ms": 0.47346207422433473, "mean_action_processing_ms": 0.10709553069029289, "mean_env_wait_ms": 0.07524479878130266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034682750701904297, "StateBufferConnector_ms": 0.0028846263885498047, "ViewRequirementAgentConnector_ms": 0.06119728088378906}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71515, "num_agent_steps_trained": 71515, "num_env_steps_sampled": 71515, "num_env_steps_trained": 71515, "num_env_steps_sampled_this_iter": 1395, "num_env_steps_trained_this_iter": 1395, "timesteps_total": 71515, "num_steps_trained_this_iter": 1395, "agent_timesteps_total": 71515, "timers": {"training_iteration_time_ms": 6141.412, "load_time_ms": 2.628, "load_throughput": 488377.081, "learn_time_ms": 5876.947, "learn_throughput": 218.362, "synch_weights_time_ms": 2.368}, "counters": {"num_env_steps_sampled": 71515, "num_env_steps_trained": 71515, "num_agent_steps_sampled": 71515, "num_agent_steps_trained": 71515}, "done": false, "episodes_total": 1191, "training_iteration": 58, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-26", "timestamp": 1678934186, "time_this_iter_s": 6.684583425521851, "time_total_s": 343.85830569267273, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4dc0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce4e50>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769bd4280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 343.85830569267273, "timesteps_since_restore": 0, "iterations_since_restore": 58, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.811111111111112, "ram_util_percent": 21.4, "gpu_util_percent0": 0.7355555555555555, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 2.1037993406962703, "policy_loss": -0.044579675859003735, "vf_loss": 2.134609072509614, "vf_explained_var": -0.04170008547473372, "kl": 0.009309720012791812, "entropy": 0.8911174214461394, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 72748, "num_env_steps_trained": 72748, "num_agent_steps_sampled": 72748, "num_agent_steps_trained": 72748}, "sampler_results": {"episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": -0.2792443486177234, "episode_len_mean": 67.01, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659], "episode_lengths": [28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1785213345141403, "mean_inference_ms": 0.4736773393823895, "mean_action_processing_ms": 0.10717984166844867, "mean_env_wait_ms": 0.07528674695555415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.00295257568359375, "ViewRequirementAgentConnector_ms": 0.06230759620666504}}, "episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": -0.2792443486177234, "episode_len_mean": 67.01, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.861270270890879, 9.891513577102433, 9.932666737001151, 7.037102117486272, 9.478377293112862, 9.455329359964463, 9.173662618613836, 9.974634987415039, -42.613502157549966, -40.902356244225075, -1.6179080080512236, -40.98581795681401, 8.706786221042666, 7.058460638341307, 8.563529734247348, 7.171097574792477, -40.62652896292102, 9.634213690087858, 9.971378154843208, -40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659], "episode_lengths": [28, 46, 43, 130, 57, 75, 131, 12, 118, 26, 116, 92, 29, 68, 72, 39, 90, 22, 26, 106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1785213345141403, "mean_inference_ms": 0.4736773393823895, "mean_action_processing_ms": 0.10717984166844867, "mean_env_wait_ms": 0.07528674695555415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003522634506225586, "StateBufferConnector_ms": 0.00295257568359375, "ViewRequirementAgentConnector_ms": 0.06230759620666504}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72748, "num_agent_steps_trained": 72748, "num_env_steps_sampled": 72748, "num_env_steps_trained": 72748, "num_env_steps_sampled_this_iter": 1233, "num_env_steps_trained_this_iter": 1233, "timesteps_total": 72748, "num_steps_trained_this_iter": 1233, "agent_timesteps_total": 72748, "timers": {"training_iteration_time_ms": 6139.953, "load_time_ms": 2.749, "load_throughput": 467181.744, "learn_time_ms": 5874.066, "learn_throughput": 218.622, "synch_weights_time_ms": 2.335}, "counters": {"num_env_steps_sampled": 72748, "num_env_steps_trained": 72748, "num_agent_steps_sampled": 72748, "num_agent_steps_trained": 72748}, "done": false, "episodes_total": 1210, "training_iteration": 59, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-32", "timestamp": 1678934192, "time_this_iter_s": 6.012450933456421, "time_total_s": 349.87075662612915, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce47c0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2ac0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769c71b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 349.87075662612915, "timesteps_since_restore": 0, "iterations_since_restore": 59, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.825, "ram_util_percent": 21.412499999999998, "gpu_util_percent0": 0.6975, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.952240268228039, "episode_reward_min": -43.77655376849985, "episode_reward_mean": -27.502010477679686, "episode_len_mean": 38.266666666666666, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-43.77655376849985, -40.0102115295315, -40.001870106442105, -40.08044803977401, -40.96506157396854, 7.865581381258978, -40.793516414203125, 9.952240268228039, 9.714959803691757, -40.00679383025092, -41.15678418633684, 7.210654667222614, -40.000688260154675, -40.358424237210315, -40.123241339224826], "episode_lengths": [81, 8, 8, 41, 50, 36, 40, 15, 41, 13, 68, 140, 3, 19, 11]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15506248543482634, "mean_inference_ms": 0.4296605150801198, "mean_action_processing_ms": 0.09717037358022249, "mean_env_wait_ms": 0.07061870009810836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028594334920247397, "StateBufferConnector_ms": 0.0038671493530273438, "ViewRequirementAgentConnector_ms": 0.05527178446451823}, "num_agent_steps_sampled_this_iter": 574, "num_env_steps_sampled_this_iter": 574, "timesteps_this_iter": 574, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.505996076799702, "cur_lr": 0.00028391189332537973, "total_loss": 2.364109721207836, "policy_loss": -0.058107538581825796, "vf_loss": 2.402894834402638, "vf_explained_var": 0.08882701968153318, "kl": 0.012990488135100502, "entropy": 0.858183694506685, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 67890.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 74038, "num_env_steps_trained": 74038, "num_agent_steps_sampled": 74038, "num_agent_steps_trained": 74038}, "sampler_results": {"episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.7216103665128064, "episode_len_mean": 67.71, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817], "episode_lengths": [106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17859568571998477, "mean_inference_ms": 0.474060716144251, "mean_action_processing_ms": 0.10724128854952031, "mean_env_wait_ms": 0.07533997240486529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467082977294922, "StateBufferConnector_ms": 0.0030281543731689453, "ViewRequirementAgentConnector_ms": 0.062468528747558594}}, "episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.7216103665128064, "episode_len_mean": 67.71, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.13709365549579, -40.00483631035218, -40.608198756312056, 9.147117860523913, 9.965874122618365, 9.743917813537088, 9.923006469865125, 8.613433526613461, 9.861087402378782, 9.944554011861767, -0.7596207113164315, 8.930956475495947, 9.44394302348212, 9.631549950217867, 9.874121812278139, 8.803759547667141, 9.908810908721449, 9.0186358527176, -40.45516751734658, -40.35233459655624, 9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817], "episode_lengths": [106, 24, 112, 89, 13, 54, 10, 131, 10, 8, 57, 36, 32, 24, 89, 97, 72, 72, 33, 72, 13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17859568571998477, "mean_inference_ms": 0.474060716144251, "mean_action_processing_ms": 0.10724128854952031, "mean_env_wait_ms": 0.07533997240486529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467082977294922, "StateBufferConnector_ms": 0.0030281543731689453, "ViewRequirementAgentConnector_ms": 0.062468528747558594}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74038, "num_agent_steps_trained": 74038, "num_env_steps_sampled": 74038, "num_env_steps_trained": 74038, "num_env_steps_sampled_this_iter": 1290, "num_env_steps_trained_this_iter": 1290, "timesteps_total": 74038, "num_steps_trained_this_iter": 1290, "agent_timesteps_total": 74038, "timers": {"training_iteration_time_ms": 6114.152, "load_time_ms": 2.873, "load_throughput": 446449.894, "learn_time_ms": 5850.449, "learn_throughput": 219.248, "synch_weights_time_ms": 3.411}, "counters": {"num_env_steps_sampled": 74038, "num_env_steps_trained": 74038, "num_agent_steps_sampled": 74038, "num_agent_steps_trained": 74038}, "done": false, "episodes_total": 1229, "training_iteration": 60, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-38", "timestamp": 1678934198, "time_this_iter_s": 6.34916353225708, "time_total_s": 356.21992015838623, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce4610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce46d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769c18b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 356.21992015838623, "timesteps_since_restore": 0, "iterations_since_restore": 60, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.955555555555557, "ram_util_percent": 21.4, "gpu_util_percent0": 0.6655555555555556, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 3.6658948121688892, "policy_loss": -0.0808415635077803, "vf_loss": 3.7355572405829185, "vf_explained_var": -0.09172518049274479, "kl": 0.007579231848911411, "entropy": 0.8366501703455641, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 69045.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 75223, "num_env_steps_trained": 75223, "num_agent_steps_sampled": 75223, "num_agent_steps_trained": 75223}, "sampler_results": {"episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.18013518132891584, "episode_len_mean": 68.15, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568], "episode_lengths": [13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17854123323673604, "mean_inference_ms": 0.4738676398258546, "mean_action_processing_ms": 0.10711173749718914, "mean_env_wait_ms": 0.07526839569249649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003316640853881836, "StateBufferConnector_ms": 0.0030410289764404297, "ViewRequirementAgentConnector_ms": 0.06131482124328613}}, "episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.18013518132891584, "episode_len_mean": 68.15, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.881840777269828, 7.032590269639638, 9.833048122287702, 9.066069126772215, -41.059149678013405, 9.555057562792229, 6.308874473683195, -40.59185570561334, 9.644110571674343, 9.87466394896325, 6.39266955091742, 8.20257593872024, 1.9756725397964914, 9.824167121252337, 9.750612898542016, 2.2479966176885284, 7.970503377594896, -40.091875198221665, 8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568], "episode_lengths": [13, 60, 10, 49, 53, 32, 171, 121, 41, 22, 117, 138, 96, 89, 35, 75, 92, 49, 30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17854123323673604, "mean_inference_ms": 0.4738676398258546, "mean_action_processing_ms": 0.10711173749718914, "mean_env_wait_ms": 0.07526839569249649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003316640853881836, "StateBufferConnector_ms": 0.0030410289764404297, "ViewRequirementAgentConnector_ms": 0.06131482124328613}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75223, "num_agent_steps_trained": 75223, "num_env_steps_sampled": 75223, "num_env_steps_trained": 75223, "num_env_steps_sampled_this_iter": 1185, "num_env_steps_trained_this_iter": 1185, "timesteps_total": 75223, "num_steps_trained_this_iter": 1185, "agent_timesteps_total": 75223, "timers": {"training_iteration_time_ms": 6069.364, "load_time_ms": 1.733, "load_throughput": 736488.647, "learn_time_ms": 5810.137, "learn_throughput": 219.685, "synch_weights_time_ms": 3.426}, "counters": {"num_env_steps_sampled": 75223, "num_env_steps_trained": 75223, "num_agent_steps_sampled": 75223, "num_agent_steps_trained": 75223}, "done": false, "episodes_total": 1249, "training_iteration": 61, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-44", "timestamp": 1678934204, "time_this_iter_s": 5.544118881225586, "time_total_s": 361.7640390396118, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc6d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdcd30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769bd4c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 361.7640390396118, "timesteps_since_restore": 0, "iterations_since_restore": 61, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.05, "ram_util_percent": 21.4, "gpu_util_percent0": 0.6875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 2.561098404642881, "policy_loss": -0.07141433071279735, "vf_loss": 2.6240999735277066, "vf_explained_var": 0.07206990624728955, "kl": 0.0057510194582008935, "entropy": 0.8832668160660225, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 70170.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 76442, "num_env_steps_trained": 76442, "num_agent_steps_sampled": 76442, "num_agent_steps_trained": 76442}, "sampler_results": {"episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.8768820004130727, "episode_len_mean": 67.71, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793], "episode_lengths": [30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17853874515860593, "mean_inference_ms": 0.4737851199294145, "mean_action_processing_ms": 0.10711741416563797, "mean_env_wait_ms": 0.07526925805995731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032401084899902344, "StateBufferConnector_ms": 0.0031468868255615234, "ViewRequirementAgentConnector_ms": 0.0608372688293457}}, "episode_reward_max": 9.998141450660299, "episode_reward_min": -44.18283217709941, "episode_reward_mean": 0.8768820004130727, "episode_len_mean": 67.71, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.342565261010982, 6.354103540993418, -44.18283217709941, 9.47053685953954, 8.172355513505236, -40.12620299364854, 9.113822306323334, 8.043817853952845, 9.395885492414163, 9.802218116869778, 9.506337149424045, 9.59666606834517, 9.282792377795083, 7.637457588812957, 9.971695044899896, 9.054174733117854, 9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793], "episode_lengths": [30, 82, 63, 134, 140, 30, 86, 124, 53, 121, 21, 127, 40, 134, 20, 120, 55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17853874515860593, "mean_inference_ms": 0.4737851199294145, "mean_action_processing_ms": 0.10711741416563797, "mean_env_wait_ms": 0.07526925805995731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032401084899902344, "StateBufferConnector_ms": 0.0031468868255615234, "ViewRequirementAgentConnector_ms": 0.0608372688293457}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76442, "num_agent_steps_trained": 76442, "num_env_steps_sampled": 76442, "num_env_steps_trained": 76442, "num_env_steps_sampled_this_iter": 1219, "num_env_steps_trained_this_iter": 1219, "timesteps_total": 76442, "num_steps_trained_this_iter": 1219, "agent_timesteps_total": 76442, "timers": {"training_iteration_time_ms": 6073.421, "load_time_ms": 1.66, "load_throughput": 768028.003, "learn_time_ms": 5815.611, "learn_throughput": 219.22, "synch_weights_time_ms": 3.412}, "counters": {"num_env_steps_sampled": 76442, "num_env_steps_trained": 76442, "num_agent_steps_sampled": 76442, "num_agent_steps_trained": 76442}, "done": false, "episodes_total": 1267, "training_iteration": 62, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-49", "timestamp": 1678934209, "time_this_iter_s": 5.881383419036865, "time_total_s": 367.6454224586487, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce2bb0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce2c10>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 367.6454224586487, "timesteps_since_restore": 0, "iterations_since_restore": 62, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.774999999999999, "ram_util_percent": 21.4, "gpu_util_percent0": 0.7350000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5059960767997025, "cur_lr": 0.0002839118933253797, "total_loss": 2.4565521017127474, "policy_loss": -0.11370061626821233, "vf_loss": 2.5633381439731333, "vf_explained_var": 0.1040365608637793, "kl": 0.004756832050615988, "entropy": 0.8866249980895142, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 71310.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 77662, "num_env_steps_trained": 77662, "num_agent_steps_sampled": 77662, "num_agent_steps_trained": 77662}, "sampler_results": {"episode_reward_max": 9.998141450660299, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 0.4437650812747452, "episode_len_mean": 66.66, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327], "episode_lengths": [55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1784936214857055, "mean_inference_ms": 0.4736032851711961, "mean_action_processing_ms": 0.10708935035526658, "mean_env_wait_ms": 0.0752448592664921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031707286834716797, "StateBufferConnector_ms": 0.0032167434692382812, "ViewRequirementAgentConnector_ms": 0.06075787544250488}}, "episode_reward_max": 9.998141450660299, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 0.4437650812747452, "episode_len_mean": 66.66, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.907785550231097, 9.683991575811818, 9.993066693863815, 9.975315258535149, 9.866005107379339, 9.62765680126536, -41.965471546915374, 7.500392463247239, 9.472577926825846, 9.727167536408194, 8.901593645509713, 9.994876606626823, 8.761497269183128, 9.417653126102294, 9.998141450660299, 9.977320574027875, 7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327], "episode_lengths": [55, 122, 4, 12, 10, 64, 84, 168, 24, 81, 74, 29, 71, 74, 9, 38, 128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1784936214857055, "mean_inference_ms": 0.4736032851711961, "mean_action_processing_ms": 0.10708935035526658, "mean_env_wait_ms": 0.0752448592664921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031707286834716797, "StateBufferConnector_ms": 0.0032167434692382812, "ViewRequirementAgentConnector_ms": 0.06075787544250488}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77662, "num_agent_steps_trained": 77662, "num_env_steps_sampled": 77662, "num_env_steps_trained": 77662, "num_env_steps_sampled_this_iter": 1220, "num_env_steps_trained_this_iter": 1220, "timesteps_total": 77662, "num_steps_trained_this_iter": 1220, "agent_timesteps_total": 77662, "timers": {"training_iteration_time_ms": 6016.275, "load_time_ms": 1.592, "load_throughput": 803331.603, "learn_time_ms": 5756.483, "learn_throughput": 222.236, "synch_weights_time_ms": 3.424}, "counters": {"num_env_steps_sampled": 77662, "num_env_steps_trained": 77662, "num_agent_steps_sampled": 77662, "num_agent_steps_trained": 77662}, "done": false, "episodes_total": 1283, "training_iteration": 63, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-36-54", "timestamp": 1678934214, "time_this_iter_s": 4.986770391464233, "time_total_s": 372.6321928501129, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769de85e0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769de8970>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fcef70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 372.6321928501129, "timesteps_since_restore": 0, "iterations_since_restore": 63, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 19.849999999999998, "ram_util_percent": 15.716666666666663, "gpu_util_percent0": 0.345, "vram_util_percent0": 0.0194091796875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7529980383998512, "cur_lr": 0.0002839118933253797, "total_loss": 2.1621074460242595, "policy_loss": -0.054291596747281255, "vf_loss": 2.2102529970540976, "vf_explained_var": 0.08198459467344117, "kl": 0.008491877695632883, "entropy": 0.8835476945889623, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 72450.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 78904, "num_env_steps_trained": 78904, "num_agent_steps_sampled": 78904, "num_agent_steps_trained": 78904}, "sampler_results": {"episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": -0.09817259457397132, "episode_len_mean": 69.89, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247], "episode_lengths": [128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17865096720902635, "mean_inference_ms": 0.4738748477591471, "mean_action_processing_ms": 0.10713501402662765, "mean_env_wait_ms": 0.07539874458509055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032050609588623047, "StateBufferConnector_ms": 0.003143787384033203, "ViewRequirementAgentConnector_ms": 0.060590267181396484}}, "episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": -0.09817259457397132, "episode_len_mean": 69.89, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.710353681334638, 6.390938148760263, -41.05392922180613, 9.86002807125898, 9.827569231390124, 8.98820556684499, -40.27848620147744, 9.978397214867819, -44.11110116958633, 9.822629485702201, 9.190998364193659, 9.103577887473117, 1.3839578836701403, 9.655132325119725, 8.968104281102425, 9.987783929689598, -40.06881395628336, 9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247], "episode_lengths": [128, 121, 79, 25, 24, 81, 49, 98, 74, 36, 118, 30, 111, 19, 121, 38, 109, 96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17865096720902635, "mean_inference_ms": 0.4738748477591471, "mean_action_processing_ms": 0.10713501402662765, "mean_env_wait_ms": 0.07539874458509055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032050609588623047, "StateBufferConnector_ms": 0.003143787384033203, "ViewRequirementAgentConnector_ms": 0.060590267181396484}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78904, "num_agent_steps_trained": 78904, "num_env_steps_sampled": 78904, "num_env_steps_trained": 78904, "num_env_steps_sampled_this_iter": 1242, "num_env_steps_trained_this_iter": 1242, "timesteps_total": 78904, "num_steps_trained_this_iter": 1242, "agent_timesteps_total": 78904, "timers": {"training_iteration_time_ms": 5968.398, "load_time_ms": 1.582, "load_throughput": 797163.041, "learn_time_ms": 5708.631, "learn_throughput": 220.894, "synch_weights_time_ms": 3.442}, "counters": {"num_env_steps_sampled": 78904, "num_env_steps_trained": 78904, "num_agent_steps_sampled": 78904, "num_agent_steps_trained": 78904}, "done": false, "episodes_total": 1299, "training_iteration": 64, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-01", "timestamp": 1678934221, "time_this_iter_s": 6.404911994934082, "time_total_s": 379.037104845047, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cda610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdacd0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 379.037104845047, "timesteps_since_restore": 0, "iterations_since_restore": 64, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 36.83333333333333, "ram_util_percent": 17.200000000000003, "gpu_util_percent0": 0.19777777777777775, "vram_util_percent0": 0.021369086371527776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7529980383998512, "cur_lr": 0.0002839118933253797, "total_loss": 0.8364906645490249, "policy_loss": -0.026787751416365305, "vf_loss": 0.8404213163558508, "vf_explained_var": 0.49225443612065234, "kl": 0.030667357963434304, "entropy": 0.8373744432079164, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 73590.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 80129, "num_env_steps_trained": 80129, "num_agent_steps_sampled": 80129, "num_agent_steps_trained": 80129}, "sampler_results": {"episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 1.0504399647738287, "episode_len_mean": 69.53, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244], "episode_lengths": [96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17880425752461535, "mean_inference_ms": 0.47439118086359444, "mean_action_processing_ms": 0.10727540066613878, "mean_env_wait_ms": 0.07552877579481322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003363370895385742, "StateBufferConnector_ms": 0.0032711029052734375, "ViewRequirementAgentConnector_ms": 0.06245827674865723}}, "episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 1.0504399647738287, "episode_len_mean": 69.53, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.625787846183348, 6.745579815787917, 6.489752423707495, 9.990250475909338, 8.552944201536073, 9.320290657229137, -40.50294560092244, 8.061902492572258, 9.236722199771306, 6.164870353483545, 9.62768558511157, 7.733495207901505, 9.173303149390817, -41.258054791961705, -42.36113052142318, 9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244], "episode_lengths": [96, 95, 36, 4, 51, 102, 51, 55, 62, 56, 60, 122, 72, 76, 122, 75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17880425752461535, "mean_inference_ms": 0.47439118086359444, "mean_action_processing_ms": 0.10727540066613878, "mean_env_wait_ms": 0.07552877579481322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003363370895385742, "StateBufferConnector_ms": 0.0032711029052734375, "ViewRequirementAgentConnector_ms": 0.06245827674865723}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80129, "num_agent_steps_trained": 80129, "num_env_steps_sampled": 80129, "num_env_steps_trained": 80129, "num_env_steps_sampled_this_iter": 1225, "num_env_steps_trained_this_iter": 1225, "timesteps_total": 80129, "num_steps_trained_this_iter": 1225, "agent_timesteps_total": 80129, "timers": {"training_iteration_time_ms": 5953.69, "load_time_ms": 1.84, "load_throughput": 681069.617, "learn_time_ms": 5686.055, "learn_throughput": 220.381, "synch_weights_time_ms": 3.477}, "counters": {"num_env_steps_sampled": 80129, "num_env_steps_trained": 80129, "num_agent_steps_sampled": 80129, "num_agent_steps_trained": 80129}, "done": false, "episodes_total": 1316, "training_iteration": 65, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-09", "timestamp": 1678934229, "time_this_iter_s": 6.0290961265563965, "time_total_s": 385.0662009716034, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f7edf0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f7eca0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fcef70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 385.0662009716034, "timesteps_since_restore": 0, "iterations_since_restore": 65, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.172727272727274, "ram_util_percent": 21.209090909090914, "gpu_util_percent0": 0.5281818181818182, "vram_util_percent0": 0.032964533025568184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997765, "cur_lr": 0.00028391189332537973, "total_loss": 1.313921769784065, "policy_loss": -0.055156739351805296, "vf_loss": 1.3550682842193056, "vf_explained_var": 0.19680498272180558, "kl": 0.012607998942548874, "entropy": 0.8200107124944528, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 74760.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 81410, "num_env_steps_trained": 81410, "num_agent_steps_sampled": 81410, "num_agent_steps_trained": 81410}, "sampler_results": {"episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 1.6919782208916054, "episode_len_mean": 71.74, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344], "episode_lengths": [75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17880686803212867, "mean_inference_ms": 0.47443667900813197, "mean_action_processing_ms": 0.10736048500065491, "mean_env_wait_ms": 0.07554295594044276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033888816833496094, "StateBufferConnector_ms": 0.0031747817993164062, "ViewRequirementAgentConnector_ms": 0.06190323829650879}}, "episode_reward_max": 9.998278187619187, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 1.6919782208916054, "episode_len_mean": 71.74, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.049756523410478, 6.994243485969026, 3.3130570367328778, -41.44020932237637, 9.875854026993077, 9.671367202250687, 9.835365177444057, 9.983232370466247, 9.990741316481744, -42.41324461447174, 9.344277361527645, 8.159082061401069, -40.32394744767184, 9.898175692525296, 8.349224625151646, 9.836587483585802, -40.0, 9.841621046175568, 9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344], "episode_lengths": [75, 113, 60, 86, 37, 129, 55, 24, 6, 47, 53, 63, 35, 52, 77, 30, 1, 44, 25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17880686803212867, "mean_inference_ms": 0.47443667900813197, "mean_action_processing_ms": 0.10736048500065491, "mean_env_wait_ms": 0.07554295594044276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033888816833496094, "StateBufferConnector_ms": 0.0031747817993164062, "ViewRequirementAgentConnector_ms": 0.06190323829650879}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81410, "num_agent_steps_trained": 81410, "num_env_steps_sampled": 81410, "num_env_steps_trained": 81410, "num_env_steps_sampled_this_iter": 1281, "num_env_steps_trained_this_iter": 1281, "timesteps_total": 81410, "num_steps_trained_this_iter": 1281, "agent_timesteps_total": 81410, "timers": {"training_iteration_time_ms": 5998.332, "load_time_ms": 1.846, "load_throughput": 683216.905, "learn_time_ms": 5735.631, "learn_throughput": 219.924, "synch_weights_time_ms": 3.47}, "counters": {"num_env_steps_sampled": 81410, "num_env_steps_trained": 81410, "num_agent_steps_sampled": 81410, "num_agent_steps_trained": 81410}, "done": false, "episodes_total": 1331, "training_iteration": 66, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-15", "timestamp": 1678934235, "time_this_iter_s": 6.190331935882568, "time_total_s": 391.25653290748596, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cda370>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cda430>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 391.25653290748596, "timesteps_since_restore": 0, "iterations_since_restore": 66, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.822222222222223, "ram_util_percent": 21.322222222222223, "gpu_util_percent0": 0.7433333333333335, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997763, "cur_lr": 0.0002839118933253797, "total_loss": 1.2078425723645423, "policy_loss": -0.04566620536084868, "vf_loss": 1.2395505708166692, "vf_explained_var": 0.3841137007260934, "kl": 0.012560776814233328, "entropy": 0.8152874605523215, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 75945.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 82688, "num_env_steps_trained": 82688, "num_agent_steps_sampled": 82688, "num_agent_steps_trained": 82688}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 2.818901063652828, "episode_len_mean": 74.65, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499], "episode_lengths": [25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17911727016441342, "mean_inference_ms": 0.47535384554659665, "mean_action_processing_ms": 0.10758984873359821, "mean_env_wait_ms": 0.07573582616080365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0033347606658935547, "ViewRequirementAgentConnector_ms": 0.06622982025146484}}, "episode_reward_max": 10.0, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 2.818901063652828, "episode_len_mean": 74.65, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.675167258742567, -41.567635494739356, 9.88265983215903, 9.716858467516452, -40.06536586125275, 9.811871903487058, 3.579378652943296, 9.963871002292409, 7.556351182267055, 9.907647272329692, 9.806817358684631, 9.606217535071252, 8.228494942389988, 9.9251723137775, 9.995915661005142, 9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499], "episode_lengths": [25, 107, 63, 47, 126, 118, 78, 4, 150, 22, 33, 138, 78, 52, 2, 17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17911727016441342, "mean_inference_ms": 0.47535384554659665, "mean_action_processing_ms": 0.10758984873359821, "mean_env_wait_ms": 0.07573582616080365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003668546676635742, "StateBufferConnector_ms": 0.0033347606658935547, "ViewRequirementAgentConnector_ms": 0.06622982025146484}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82688, "num_agent_steps_trained": 82688, "num_env_steps_sampled": 82688, "num_env_steps_trained": 82688, "num_env_steps_sampled_this_iter": 1278, "num_env_steps_trained_this_iter": 1278, "timesteps_total": 82688, "num_steps_trained_this_iter": 1278, "agent_timesteps_total": 82688, "timers": {"training_iteration_time_ms": 5979.138, "load_time_ms": 1.793, "load_throughput": 700881.688, "learn_time_ms": 5707.896, "learn_throughput": 220.186, "synch_weights_time_ms": 3.478}, "counters": {"num_env_steps_sampled": 82688, "num_env_steps_trained": 82688, "num_agent_steps_sampled": 82688, "num_agent_steps_trained": 82688}, "done": false, "episodes_total": 1349, "training_iteration": 67, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-22", "timestamp": 1678934242, "time_this_iter_s": 6.116523742675781, "time_total_s": 397.37305665016174, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f3b430>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce7a60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769fcef70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 397.37305665016174, "timesteps_since_restore": 0, "iterations_since_restore": 67, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.625, "ram_util_percent": 21.3125, "gpu_util_percent0": 0.7500000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997765, "cur_lr": 0.00028391189332537973, "total_loss": 1.6892949415215601, "policy_loss": -0.022474779716382422, "vf_loss": 1.6894734280310029, "vf_explained_var": 0.41952279676993687, "kl": 0.019938576663359235, "entropy": 0.7979475630074739, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 77130.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 83984, "num_env_steps_trained": 83984, "num_agent_steps_sampled": 83984, "num_agent_steps_trained": 83984}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 3.1887296673879018, "episode_len_mean": 77.18, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345], "episode_lengths": [17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17929322637146317, "mean_inference_ms": 0.4758543343840726, "mean_action_processing_ms": 0.10773828350771017, "mean_env_wait_ms": 0.07582724218828817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036797523498535156, "StateBufferConnector_ms": 0.0031871795654296875, "ViewRequirementAgentConnector_ms": 0.06600308418273926}}, "episode_reward_max": 10.0, "episode_reward_min": -44.92880314401335, "episode_reward_mean": 3.1887296673879018, "episode_len_mean": 77.18, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.929489437797882, 9.994766596047961, 9.544576163641793, 9.50348084087353, 9.647834013018496, 8.856502207225272, 9.990033897604208, 9.993471178404679, 9.703953451891264, 9.948275470826529, 9.2084417749901, -43.6215243619374, 9.245417381244215, 9.520272390593941, 9.922236644874106, 9.345814168525088, -44.92880314401335, 9.984550890496164, -40.19625598219327, 9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345], "episode_lengths": [17, 16, 143, 97, 116, 78, 31, 30, 128, 9, 74, 154, 27, 121, 67, 85, 57, 54, 92, 40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17929322637146317, "mean_inference_ms": 0.4758543343840726, "mean_action_processing_ms": 0.10773828350771017, "mean_env_wait_ms": 0.07582724218828817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036797523498535156, "StateBufferConnector_ms": 0.0031871795654296875, "ViewRequirementAgentConnector_ms": 0.06600308418273926}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83984, "num_agent_steps_trained": 83984, "num_env_steps_sampled": 83984, "num_env_steps_trained": 83984, "num_env_steps_sampled_this_iter": 1296, "num_env_steps_trained_this_iter": 1296, "timesteps_total": 83984, "num_steps_trained_this_iter": 1296, "agent_timesteps_total": 83984, "timers": {"training_iteration_time_ms": 5926.65, "load_time_ms": 1.909, "load_throughput": 653000.082, "learn_time_ms": 5657.22, "learn_throughput": 220.409, "synch_weights_time_ms": 3.511}, "counters": {"num_env_steps_sampled": 83984, "num_env_steps_trained": 83984, "num_agent_steps_sampled": 83984, "num_agent_steps_trained": 83984}, "done": false, "episodes_total": 1364, "training_iteration": 68, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-28", "timestamp": 1678934248, "time_this_iter_s": 6.159036636352539, "time_total_s": 403.5320932865143, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e9c970>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e9c790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769ea2d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 403.5320932865143, "timesteps_since_restore": 0, "iterations_since_restore": 68, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 14.850000000000001, "ram_util_percent": 21.35, "gpu_util_percent0": 0.74875, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997765, "cur_lr": 0.0002839118933253798, "total_loss": 1.2978609145367215, "policy_loss": -0.031807056820489524, "vf_loss": 1.308978511255596, "vf_explained_var": 0.2750439936068, "kl": 0.018519550903020144, "entropy": 0.8123149002470621, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 78345.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 85297, "num_env_steps_trained": 85297, "num_agent_steps_sampled": 85297, "num_agent_steps_trained": 85297}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.71089503119694, "episode_reward_mean": 3.197987922787176, "episode_len_mean": 76.35, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345, 9.727431970466617, -40.300997860690934, 9.65124043973658, 9.993148419632062, 7.268834127621683, 8.346562623201866, 9.256024054133611, 9.820413747366763, 9.425647345016156, 9.973728119175286, 9.99650079982806, 8.192360584227025, -41.71089503119694, -40.11774703227213, 8.132993859213613, 9.971534447575198, 9.448614673861043, 9.965437501712803, 9.477525771230262], "episode_lengths": [40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179, 98, 25, 17, 33, 99, 122, 137, 13, 50, 74, 7, 147, 68, 61, 124, 66, 77, 21, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17945232868183936, "mean_inference_ms": 0.4764900023008333, "mean_action_processing_ms": 0.10783134647195922, "mean_env_wait_ms": 0.07589711265526543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003632783889770508, "StateBufferConnector_ms": 0.003214120864868164, "ViewRequirementAgentConnector_ms": 0.06569194793701172}}, "episode_reward_max": 10.0, "episode_reward_min": -41.71089503119694, "episode_reward_mean": 3.197987922787176, "episode_len_mean": 76.35, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.65709430334081, -41.25783100579285, 9.921441776981172, 9.973706488011056, 6.387752299181791, 7.523345133558615, -40.99321863368574, 8.904164256733793, 9.784522637666742, 9.793383235373694, 9.717581196905394, 9.998278187619187, 9.981577044441934, 9.740778523129501, 9.73637812031065, 7.776848890115247, 9.963283858854325, 9.386746499493949, 9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345, 9.727431970466617, -40.300997860690934, 9.65124043973658, 9.993148419632062, 7.268834127621683, 8.346562623201866, 9.256024054133611, 9.820413747366763, 9.425647345016156, 9.973728119175286, 9.99650079982806, 8.192360584227025, -41.71089503119694, -40.11774703227213, 8.132993859213613, 9.971534447575198, 9.448614673861043, 9.965437501712803, 9.477525771230262], "episode_lengths": [40, 141, 62, 54, 62, 137, 51, 137, 21, 64, 150, 5, 20, 145, 21, 132, 22, 86, 16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179, 98, 25, 17, 33, 99, 122, 137, 13, 50, 74, 7, 147, 68, 61, 124, 66, 77, 21, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17945232868183936, "mean_inference_ms": 0.4764900023008333, "mean_action_processing_ms": 0.10783134647195922, "mean_env_wait_ms": 0.07589711265526543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003632783889770508, "StateBufferConnector_ms": 0.003214120864868164, "ViewRequirementAgentConnector_ms": 0.06569194793701172}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 85297, "num_agent_steps_trained": 85297, "num_env_steps_sampled": 85297, "num_env_steps_trained": 85297, "num_env_steps_sampled_this_iter": 1313, "num_env_steps_trained_this_iter": 1313, "timesteps_total": 85297, "num_steps_trained_this_iter": 1313, "agent_timesteps_total": 85297, "timers": {"training_iteration_time_ms": 5976.656, "load_time_ms": 1.792, "load_throughput": 700362.206, "learn_time_ms": 5707.09, "learn_throughput": 219.884, "synch_weights_time_ms": 3.493}, "counters": {"num_env_steps_sampled": 85297, "num_env_steps_trained": 85297, "num_agent_steps_sampled": 85297, "num_agent_steps_trained": 85297}, "done": false, "episodes_total": 1383, "training_iteration": 69, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-34", "timestamp": 1678934254, "time_this_iter_s": 6.512421369552612, "time_total_s": 410.0445146560669, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769d4fc70>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769d4f0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769c1e5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 410.0445146560669, "timesteps_since_restore": 0, "iterations_since_restore": 69, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.799999999999999, "ram_util_percent": 21.42222222222222, "gpu_util_percent0": 0.6988888888888888, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997765, "cur_lr": 0.00028391189332537973, "total_loss": 0.49297195745201666, "policy_loss": -0.01844080204351081, "vf_loss": 0.5054350757632743, "vf_explained_var": 0.1959478558313967, "kl": 0.00547806215485382, "entropy": 0.7463339155972606, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 79455.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 86364, "num_env_steps_trained": 86364, "num_agent_steps_sampled": 86364, "num_agent_steps_trained": 86364}, "sampler_results": {"episode_reward_max": 10.0, "episode_reward_min": -41.71089503119694, "episode_reward_mean": 3.667319197094956, "episode_len_mean": 73.52, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345, 9.727431970466617, -40.300997860690934, 9.65124043973658, 9.993148419632062, 7.268834127621683, 8.346562623201866, 9.256024054133611, 9.820413747366763, 9.425647345016156, 9.973728119175286, 9.99650079982806, 8.192360584227025, -41.71089503119694, -40.11774703227213, 8.132993859213613, 9.971534447575198, 9.448614673861043, 9.965437501712803, 9.477525771230262, 9.900653961321666, 6.742045083692393, 9.86062383903707, 9.953457395501797, 6.5957975907907445, -40.00034903392618, 9.855926900363215, 9.600022609913662, 9.8047532788742, 9.974465777081228, 8.405019074420776, 9.99629508002862, 7.325372705703278, 9.937524464276379, 9.938584307125371, 6.323283876555273, 9.29412636160868, 9.42135697064902], "episode_lengths": [16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179, 98, 25, 17, 33, 99, 122, 137, 13, 50, 74, 7, 147, 68, 61, 124, 66, 77, 21, 74, 38, 129, 58, 55, 113, 5, 50, 130, 76, 36, 44, 4, 115, 5, 42, 51, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17952444954351335, "mean_inference_ms": 0.4770046328299243, "mean_action_processing_ms": 0.10793344860154747, "mean_env_wait_ms": 0.07591309334240576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036318302154541016, "StateBufferConnector_ms": 0.003348827362060547, "ViewRequirementAgentConnector_ms": 0.06533265113830566}}, "episode_reward_max": 10.0, "episode_reward_min": -41.71089503119694, "episode_reward_mean": 3.667319197094956, "episode_len_mean": 73.52, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.94880408789541, 9.18853925978504, -40.001638546971535, 8.561475801105647, 9.432964951469183, 9.632690861453778, -40.64096121285075, 8.179032218877445, 8.74241432434064, 9.522824587639041, 9.759304127742864, 9.45118352772085, 9.943354787324601, 9.318657855979714, 9.827924467174244, 9.84152582746382, 9.525352915526115, 9.821016274695682, 8.473009546783672, 9.89521814025226, 9.989041137400905, 9.820595517207497, 9.9958327156168, 6.302609528082655, 9.701823161965946, 8.416979848466724, -40.32840092666871, 9.89115463477365, -40.08967996480069, 9.498200749288344, 9.849199491878986, 9.945773278774679, 9.759531979570948, 9.96548779905583, 9.03180923288089, 8.55791046047198, 9.9101107952909, -40.510291237601066, 9.914238196391883, 9.424882211630246, 10.0, 9.740082628998422, -40.2025495622374, 9.052014168166808, 9.902891678559115, 9.90334042349097, 8.562204208779347, 9.85083254761499, 9.49802743136078, 9.797569012490948, 9.647940029753162, 9.504827458690208, 9.15615812676341, 9.84561010207657, 9.622830366536656, 6.745356233098702, 8.270483255237092, 9.594596212029295, 8.324640270868828, 2.299197191794426, -40.29742214106686, 8.624378060707786, 2.3720907898403345, 9.727431970466617, -40.300997860690934, 9.65124043973658, 9.993148419632062, 7.268834127621683, 8.346562623201866, 9.256024054133611, 9.820413747366763, 9.425647345016156, 9.973728119175286, 9.99650079982806, 8.192360584227025, -41.71089503119694, -40.11774703227213, 8.132993859213613, 9.971534447575198, 9.448614673861043, 9.965437501712803, 9.477525771230262, 9.900653961321666, 6.742045083692393, 9.86062383903707, 9.953457395501797, 6.5957975907907445, -40.00034903392618, 9.855926900363215, 9.600022609913662, 9.8047532788742, 9.974465777081228, 8.405019074420776, 9.99629508002862, 7.325372705703278, 9.937524464276379, 9.938584307125371, 6.323283876555273, 9.29412636160868, 9.42135697064902], "episode_lengths": [16, 124, 3, 124, 64, 47, 74, 125, 65, 53, 137, 36, 21, 103, 125, 17, 147, 104, 87, 93, 59, 69, 26, 158, 115, 120, 62, 99, 23, 102, 32, 28, 62, 11, 105, 80, 63, 60, 87, 96, 1, 12, 82, 154, 144, 16, 121, 124, 42, 90, 30, 95, 138, 60, 101, 121, 95, 30, 84, 102, 31, 98, 179, 98, 25, 17, 33, 99, 122, 137, 13, 50, 74, 7, 147, 68, 61, 124, 66, 77, 21, 74, 38, 129, 58, 55, 113, 5, 50, 130, 76, 36, 44, 4, 115, 5, 42, 51, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17952444954351335, "mean_inference_ms": 0.4770046328299243, "mean_action_processing_ms": 0.10793344860154747, "mean_env_wait_ms": 0.07591309334240576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036318302154541016, "StateBufferConnector_ms": 0.003348827362060547, "ViewRequirementAgentConnector_ms": 0.06533265113830566}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86364, "num_agent_steps_trained": 86364, "num_env_steps_sampled": 86364, "num_env_steps_trained": 86364, "num_env_steps_sampled_this_iter": 1067, "num_env_steps_trained_this_iter": 1067, "timesteps_total": 86364, "num_steps_trained_this_iter": 1067, "agent_timesteps_total": 86364, "timers": {"training_iteration_time_ms": 5888.576, "load_time_ms": 1.659, "load_throughput": 742961.717, "learn_time_ms": 5624.873, "learn_throughput": 219.134, "synch_weights_time_ms": 2.391}, "counters": {"num_env_steps_sampled": 86364, "num_env_steps_trained": 86364, "num_agent_steps_sampled": 86364, "num_agent_steps_trained": 86364}, "done": false, "episodes_total": 1401, "training_iteration": 70, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_22-37-39", "timestamp": 1678934259, "time_this_iter_s": 5.123803377151489, "time_total_s": 415.1683180332184, "pid": 4623, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce74f0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce7940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769dcff70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 415.1683180332184, "timesteps_since_restore": 0, "iterations_since_restore": 70, "warmup_time": 7.4943108558654785, "perf": {"cpu_util_percent": 15.042857142857143, "ram_util_percent": 21.400000000000002, "gpu_util_percent0": 0.7042857142857143, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997765, "cur_lr": 0.0002839118933253797, "total_loss": 1.0068373637429129, "policy_loss": -0.08333266941209634, "vf_loss": 1.0779963363411038, "vf_explained_var": 0.18015785989307223, "kl": 0.010979033755138527, "entropy": 0.807981451976867, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 87501, "num_env_steps_trained": 87501, "num_agent_steps_sampled": 87501, "num_agent_steps_trained": 87501}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -41.15712977300084, "episode_reward_mean": 3.6621193168229382, "episode_len_mean": 66.88235294117646, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17793902692387412, "mean_inference_ms": 0.4759288004755193, "mean_action_processing_ms": 0.10811754390168009, "mean_env_wait_ms": 0.07654291573431853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0038609785192153033, "ViewRequirementAgentConnector_ms": 0.058610299054314106}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -41.15712977300084, "episode_reward_mean": 3.6621193168229382, "episode_len_mean": 66.88235294117646, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17793902692387412, "mean_inference_ms": 0.4759288004755193, "mean_action_processing_ms": 0.10811754390168009, "mean_env_wait_ms": 0.07654291573431853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033617019653320312, "StateBufferConnector_ms": 0.0038609785192153033, "ViewRequirementAgentConnector_ms": 0.058610299054314106}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87501, "num_agent_steps_trained": 87501, "num_env_steps_sampled": 87501, "num_env_steps_trained": 87501, "num_env_steps_sampled_this_iter": 1137, "num_env_steps_trained_this_iter": 1137, "timesteps_total": 87501, "num_steps_trained_this_iter": 1137, "agent_timesteps_total": 87501, "timers": {"training_iteration_time_ms": 16029.711, "load_time_ms": 3.533, "load_throughput": 321854.873, "learn_time_ms": 15809.195, "learn_throughput": 71.92, "synch_weights_time_ms": 2.595}, "counters": {"num_env_steps_sampled": 87501, "num_env_steps_trained": 87501, "num_agent_steps_sampled": 87501, "num_agent_steps_trained": 87501}, "done": false, "episodes_total": 1418, "training_iteration": 71, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-24-06", "timestamp": 1678937046, "time_this_iter_s": 16.035118579864502, "time_total_s": 431.2034366130829, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1387acf10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1387aca30>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 16.035118579864502, "timesteps_since_restore": 0, "iterations_since_restore": 1, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 15.431818181818185, "ram_util_percent": 21.704545454545457, "gpu_util_percent0": 0.8459090909090908, "vram_util_percent0": 0.03311434659090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1294970575997763, "cur_lr": 0.0002839118933253797, "total_loss": 1.002667390768671, "policy_loss": -0.11119953094002528, "vf_loss": 1.1089087807234579, "vf_explained_var": 0.3368105310660142, "kl": 0.004564784116158461, "entropy": 0.7036538897416531, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 88774, "num_env_steps_trained": 88774, "num_agent_steps_sampled": 88774, "num_agent_steps_trained": 88774}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 4.800012891759919, "episode_len_mean": 73.03030303030303, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18275024663065542, "mean_inference_ms": 0.48811668802712227, "mean_action_processing_ms": 0.11096403440908253, "mean_env_wait_ms": 0.07880980522645978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033682042902166195, "StateBufferConnector_ms": 0.0035437670621004972, "ViewRequirementAgentConnector_ms": 0.0609470136237867}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 4.800012891759919, "episode_len_mean": 73.03030303030303, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18275024663065542, "mean_inference_ms": 0.48811668802712227, "mean_action_processing_ms": 0.11096403440908253, "mean_env_wait_ms": 0.07880980522645978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033682042902166195, "StateBufferConnector_ms": 0.0035437670621004972, "ViewRequirementAgentConnector_ms": 0.0609470136237867}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88774, "num_agent_steps_trained": 88774, "num_env_steps_sampled": 88774, "num_env_steps_trained": 88774, "num_env_steps_sampled_this_iter": 1273, "num_env_steps_trained_this_iter": 1273, "timesteps_total": 88774, "num_steps_trained_this_iter": 1273, "agent_timesteps_total": 88774, "timers": {"training_iteration_time_ms": 16708.063, "load_time_ms": 2.245, "load_throughput": 536703.443, "learn_time_ms": 16441.162, "learn_throughput": 73.292, "synch_weights_time_ms": 2.433}, "counters": {"num_env_steps_sampled": 88774, "num_env_steps_trained": 88774, "num_agent_steps_sampled": 88774, "num_agent_steps_trained": 88774}, "done": false, "episodes_total": 1434, "training_iteration": 72, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-24-23", "timestamp": 1678937063, "time_this_iter_s": 17.391833066940308, "time_total_s": 448.5952696800232, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff65435d040>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff65435d310>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381ac820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 33.42695164680481, "timesteps_since_restore": 0, "iterations_since_restore": 2, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.075000000000001, "ram_util_percent": 21.795833333333334, "gpu_util_percent0": 0.8529166666666668, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5647485287998881, "cur_lr": 0.0002839118933253797, "total_loss": 1.7183310129040947, "policy_loss": -0.05074188113530986, "vf_loss": 1.7315146895357842, "vf_explained_var": 0.26423567971612655, "kl": 0.06689211593621334, "entropy": 0.7792615639220956, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 2805.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 90032, "num_env_steps_trained": 90032, "num_agent_steps_sampled": 90032, "num_agent_steps_trained": 90032}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.004680554929868, "episode_len_mean": 78.04255319148936, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18333519777051652, "mean_inference_ms": 0.4896927323370818, "mean_action_processing_ms": 0.11145703558286106, "mean_env_wait_ms": 0.07901537007581293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034109075018700133, "StateBufferConnector_ms": 0.0033353237395590926, "ViewRequirementAgentConnector_ms": 0.061950277774891954}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.004680554929868, "episode_len_mean": 78.04255319148936, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18333519777051652, "mean_inference_ms": 0.4896927323370818, "mean_action_processing_ms": 0.11145703558286106, "mean_env_wait_ms": 0.07901537007581293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034109075018700133, "StateBufferConnector_ms": 0.0033353237395590926, "ViewRequirementAgentConnector_ms": 0.061950277774891954}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90032, "num_agent_steps_trained": 90032, "num_env_steps_sampled": 90032, "num_env_steps_trained": 90032, "num_env_steps_sampled_this_iter": 1258, "num_env_steps_trained_this_iter": 1258, "timesteps_total": 90032, "num_steps_trained_this_iter": 1258, "agent_timesteps_total": 90032, "timers": {"training_iteration_time_ms": 16873.165, "load_time_ms": 2.261, "load_throughput": 540820.019, "learn_time_ms": 16610.476, "learn_throughput": 73.608, "synch_weights_time_ms": 2.378}, "counters": {"num_env_steps_sampled": 90032, "num_env_steps_trained": 90032, "num_agent_steps_sampled": 90032, "num_agent_steps_trained": 90032}, "done": false, "episodes_total": 1448, "training_iteration": 73, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-24-40", "timestamp": 1678937080, "time_this_iter_s": 17.208864212036133, "time_total_s": 465.8041338920593, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6d550>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f6dbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138299670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 50.63581585884094, "timesteps_since_restore": 0, "iterations_since_restore": 3, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 21.765217391304347, "gpu_util_percent0": 0.8595652173913043, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8471227931998324, "cur_lr": 0.00028391189332537973, "total_loss": 0.9488150835968554, "policy_loss": -0.06249746233224869, "vf_loss": 1.0011932919845354, "vf_explained_var": 0.615963730285334, "kl": 0.0122053924059577, "entropy": 0.7834749787814858, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 4035.5, "diff_num_grad_updates_vs_sampler_policy": 644.5}}, "num_env_steps_sampled": 91415, "num_env_steps_trained": 91415, "num_agent_steps_sampled": 91415, "num_agent_steps_trained": 91415}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.372377783576204, "episode_len_mean": 78.921875, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1828339900333762, "mean_inference_ms": 0.4894095441200831, "mean_action_processing_ms": 0.11149099520429115, "mean_env_wait_ms": 0.07895192885785228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464147448539734, "StateBufferConnector_ms": 0.00315643846988678, "ViewRequirementAgentConnector_ms": 0.06132088601589203}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.372377783576204, "episode_len_mean": 78.921875, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1828339900333762, "mean_inference_ms": 0.4894095441200831, "mean_action_processing_ms": 0.11149099520429115, "mean_env_wait_ms": 0.07895192885785228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464147448539734, "StateBufferConnector_ms": 0.00315643846988678, "ViewRequirementAgentConnector_ms": 0.06132088601589203}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91415, "num_agent_steps_trained": 91415, "num_env_steps_sampled": 91415, "num_env_steps_trained": 91415, "num_env_steps_sampled_this_iter": 1383, "num_env_steps_trained_this_iter": 1383, "timesteps_total": 91415, "num_steps_trained_this_iter": 1383, "agent_timesteps_total": 91415, "timers": {"training_iteration_time_ms": 17439.564, "load_time_ms": 2.276, "load_throughput": 554926.513, "learn_time_ms": 17173.353, "learn_throughput": 73.53, "synch_weights_time_ms": 2.36}, "counters": {"num_env_steps_sampled": 91415, "num_env_steps_trained": 91415, "num_agent_steps_sampled": 91415, "num_agent_steps_trained": 91415}, "done": false, "episodes_total": 1465, "training_iteration": 74, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-24-59", "timestamp": 1678937099, "time_this_iter_s": 19.1441912651062, "time_total_s": 484.9483251571655, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff655cba490>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff655cbaa00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381ac820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 69.78000712394714, "timesteps_since_restore": 0, "iterations_since_restore": 4, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.184615384615386, "ram_util_percent": 21.70384615384615, "gpu_util_percent0": 0.8607692307692307, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8471227931998324, "cur_lr": 0.0002839118933253797, "total_loss": 0.7183430258184671, "policy_loss": -0.06868020304375225, "vf_loss": 0.780875707987461, "vf_explained_var": 0.6179725443323453, "kl": 0.007493308843031301, "entropy": 0.7124007738022893, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 5220.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 92595, "num_env_steps_trained": 92595, "num_agent_steps_sampled": 92595, "num_agent_steps_trained": 92595}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.614554646287184, "episode_len_mean": 76.92592592592592, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1822654942939402, "mean_inference_ms": 0.4886488750026621, "mean_action_processing_ms": 0.11138332024222061, "mean_env_wait_ms": 0.07876885996486642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414978215723862, "StateBufferConnector_ms": 0.003112392661012249, "ViewRequirementAgentConnector_ms": 0.060578334478684416}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -44.210833566324425, "episode_reward_mean": 5.614554646287184, "episode_len_mean": 76.92592592592592, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1822654942939402, "mean_inference_ms": 0.4886488750026621, "mean_action_processing_ms": 0.11138332024222061, "mean_env_wait_ms": 0.07876885996486642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414978215723862, "StateBufferConnector_ms": 0.003112392661012249, "ViewRequirementAgentConnector_ms": 0.060578334478684416}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92595, "num_agent_steps_trained": 92595, "num_env_steps_sampled": 92595, "num_env_steps_trained": 92595, "num_env_steps_sampled_this_iter": 1180, "num_env_steps_trained_this_iter": 1180, "timesteps_total": 92595, "num_steps_trained_this_iter": 1180, "agent_timesteps_total": 92595, "timers": {"training_iteration_time_ms": 17155.345, "load_time_ms": 1.998, "load_throughput": 623635.866, "learn_time_ms": 16892.082, "learn_throughput": 73.774, "synch_weights_time_ms": 2.333}, "counters": {"num_env_steps_sampled": 92595, "num_env_steps_trained": 92595, "num_agent_steps_sampled": 92595, "num_agent_steps_trained": 92595}, "done": false, "episodes_total": 1482, "training_iteration": 75, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-25-15", "timestamp": 1678937115, "time_this_iter_s": 16.024709939956665, "time_total_s": 500.9730350971222, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6da30>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff65435d790>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 85.80471706390381, "timesteps_since_restore": 0, "iterations_since_restore": 5, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.119047619047619, "ram_util_percent": 21.747619047619043, "gpu_util_percent0": 0.8833333333333332, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8471227931998325, "cur_lr": 0.0002839118933253797, "total_loss": 1.3075113934248261, "policy_loss": -0.09162744583006491, "vf_loss": 1.3645542367945094, "vf_explained_var": 0.5220512897299047, "kl": 0.04108288330416576, "entropy": 0.7743714711514481, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 6330.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 93815, "num_env_steps_trained": 93815, "num_agent_steps_sampled": 93815, "num_agent_steps_trained": 93815}, "sampler_results": {"episode_reward_max": 9.996161033242931, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.137063168602246, "episode_len_mean": 76.81443298969072, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18181691041217732, "mean_inference_ms": 0.48772355483623214, "mean_action_processing_ms": 0.11121603332730279, "mean_env_wait_ms": 0.07855495247495417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034020119106646664, "StateBufferConnector_ms": 0.003176866118440923, "ViewRequirementAgentConnector_ms": 0.06032088368209367}}, "episode_reward_max": 9.996161033242931, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.137063168602246, "episode_len_mean": 76.81443298969072, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.921854629098505, 8.670644466026257, 9.973724517246858, -40.00975817875013, 9.929425966694556, 9.88282812525688, 9.996161033242931, 9.741055152896935, 9.393185950441532, 6.797998812215827, 9.934407279061602, -41.15712977300084, 9.95680861236767, 9.95719186584716, 9.956935646054568, 9.859945464077457, 9.450748817212181, -44.210833566324425, 9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269], "episode_lengths": [16, 120, 3, 8, 111, 92, 7, 62, 58, 154, 50, 71, 132, 16, 96, 80, 61, 96, 42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18181691041217732, "mean_inference_ms": 0.48772355483623214, "mean_action_processing_ms": 0.11121603332730279, "mean_env_wait_ms": 0.07855495247495417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034020119106646664, "StateBufferConnector_ms": 0.003176866118440923, "ViewRequirementAgentConnector_ms": 0.06032088368209367}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93815, "num_agent_steps_trained": 93815, "num_env_steps_sampled": 93815, "num_env_steps_trained": 93815, "num_env_steps_sampled_this_iter": 1220, "num_env_steps_trained_this_iter": 1220, "timesteps_total": 93815, "num_steps_trained_this_iter": 1220, "agent_timesteps_total": 93815, "timers": {"training_iteration_time_ms": 17120.186, "load_time_ms": 2.127, "load_throughput": 583741.321, "learn_time_ms": 16855.567, "learn_throughput": 73.675, "synch_weights_time_ms": 2.32}, "counters": {"num_env_steps_sampled": 93815, "num_env_steps_trained": 93815, "num_agent_steps_sampled": 93815, "num_agent_steps_trained": 93815}, "done": false, "episodes_total": 1498, "training_iteration": 76, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-25-32", "timestamp": 1678937132, "time_this_iter_s": 16.950260877609253, "time_total_s": 517.9232959747314, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc190>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdc0d0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138299670>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 102.75497794151306, "timesteps_since_restore": 0, "iterations_since_restore": 6, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.313043478260866, "ram_util_percent": 21.72173913043478, "gpu_util_percent0": 0.8760869565217391, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2706841897997487, "cur_lr": 0.00028391189332537973, "total_loss": 2.274343976579839, "policy_loss": -0.009715745108357321, "vf_loss": 2.254587304124143, "vf_explained_var": -0.10280917420983314, "kl": 0.023354011137572968, "entropy": 0.7228285286575555, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 7500.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 95125, "num_env_steps_trained": 95125, "num_agent_steps_sampled": 95125, "num_agent_steps_trained": 95125}, "sampler_results": {"episode_reward_max": 9.999291347224045, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.6613540982577355, "episode_len_mean": 75.28, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585], "episode_lengths": [42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1818748340826373, "mean_inference_ms": 0.4890139655093329, "mean_action_processing_ms": 0.11162522860803095, "mean_env_wait_ms": 0.07870011134629863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034704208374023438, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.06056380271911621}}, "episode_reward_max": 9.999291347224045, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.6613540982577355, "episode_len_mean": 75.28, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.183820987536897, 9.867628340582915, 9.521895967322466, 9.96007535825304, 9.34988312754339, 9.93177632998644, 9.98937535266907, 9.958667871912409, 9.886973549393463, 9.931220119581896, 9.830029756327978, 9.71739399869724, 6.365015505690369, 7.646946183532879, 9.214528159381345, 9.746414670581343, 9.983378226304644, 8.896846262023356, 8.9027146388296, 9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585], "episode_lengths": [42, 114, 91, 59, 94, 26, 25, 8, 70, 58, 126, 68, 140, 102, 154, 106, 23, 129, 141, 138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1818748340826373, "mean_inference_ms": 0.4890139655093329, "mean_action_processing_ms": 0.11162522860803095, "mean_env_wait_ms": 0.07870011134629863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034704208374023438, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.06056380271911621}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95125, "num_agent_steps_trained": 95125, "num_env_steps_sampled": 95125, "num_env_steps_trained": 95125, "num_env_steps_sampled_this_iter": 1310, "num_env_steps_trained_this_iter": 1310, "timesteps_total": 95125, "num_steps_trained_this_iter": 1310, "agent_timesteps_total": 95125, "timers": {"training_iteration_time_ms": 17222.786, "load_time_ms": 2.155, "load_throughput": 580757.943, "learn_time_ms": 16955.351, "learn_throughput": 73.816, "synch_weights_time_ms": 2.306}, "counters": {"num_env_steps_sampled": 95125, "num_env_steps_trained": 95125, "num_agent_steps_sampled": 95125, "num_agent_steps_trained": 95125}, "done": false, "episodes_total": 1519, "training_iteration": 77, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-25-50", "timestamp": 1678937150, "time_this_iter_s": 17.845006227493286, "time_total_s": 535.7683022022247, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc400>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdc340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138262820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 120.59998416900635, "timesteps_since_restore": 0, "iterations_since_restore": 7, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.0875, "ram_util_percent": 21.741666666666664, "gpu_util_percent0": 0.8799999999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9060262846996234, "cur_lr": 0.0002839118933253798, "total_loss": 1.565488462560692, "policy_loss": -0.05200574390797152, "vf_loss": 1.5901680628686408, "vf_explained_var": 0.20449040210436262, "kl": 0.014450633250516924, "entropy": 0.7725725953068052, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 8730.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 96494, "num_env_steps_trained": 96494, "num_agent_steps_sampled": 96494, "num_agent_steps_trained": 96494}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.051539611657318, "episode_len_mean": 73.21, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064], "episode_lengths": [138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18029653257228506, "mean_inference_ms": 0.48554183538350515, "mean_action_processing_ms": 0.11089816321007603, "mean_env_wait_ms": 0.07799721019366865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034072399139404297, "StateBufferConnector_ms": 0.0032958984375, "ViewRequirementAgentConnector_ms": 0.06012082099914551}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 5.051539611657318, "episode_len_mean": 73.21, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.217794972539878, 6.538175541838131, 5.034409570351688, 9.91200387975313, -40.05722850931464, 9.702792615843824, 9.309973348725162, 9.911236650844181, 9.948482944352076, 9.77256584095413, 8.679252207943446, 9.841429177486376, 5.09710090412779, 9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064], "episode_lengths": [138, 159, 126, 73, 130, 52, 41, 18, 46, 76, 125, 36, 140, 91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.18029653257228506, "mean_inference_ms": 0.48554183538350515, "mean_action_processing_ms": 0.11089816321007603, "mean_env_wait_ms": 0.07799721019366865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034072399139404297, "StateBufferConnector_ms": 0.0032958984375, "ViewRequirementAgentConnector_ms": 0.06012082099914551}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96494, "num_agent_steps_trained": 96494, "num_env_steps_sampled": 96494, "num_env_steps_trained": 96494, "num_env_steps_sampled_this_iter": 1369, "num_env_steps_trained_this_iter": 1369, "timesteps_total": 96494, "num_steps_trained_this_iter": 1369, "agent_timesteps_total": 96494, "timers": {"training_iteration_time_ms": 17507.446, "load_time_ms": 2.006, "load_throughput": 631101.829, "learn_time_ms": 17237.583, "learn_throughput": 73.459, "synch_weights_time_ms": 2.315}, "counters": {"num_env_steps_sampled": 96494, "num_env_steps_trained": 96494, "num_agent_steps_sampled": 96494, "num_agent_steps_trained": 96494}, "done": false, "episodes_total": 1538, "training_iteration": 78, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-26-10", "timestamp": 1678937170, "time_this_iter_s": 19.506869554519653, "time_total_s": 555.2751717567444, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6542bd8b0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bd550>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 140.106853723526, "timesteps_since_restore": 0, "iterations_since_restore": 8, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.855555555555556, "ram_util_percent": 21.788888888888884, "gpu_util_percent0": 0.908888888888889, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9060262846996228, "cur_lr": 0.0002839118933253797, "total_loss": 2.606994087015414, "policy_loss": -0.058907986629722464, "vf_loss": 2.65559045719142, "vf_explained_var": 0.045002077277908975, "kl": 0.005529155548608227, "entropy": 0.8080069481562345, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 9945.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 97772, "num_env_steps_trained": 97772, "num_agent_steps_sampled": 97772, "num_agent_steps_trained": 97772}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 4.334752607167166, "episode_len_mean": 74.39, "episode_media": {}, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609], "episode_lengths": [91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17970466965729423, "mean_inference_ms": 0.48443562082701364, "mean_action_processing_ms": 0.11063512379628027, "mean_env_wait_ms": 0.07774283591817582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033655166625976562, "StateBufferConnector_ms": 0.0032825469970703125, "ViewRequirementAgentConnector_ms": 0.060004234313964844}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 4.334752607167166, "episode_len_mean": 74.39, "episodes_this_iter": 13, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.677158679987649, 9.751525460781604, -40.02376112458312, 9.86539630022538, 9.894324196389647, 9.539287654893501, 9.813084474032914, 9.937665391170388, 9.619120740554104, 9.444634690320953, 8.899204465666516, 9.744703858675459, 9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609], "episode_lengths": [91, 96, 56, 109, 11, 46, 19, 10, 131, 90, 93, 93, 124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17970466965729423, "mean_inference_ms": 0.48443562082701364, "mean_action_processing_ms": 0.11063512379628027, "mean_env_wait_ms": 0.07774283591817582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033655166625976562, "StateBufferConnector_ms": 0.0032825469970703125, "ViewRequirementAgentConnector_ms": 0.060004234313964844}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97772, "num_agent_steps_trained": 97772, "num_env_steps_sampled": 97772, "num_env_steps_trained": 97772, "num_env_steps_sampled_this_iter": 1278, "num_env_steps_trained_this_iter": 1278, "timesteps_total": 97772, "num_steps_trained_this_iter": 1278, "agent_timesteps_total": 97772, "timers": {"training_iteration_time_ms": 17527.136, "load_time_ms": 2.039, "load_throughput": 621725.55, "learn_time_ms": 17257.429, "learn_throughput": 73.45, "synch_weights_time_ms": 2.299}, "counters": {"num_env_steps_sampled": 97772, "num_env_steps_trained": 97772, "num_agent_steps_sampled": 97772, "num_agent_steps_trained": 97772}, "done": false, "episodes_total": 1551, "training_iteration": 79, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-26-28", "timestamp": 1678937188, "time_this_iter_s": 17.690776586532593, "time_total_s": 572.965948343277, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6542bda00>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bdbe0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f1f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 157.7976303100586, "timesteps_since_restore": 0, "iterations_since_restore": 9, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.130434782608694, "ram_util_percent": 21.800000000000004, "gpu_util_percent0": 0.9026086956521738, "vram_util_percent0": 0.03314208984375}}
{"evaluation": {"episode_reward_max": 9.995597119863437, "episode_reward_min": -44.89835796124732, "episode_reward_mean": -0.7670833117522039, "episode_len_mean": 51.333333333333336, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.95207202044105, 8.152978722771852, 8.329319881388233, -44.89835796124732, 9.203386239577059, 9.9100721318171, 9.814273530192883, 9.778406904973103, 9.982409615505631, 9.318917000705556, 9.985470773550224, 9.995597119863437, -40.01821990474117, -40.761937336514094, 9.749361585433395], "episode_lengths": [27, 52, 88, 140, 85, 13, 27, 105, 2, 21, 40, 2, 25, 125, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.15181727609301185, "mean_inference_ms": 0.42454206359832264, "mean_action_processing_ms": 0.09606130018169506, "mean_env_wait_ms": 0.06824482105800429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004041989644368489, "StateBufferConnector_ms": 0.009113417731391061, "ViewRequirementAgentConnector_ms": 0.06132496727837457}, "num_agent_steps_sampled_this_iter": 770, "num_env_steps_sampled_this_iter": 770, "timesteps_this_iter": 770, "num_healthy_workers": 2, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0}, "custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.906026284699623, "cur_lr": 0.0002839118933253797, "total_loss": 1.9325414534425363, "policy_loss": -0.0845839950049089, "vf_loss": 2.0018967598008373, "vf_explained_var": 0.27218027125906064, "kl": 0.008121570436388652, "entropy": 0.8938941906999659, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 11070.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 98924, "num_env_steps_trained": 98924, "num_agent_steps_sampled": 98924, "num_agent_steps_trained": 98924}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 3.6777339961646023, "episode_len_mean": 77.46, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845], "episode_lengths": [124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17960955411027704, "mean_inference_ms": 0.4841469050365639, "mean_action_processing_ms": 0.11055191779760772, "mean_env_wait_ms": 0.07759098852407041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003383159637451172, "StateBufferConnector_ms": 0.003304004669189453, "ViewRequirementAgentConnector_ms": 0.060744285583496094}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 3.6777339961646023, "episode_len_mean": 77.46, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.927935457347717, 8.904129532152924, 9.882856138474152, -40.20061229367354, 9.097983706297187, 9.977347927352211, 9.447912935592072, 9.762087101640471, 9.772335782205495, 9.816181227954987, 9.742874588558287, 8.38334845285409, 9.85827055149053, 9.985993509258538, 8.505904466972286, 8.861903797654408, 8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845], "episode_lengths": [124, 113, 73, 80, 123, 10, 80, 31, 107, 91, 41, 28, 80, 32, 99, 82, 80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17960955411027704, "mean_inference_ms": 0.4841469050365639, "mean_action_processing_ms": 0.11055191779760772, "mean_env_wait_ms": 0.07759098852407041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003383159637451172, "StateBufferConnector_ms": 0.003304004669189453, "ViewRequirementAgentConnector_ms": 0.060744285583496094}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98924, "num_agent_steps_trained": 98924, "num_env_steps_sampled": 98924, "num_env_steps_trained": 98924, "num_env_steps_sampled_this_iter": 1152, "num_env_steps_trained_this_iter": 1152, "timesteps_total": 98924, "num_steps_trained_this_iter": 1152, "agent_timesteps_total": 98924, "timers": {"training_iteration_time_ms": 17365.35, "load_time_ms": 2.071, "load_throughput": 606393.764, "learn_time_ms": 17094.743, "learn_throughput": 73.473, "synch_weights_time_ms": 2.294}, "counters": {"num_env_steps_sampled": 98924, "num_env_steps_trained": 98924, "num_agent_steps_sampled": 98924, "num_agent_steps_trained": 98924}, "done": false, "episodes_total": 1563, "training_iteration": 80, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-26-44", "timestamp": 1678937204, "time_this_iter_s": 16.412764072418213, "time_total_s": 589.3787124156952, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1387aadc0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1387aad60>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138262820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 174.2103943824768, "timesteps_since_restore": 0, "iterations_since_restore": 10, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.543478260869568, "ram_util_percent": 21.830434782608698, "gpu_util_percent0": 0.8569565217391305, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.906026284699623, "cur_lr": 0.00028391189332537973, "total_loss": 1.0516801543075902, "policy_loss": 0.016014873147166025, "vf_loss": 1.002519432068463, "vf_explained_var": 0.3320492791136106, "kl": 0.017519322233537582, "entropy": 0.8767912557224432, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 12210.5, "diff_num_grad_updates_vs_sampler_policy": 599.5}}, "num_env_steps_sampled": 100204, "num_env_steps_trained": 100204, "num_agent_steps_sampled": 100204, "num_agent_steps_trained": 100204}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 4.063555216166464, "episode_len_mean": 78.32, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797], "episode_lengths": [80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17963215945088987, "mean_inference_ms": 0.48489095477254296, "mean_action_processing_ms": 0.11069604613845425, "mean_env_wait_ms": 0.07761401623928979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033957958221435547, "StateBufferConnector_ms": 0.0033004283905029297, "ViewRequirementAgentConnector_ms": 0.0608057975769043}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -46.54203889850493, "episode_reward_mean": 4.063555216166464, "episode_len_mean": 78.32, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.867736842975756, 9.894686996688653, 9.289936468089177, 9.989895637250154, 9.954259290103707, 9.776698969519535, 8.759629712859061, 8.951077367116222, 9.411355610118441, 9.840254526817848, 9.55069398196621, -46.54203889850493, -40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797], "episode_lengths": [80, 8, 135, 28, 8, 72, 112, 31, 67, 12, 138, 115, 29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17963215945088987, "mean_inference_ms": 0.48489095477254296, "mean_action_processing_ms": 0.11069604613845425, "mean_env_wait_ms": 0.07761401623928979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033957958221435547, "StateBufferConnector_ms": 0.0033004283905029297, "ViewRequirementAgentConnector_ms": 0.0608057975769043}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100204, "num_agent_steps_trained": 100204, "num_env_steps_sampled": 100204, "num_env_steps_trained": 100204, "num_env_steps_sampled_this_iter": 1280, "num_env_steps_trained_this_iter": 1280, "timesteps_total": 100204, "num_steps_trained_this_iter": 1280, "agent_timesteps_total": 100204, "timers": {"training_iteration_time_ms": 17431.174, "load_time_ms": 1.908, "load_throughput": 665770.027, "learn_time_ms": 17158.675, "learn_throughput": 74.033, "synch_weights_time_ms": 2.289}, "counters": {"num_env_steps_sampled": 100204, "num_env_steps_trained": 100204, "num_agent_steps_sampled": 100204, "num_agent_steps_trained": 100204}, "done": false, "episodes_total": 1579, "training_iteration": 81, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-27-01", "timestamp": 1678937221, "time_this_iter_s": 16.694368839263916, "time_total_s": 606.0730812549591, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042d9d0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042de20>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 190.90476322174072, "timesteps_since_restore": 0, "iterations_since_restore": 11, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.736363636363638, "ram_util_percent": 21.80909090909091, "gpu_util_percent0": 0.8563636363636362, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9060262846996234, "cur_lr": 0.0002839118933253797, "total_loss": 0.585371082919162, "policy_loss": -0.067040700422866, "vf_loss": 0.6438085155202896, "vf_explained_var": 0.6080764328865778, "kl": 0.004639485004784861, "entropy": 0.8528840683471589, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 13335.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 101355, "num_env_steps_trained": 101355, "num_agent_steps_sampled": 101355, "num_agent_steps_trained": 101355}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 4.516865272043258, "episode_len_mean": 81.77, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704], "episode_lengths": [29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17954946424019042, "mean_inference_ms": 0.4857160203991178, "mean_action_processing_ms": 0.11083044479857536, "mean_env_wait_ms": 0.0777310056646888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034148693084716797, "StateBufferConnector_ms": 0.003142118453979492, "ViewRequirementAgentConnector_ms": 0.060993194580078125}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 4.516865272043258, "episode_len_mean": 81.77, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-40.2972979091278, 7.186715395210587, 8.919510052531892, 9.031576032044677, 9.396591456524249, 9.976931428726873, 9.610348351999269, 6.7350995823855015, 9.964998711726459, 9.999291347224045, 9.920447845817916, 8.321413346981723, 9.96952562360563, 9.817876245385438, -40.86262026898627, 9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704], "episode_lengths": [29, 103, 138, 147, 108, 4, 108, 97, 13, 6, 10, 126, 27, 37, 44, 44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17954946424019042, "mean_inference_ms": 0.4857160203991178, "mean_action_processing_ms": 0.11083044479857536, "mean_env_wait_ms": 0.0777310056646888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034148693084716797, "StateBufferConnector_ms": 0.003142118453979492, "ViewRequirementAgentConnector_ms": 0.060993194580078125}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101355, "num_agent_steps_trained": 101355, "num_env_steps_sampled": 101355, "num_env_steps_trained": 101355, "num_env_steps_sampled_this_iter": 1151, "num_env_steps_trained_this_iter": 1151, "timesteps_total": 101355, "num_steps_trained_this_iter": 1151, "agent_timesteps_total": 101355, "timers": {"training_iteration_time_ms": 17255.525, "load_time_ms": 1.953, "load_throughput": 644170.79, "learn_time_ms": 16988.247, "learn_throughput": 74.057, "synch_weights_time_ms": 2.277}, "counters": {"num_env_steps_sampled": 101355, "num_env_steps_trained": 101355, "num_agent_steps_sampled": 101355, "num_agent_steps_trained": 101355}, "done": false, "episodes_total": 1591, "training_iteration": 82, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-27-16", "timestamp": 1678937236, "time_this_iter_s": 15.636260509490967, "time_total_s": 621.7093417644501, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769af1610>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769af11c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13816e310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 206.5410237312317, "timesteps_since_restore": 0, "iterations_since_restore": 12, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.133333333333335, "ram_util_percent": 21.828571428571433, "gpu_util_percent0": 0.8871428571428572, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498115, "cur_lr": 0.0002839118933253797, "total_loss": 0.18362084723224764, "policy_loss": -0.09130813942470571, "vf_loss": 0.2658642700320853, "vf_explained_var": 0.6413952390352885, "kl": 0.009754643248309389, "entropy": 0.823971094975346, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 14430.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 102598, "num_env_steps_trained": 102598, "num_agent_steps_sampled": 102598, "num_agent_steps_trained": 102598}, "sampler_results": {"episode_reward_max": 9.999859946797635, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 5.510028667396042, "episode_len_mean": 84.23, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778], "episode_lengths": [44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17935494559767007, "mean_inference_ms": 0.48595257575170586, "mean_action_processing_ms": 0.11083501009847342, "mean_env_wait_ms": 0.0777288255387078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033316612243652344, "StateBufferConnector_ms": 0.002985715866088867, "ViewRequirementAgentConnector_ms": 0.06094241142272949}}, "episode_reward_max": 9.999859946797635, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 5.510028667396042, "episode_len_mean": 84.23, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.755500098461361, -40.08877094124844, 9.937292850309756, 9.687038049854012, 9.385139488374895, 9.896782645170523, 9.869046800629578, 9.995833461613994, 9.965682166269495, 8.56524492060026, 9.995512673908348, 4.041684112324297, 1.013458530612585, -40.89073467736686, 9.297866539804891, 9.33434755198328, 8.412113802361134, 9.999859946797635, 9.999540574756688, 9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778], "episode_lengths": [44, 85, 87, 54, 70, 7, 78, 4, 52, 118, 24, 139, 188, 82, 86, 130, 33, 2, 5, 31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17935494559767007, "mean_inference_ms": 0.48595257575170586, "mean_action_processing_ms": 0.11083501009847342, "mean_env_wait_ms": 0.0777288255387078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033316612243652344, "StateBufferConnector_ms": 0.002985715866088867, "ViewRequirementAgentConnector_ms": 0.06094241142272949}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102598, "num_agent_steps_trained": 102598, "num_env_steps_sampled": 102598, "num_env_steps_trained": 102598, "num_env_steps_sampled_this_iter": 1243, "num_env_steps_trained_this_iter": 1243, "timesteps_total": 102598, "num_steps_trained_this_iter": 1243, "agent_timesteps_total": 102598, "timers": {"training_iteration_time_ms": 17251.572, "load_time_ms": 1.961, "load_throughput": 640930.333, "learn_time_ms": 16985.765, "learn_throughput": 73.98, "synch_weights_time_ms": 2.287}, "counters": {"num_env_steps_sampled": 102598, "num_env_steps_trained": 102598, "num_agent_steps_sampled": 102598, "num_agent_steps_trained": 102598}, "done": false, "episodes_total": 1606, "training_iteration": 83, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-27-34", "timestamp": 1678937254, "time_this_iter_s": 17.169643878936768, "time_total_s": 638.8789856433868, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdce50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdc2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 223.71066761016846, "timesteps_since_restore": 0, "iterations_since_restore": 13, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.35217391304348, "ram_util_percent": 21.826086956521735, "gpu_util_percent0": 0.8878260869565217, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498118, "cur_lr": 0.00028391189332537973, "total_loss": 0.25429620714858175, "policy_loss": -0.039322453428699514, "vf_loss": 0.28507065416661775, "vf_explained_var": 0.48971842762195705, "kl": 0.009182988989366545, "entropy": 0.7240858629195377, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 15495.5, "diff_num_grad_updates_vs_sampler_policy": 494.5}}, "num_env_steps_sampled": 103676, "num_env_steps_trained": 103676, "num_agent_steps_sampled": 103676, "num_agent_steps_trained": 103676}, "sampler_results": {"episode_reward_max": 9.993629899735453, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 6.618234021135785, "episode_len_mean": 82.13, "episode_media": {}, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869], "episode_lengths": [31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17937949684256294, "mean_inference_ms": 0.4866839701650575, "mean_action_processing_ms": 0.11094016866267072, "mean_env_wait_ms": 0.07776635547553318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033316612243652344, "StateBufferConnector_ms": 0.0027048587799072266, "ViewRequirementAgentConnector_ms": 0.06110739707946777}}, "episode_reward_max": 9.993629899735453, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 6.618234021135785, "episode_len_mean": 82.13, "episodes_this_iter": 19, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.874340379631342, 9.548045830130564, 5.600355780233346, 9.520386007465579, 4.4823362455582245, 8.991830185264327, 9.496669247842043, 5.223300755709783, 9.74443441557678, 9.94206303493254, 8.895088587326352, 9.704840366194324, 9.726451171907064, 9.820320343490835, 9.639915942077442, 9.927604069057505, 9.831178314128739, 1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869], "episode_lengths": [31, 47, 113, 132, 96, 113, 51, 165, 16, 29, 92, 40, 106, 93, 97, 67, 101, 119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17937949684256294, "mean_inference_ms": 0.4866839701650575, "mean_action_processing_ms": 0.11094016866267072, "mean_env_wait_ms": 0.07776635547553318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033316612243652344, "StateBufferConnector_ms": 0.0027048587799072266, "ViewRequirementAgentConnector_ms": 0.06110739707946777}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103676, "num_agent_steps_trained": 103676, "num_env_steps_sampled": 103676, "num_env_steps_trained": 103676, "num_env_steps_sampled_this_iter": 1078, "num_env_steps_trained_this_iter": 1078, "timesteps_total": 103676, "num_steps_trained_this_iter": 1078, "agent_timesteps_total": 103676, "timers": {"training_iteration_time_ms": 16802.505, "load_time_ms": 2.003, "load_throughput": 612240.453, "learn_time_ms": 16543.515, "learn_throughput": 74.114, "synch_weights_time_ms": 2.322}, "counters": {"num_env_steps_sampled": 103676, "num_env_steps_trained": 103676, "num_agent_steps_sampled": 103676, "num_agent_steps_trained": 103676}, "done": false, "episodes_total": 1625, "training_iteration": 84, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-27-48", "timestamp": 1678937268, "time_this_iter_s": 14.654877424240112, "time_total_s": 653.533863067627, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301a90>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18046ac70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 238.36554503440857, "timesteps_since_restore": 0, "iterations_since_restore": 14, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.245, "ram_util_percent": 21.805, "gpu_util_percent0": 0.8869999999999999, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498115, "cur_lr": 0.0002839118933253797, "total_loss": 0.15712094310082547, "policy_loss": -0.020087895347495322, "vf_loss": 0.16597207699211408, "vf_explained_var": 0.6914341146747272, "kl": 0.012024902920418136, "entropy": 0.793873822192351, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 16530.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 104844, "num_env_steps_trained": 104844, "num_agent_steps_sampled": 104844, "num_agent_steps_trained": 104844}, "sampler_results": {"episode_reward_max": 9.993629899735453, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 6.232614647856414, "episode_len_mean": 79.92, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747], "episode_lengths": [119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17927691740362242, "mean_inference_ms": 0.4869489760165049, "mean_action_processing_ms": 0.11093701581262991, "mean_env_wait_ms": 0.07775759780131587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033097267150878906, "StateBufferConnector_ms": 0.0026786327362060547, "ViewRequirementAgentConnector_ms": 0.06009244918823242}}, "episode_reward_max": 9.993629899735453, "episode_reward_min": -43.28079713174727, "episode_reward_mean": 6.232614647856414, "episode_len_mean": 79.92, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [1.347058438978829, 9.902811248517345, -6.682249250910225, 9.478564533796321, 9.441811121323362, -43.28079713174727, -42.482104717057524, 5.532196441817138, 8.752979342957609, -41.13961070471779, 7.407584831654744, 9.685925311946956, 9.666768230947344, 9.60576435251847, 8.990286832873707, 9.915453108740264, 1.212801162949125, 8.831975823842292, -41.35063866196001, 9.846352196745634, 7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747], "episode_lengths": [119, 112, 124, 79, 100, 99, 83, 111, 93, 72, 154, 97, 34, 82, 74, 68, 127, 132, 85, 87, 140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17927691740362242, "mean_inference_ms": 0.4869489760165049, "mean_action_processing_ms": 0.11093701581262991, "mean_env_wait_ms": 0.07775759780131587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033097267150878906, "StateBufferConnector_ms": 0.0026786327362060547, "ViewRequirementAgentConnector_ms": 0.06009244918823242}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104844, "num_agent_steps_trained": 104844, "num_env_steps_sampled": 104844, "num_env_steps_trained": 104844, "num_env_steps_sampled_this_iter": 1168, "num_env_steps_trained_this_iter": 1168, "timesteps_total": 104844, "num_steps_trained_this_iter": 1168, "agent_timesteps_total": 104844, "timers": {"training_iteration_time_ms": 16786.943, "load_time_ms": 2.07, "load_throughput": 591801.109, "learn_time_ms": 16531.956, "learn_throughput": 74.093, "synch_weights_time_ms": 2.33}, "counters": {"num_env_steps_sampled": 104844, "num_env_steps_trained": 104844, "num_agent_steps_sampled": 104844, "num_agent_steps_trained": 104844}, "done": false, "episodes_total": 1642, "training_iteration": 85, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-28-04", "timestamp": 1678937284, "time_this_iter_s": 15.869521856307983, "time_total_s": 669.4033849239349, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce7e80>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ed4f70>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138299280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 254.23506689071655, "timesteps_since_restore": 0, "iterations_since_restore": 15, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.45909090909091, "ram_util_percent": 21.822727272727267, "gpu_util_percent0": 0.8900000000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498114, "cur_lr": 0.0002839118933253797, "total_loss": 0.44147553089284736, "policy_loss": -0.04395893509300728, "vf_loss": 0.4796573826938203, "vf_explained_var": 0.4477444031299689, "kl": 0.006295895802150671, "entropy": 0.7933701806216158, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 17655.5, "diff_num_grad_updates_vs_sampler_policy": 584.5}}, "num_env_steps_sampled": 106102, "num_env_steps_trained": 106102, "num_agent_steps_sampled": 106102, "num_agent_steps_trained": 106102}, "sampler_results": {"episode_reward_max": 9.993952226492658, "episode_reward_min": -40.0063978694887, "episode_reward_mean": 8.159476537048455, "episode_len_mean": 73.18, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803], "episode_lengths": [140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17902185115396896, "mean_inference_ms": 0.4862037788494378, "mean_action_processing_ms": 0.11073778468964386, "mean_env_wait_ms": 0.0775481012613337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033636093139648438, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.060141801834106445}}, "episode_reward_max": 9.993952226492658, "episode_reward_min": -40.0063978694887, "episode_reward_mean": 8.159476537048455, "episode_len_mean": 73.18, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.787821202317845, 9.83366330326201, 8.976519517419455, 9.702378917594285, 9.993629899735453, 9.458003385412578, 9.701003074932235, 8.198898151132846, 4.585353128967373, 9.94728616930832, 1.799918842380615, 9.846460072159504, 9.53155286209718, 9.86762799985145, 9.63413038038575, 9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803], "episode_lengths": [140, 29, 64, 54, 11, 38, 86, 141, 113, 115, 128, 43, 28, 71, 124, 104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17902185115396896, "mean_inference_ms": 0.4862037788494378, "mean_action_processing_ms": 0.11073778468964386, "mean_env_wait_ms": 0.0775481012613337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033636093139648438, "StateBufferConnector_ms": 0.0028297901153564453, "ViewRequirementAgentConnector_ms": 0.060141801834106445}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106102, "num_agent_steps_trained": 106102, "num_env_steps_sampled": 106102, "num_env_steps_trained": 106102, "num_env_steps_sampled_this_iter": 1258, "num_env_steps_trained_this_iter": 1258, "timesteps_total": 106102, "num_steps_trained_this_iter": 1258, "agent_timesteps_total": 106102, "timers": {"training_iteration_time_ms": 16840.962, "load_time_ms": 2.05, "load_throughput": 599485.997, "learn_time_ms": 16585.453, "learn_throughput": 74.083, "synch_weights_time_ms": 2.317}, "counters": {"num_env_steps_sampled": 106102, "num_env_steps_trained": 106102, "num_agent_steps_sampled": 106102, "num_agent_steps_trained": 106102}, "done": false, "episodes_total": 1662, "training_iteration": 86, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-28-22", "timestamp": 1678937302, "time_this_iter_s": 17.490278959274292, "time_total_s": 686.8936638832092, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff654301eb0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff654301f40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138121dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 271.72534584999084, "timesteps_since_restore": 0, "iterations_since_restore": 16, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 13.68260869565217, "ram_util_percent": 21.808695652173917, "gpu_util_percent0": 0.9204347826086959, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498115, "cur_lr": 0.0002839118933253797, "total_loss": 0.8916419129034406, "policy_loss": -0.039922747395017694, "vf_loss": 0.9175958051739399, "vf_explained_var": 0.623906421661377, "kl": 0.014912155927174223, "entropy": 0.8632306538914379, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 18810.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 107348, "num_env_steps_trained": 107348, "num_agent_steps_sampled": 107348, "num_agent_steps_trained": 107348}, "sampler_results": {"episode_reward_max": 9.993952226492658, "episode_reward_min": -40.09472150805784, "episode_reward_mean": 7.804634289427029, "episode_len_mean": 73.79, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775], "episode_lengths": [104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17887666742251965, "mean_inference_ms": 0.48554122171643294, "mean_action_processing_ms": 0.11056682621750298, "mean_env_wait_ms": 0.07743055053850272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033655166625976562, "StateBufferConnector_ms": 0.002936124801635742, "ViewRequirementAgentConnector_ms": 0.06060171127319336}}, "episode_reward_max": 9.993952226492658, "episode_reward_min": -40.09472150805784, "episode_reward_mean": 7.804634289427029, "episode_len_mean": 73.79, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.435238677317148, 9.796910500361797, 3.423728805052531, 8.022262023145226, 9.684432340486175, 9.977220128295322, 9.935940580561986, 9.946264256390695, 9.434093208095348, 9.690568825412662, 9.144817395532547, 7.7826584654716715, 7.412010586374339, 8.621195477860704, 9.789559452081102, 9.737735581757438, 6.29146541457775, 7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775], "episode_lengths": [104, 131, 80, 127, 123, 95, 43, 99, 68, 61, 109, 133, 105, 108, 48, 41, 156, 146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17887666742251965, "mean_inference_ms": 0.48554122171643294, "mean_action_processing_ms": 0.11056682621750298, "mean_env_wait_ms": 0.07743055053850272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033655166625976562, "StateBufferConnector_ms": 0.002936124801635742, "ViewRequirementAgentConnector_ms": 0.06060171127319336}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107348, "num_agent_steps_trained": 107348, "num_env_steps_sampled": 107348, "num_env_steps_trained": 107348, "num_env_steps_sampled_this_iter": 1246, "num_env_steps_trained_this_iter": 1246, "timesteps_total": 107348, "num_steps_trained_this_iter": 1246, "agent_timesteps_total": 107348, "timers": {"training_iteration_time_ms": 16805.875, "load_time_ms": 1.979, "load_throughput": 617622.343, "learn_time_ms": 16552.644, "learn_throughput": 73.843, "synch_weights_time_ms": 2.343}, "counters": {"num_env_steps_sampled": 107348, "num_env_steps_trained": 107348, "num_agent_steps_sampled": 107348, "num_agent_steps_trained": 107348}, "done": false, "episodes_total": 1677, "training_iteration": 87, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-28-39", "timestamp": 1678937319, "time_this_iter_s": 17.49421739578247, "time_total_s": 704.3878812789917, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff180430ca0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff180430d00>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138299280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 289.2195632457733, "timesteps_since_restore": 0, "iterations_since_restore": 17, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.441666666666668, "ram_util_percent": 21.829166666666666, "gpu_util_percent0": 0.8841666666666667, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9530131423498115, "cur_lr": 0.0002839118933253797, "total_loss": 0.29300563224895626, "policy_loss": -0.0922782209946921, "vf_loss": 0.38104644392785797, "vf_explained_var": 0.7291704483199538, "kl": 0.004664097498462389, "entropy": 0.7384036643463269, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 19950.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 108565, "num_env_steps_trained": 108565, "num_agent_steps_sampled": 108565, "num_agent_steps_trained": 108565}, "sampler_results": {"episode_reward_max": 9.998021950544938, "episode_reward_min": -40.09472150805784, "episode_reward_mean": 7.868330421264342, "episode_len_mean": 69.65, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013], "episode_lengths": [146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17894442495529803, "mean_inference_ms": 0.48547776770031476, "mean_action_processing_ms": 0.11056552131719237, "mean_env_wait_ms": 0.07741534988062139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033926963806152344, "StateBufferConnector_ms": 0.0031197071075439453, "ViewRequirementAgentConnector_ms": 0.06080508232116699}}, "episode_reward_max": 9.998021950544938, "episode_reward_min": -40.09472150805784, "episode_reward_mean": 7.868330421264342, "episode_len_mean": 69.65, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [7.942057373733013, 8.306730196503365, 9.613660448268131, 9.981517679210874, 9.450143689450666, 9.947346072914119, 9.781393363255248, 6.922305990395401, 9.715408551536232, 9.973882099079729, 9.702672832801957, 9.850868031763778, 9.957594074508199, 9.217407934945088, 9.990098975463148, 9.989078746819459, 9.455048883791076, 9.817435184202349, 9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013], "episode_lengths": [146, 145, 101, 13, 117, 70, 91, 87, 43, 44, 53, 88, 59, 92, 10, 67, 75, 68, 87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17894442495529803, "mean_inference_ms": 0.48547776770031476, "mean_action_processing_ms": 0.11056552131719237, "mean_env_wait_ms": 0.07741534988062139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033926963806152344, "StateBufferConnector_ms": 0.0031197071075439453, "ViewRequirementAgentConnector_ms": 0.06080508232116699}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108565, "num_agent_steps_trained": 108565, "num_env_steps_sampled": 108565, "num_env_steps_trained": 108565, "num_env_steps_sampled_this_iter": 1217, "num_env_steps_trained_this_iter": 1217, "timesteps_total": 108565, "num_steps_trained_this_iter": 1217, "agent_timesteps_total": 108565, "timers": {"training_iteration_time_ms": 16554.117, "load_time_ms": 2.11, "load_throughput": 572142.292, "learn_time_ms": 16302.172, "learn_throughput": 74.045, "synch_weights_time_ms": 2.354}, "counters": {"num_env_steps_sampled": 108565, "num_env_steps_trained": 108565, "num_agent_steps_sampled": 108565, "num_agent_steps_trained": 108565}, "done": false, "episodes_total": 1694, "training_iteration": 88, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-28-56", "timestamp": 1678937336, "time_this_iter_s": 16.988775730133057, "time_total_s": 721.3766570091248, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff18042d370>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff18042deb0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 306.2083389759064, "timesteps_since_restore": 0, "iterations_since_restore": 18, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.121739130434781, "ram_util_percent": 21.800000000000004, "gpu_util_percent0": 0.898695652173913, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.47650657117490575, "cur_lr": 0.0002839118933253797, "total_loss": 1.76909091906898, "policy_loss": -0.11488966533431301, "vf_loss": 1.8723236184039471, "vf_explained_var": 0.5140990171167585, "kl": 0.0249265454738718, "entropy": 0.7852428001662095, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 21060.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 109730, "num_env_steps_trained": 109730, "num_agent_steps_sampled": 109730, "num_agent_steps_trained": 109730}, "sampler_results": {"episode_reward_max": 9.998426475199082, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 6.8034595854473965, "episode_len_mean": 67.61, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407], "episode_lengths": [87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1790366674195833, "mean_inference_ms": 0.48551298391277997, "mean_action_processing_ms": 0.11055899217834328, "mean_env_wait_ms": 0.07741152006126206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034601688385009766, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.062310218811035156}}, "episode_reward_max": 9.998426475199082, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 6.8034595854473965, "episode_len_mean": 67.61, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.838190753471498, 5.6092322829916075, 9.98334889829293, 9.642106742088695, 9.570577145841058, 9.805297041738958, 9.947315219860414, 9.911903734393395, 9.184883132995056, 8.93805142612558, 9.656405692242956, 9.920746654977286, 8.558251444442869, -40.002770987749145, 7.819161723950797, 9.904001173092631, 9.709794630651153, 9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407], "episode_lengths": [87, 80, 5, 65, 64, 34, 15, 54, 48, 53, 75, 17, 110, 11, 149, 38, 50, 70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1790366674195833, "mean_inference_ms": 0.48551298391277997, "mean_action_processing_ms": 0.11055899217834328, "mean_env_wait_ms": 0.07741152006126206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034601688385009766, "StateBufferConnector_ms": 0.003364086151123047, "ViewRequirementAgentConnector_ms": 0.062310218811035156}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109730, "num_agent_steps_trained": 109730, "num_env_steps_sampled": 109730, "num_env_steps_trained": 109730, "num_env_steps_sampled_this_iter": 1165, "num_env_steps_trained_this_iter": 1165, "timesteps_total": 109730, "num_steps_trained_this_iter": 1165, "agent_timesteps_total": 109730, "timers": {"training_iteration_time_ms": 16390.106, "load_time_ms": 2.013, "load_throughput": 594160.77, "learn_time_ms": 16136.815, "learn_throughput": 74.104, "synch_weights_time_ms": 2.367}, "counters": {"num_env_steps_sampled": 109730, "num_env_steps_trained": 109730, "num_agent_steps_sampled": 109730, "num_agent_steps_trained": 109730}, "done": false, "episodes_total": 1712, "training_iteration": 89, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-29-12", "timestamp": 1678937352, "time_this_iter_s": 16.050799131393433, "time_total_s": 737.4274561405182, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff138767b50>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff138767700>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff769f05e50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 322.2591381072998, "timesteps_since_restore": 0, "iterations_since_restore": 19, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.523809523809524, "ram_util_percent": 21.84761904761905, "gpu_util_percent0": 0.8680952380952379, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7147598567623588, "cur_lr": 0.0002839118933253798, "total_loss": 0.6226108021840143, "policy_loss": -0.05213876057652727, "vf_loss": 0.6681184353397435, "vf_explained_var": 0.23623704564949824, "kl": 0.009635369740227903, "entropy": 0.9102671334667811, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 22230.5, "diff_num_grad_updates_vs_sampler_policy": 629.5}}, "num_env_steps_sampled": 111095, "num_env_steps_trained": 111095, "num_agent_steps_sampled": 111095, "num_agent_steps_trained": 111095}, "sampler_results": {"episode_reward_max": 9.998426475199082, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.293994883950448, "episode_len_mean": 71.71, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183], "episode_lengths": [70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17922529526395314, "mean_inference_ms": 0.48570806403465544, "mean_action_processing_ms": 0.1106246462213891, "mean_env_wait_ms": 0.07742352392705253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592252731323242, "StateBufferConnector_ms": 0.0034589767456054688, "ViewRequirementAgentConnector_ms": 0.06272673606872559}}, "episode_reward_max": 9.998426475199082, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.293994883950448, "episode_len_mean": 71.71, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.816990618299833, 8.960303180292618, 9.86761689603735, 9.371622332130501, 9.949451311082452, 9.884306009306226, 9.94017671526787, 9.965808923045316, 9.460755401459213, 8.664155745252991, 9.836780268225363, 9.556597728554774, 8.702471679689747, 4.3352495296515405, 9.79704621123197, 9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183], "episode_lengths": [70, 93, 73, 50, 45, 50, 46, 28, 132, 118, 29, 99, 87, 117, 96, 103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17922529526395314, "mean_inference_ms": 0.48570806403465544, "mean_action_processing_ms": 0.1106246462213891, "mean_env_wait_ms": 0.07742352392705253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592252731323242, "StateBufferConnector_ms": 0.0034589767456054688, "ViewRequirementAgentConnector_ms": 0.06272673606872559}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111095, "num_agent_steps_trained": 111095, "num_env_steps_sampled": 111095, "num_env_steps_trained": 111095, "num_env_steps_sampled_this_iter": 1365, "num_env_steps_trained_this_iter": 1365, "timesteps_total": 111095, "num_steps_trained_this_iter": 1365, "agent_timesteps_total": 111095, "timers": {"training_iteration_time_ms": 16674.681, "load_time_ms": 2.008, "load_throughput": 606245.163, "learn_time_ms": 16420.725, "learn_throughput": 74.12, "synch_weights_time_ms": 2.409}, "counters": {"num_env_steps_sampled": 111095, "num_env_steps_trained": 111095, "num_agent_steps_sampled": 111095, "num_agent_steps_trained": 111095}, "done": false, "episodes_total": 1729, "training_iteration": 90, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-29-31", "timestamp": 1678937371, "time_this_iter_s": 18.76194977760315, "time_total_s": 756.1894059181213, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1383f45e0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1383f4190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138299280>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 341.02108788490295, "timesteps_since_restore": 0, "iterations_since_restore": 20, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.342307692307694, "ram_util_percent": 21.81153846153846, "gpu_util_percent0": 0.8911538461538462, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7147598567623589, "cur_lr": 0.0002839118933253797, "total_loss": 1.3425402792491863, "policy_loss": -0.06409766966028622, "vf_loss": 1.4016067373218701, "vf_explained_var": 0.2240709873261275, "kl": 0.007396272856995327, "entropy": 0.9084844578195501, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 23400.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 112277, "num_env_steps_trained": 112277, "num_agent_steps_sampled": 112277, "num_agent_steps_trained": 112277}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 6.7517893421430495, "episode_len_mean": 72.2, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185], "episode_lengths": [103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1792513356479623, "mean_inference_ms": 0.48601540045457925, "mean_action_processing_ms": 0.11070658583998463, "mean_env_wait_ms": 0.07742609076326412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592967987060547, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.06333804130554199}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 6.7517893421430495, "episode_len_mean": 72.2, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.697734921396902, -40.0063978694887, 7.841706265493851, 9.645399702927769, 9.933914576763089, 9.973066522629724, 9.955250876419974, 9.867137148378717, 8.670541730739018, 9.976524403171405, 9.875532849470492, 9.869605693812064, 9.993952226492658, 9.964850863270833, 9.962563947263282, 9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185], "episode_lengths": [103, 18, 140, 43, 103, 44, 65, 42, 128, 42, 10, 8, 2, 66, 40, 37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1792513356479623, "mean_inference_ms": 0.48601540045457925, "mean_action_processing_ms": 0.11070658583998463, "mean_env_wait_ms": 0.07742609076326412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592967987060547, "StateBufferConnector_ms": 0.003558635711669922, "ViewRequirementAgentConnector_ms": 0.06333804130554199}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112277, "num_agent_steps_trained": 112277, "num_env_steps_sampled": 112277, "num_env_steps_trained": 112277, "num_env_steps_sampled_this_iter": 1182, "num_env_steps_trained_this_iter": 1182, "timesteps_total": 112277, "num_steps_trained_this_iter": 1182, "agent_timesteps_total": 112277, "timers": {"training_iteration_time_ms": 16609.038, "load_time_ms": 1.971, "load_throughput": 612574.182, "learn_time_ms": 16354.43, "learn_throughput": 73.821, "synch_weights_time_ms": 2.39}, "counters": {"num_env_steps_sampled": 112277, "num_env_steps_trained": 112277, "num_agent_steps_sampled": 112277, "num_agent_steps_trained": 112277}, "done": false, "episodes_total": 1744, "training_iteration": 91, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-29-47", "timestamp": 1678937387, "time_this_iter_s": 16.037675142288208, "time_total_s": 772.2270810604095, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff1387aac10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff1387aa280>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 357.05876302719116, "timesteps_since_restore": 0, "iterations_since_restore": 21, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.085714285714285, "ram_util_percent": 21.819047619047623, "gpu_util_percent0": 0.9233333333333333, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7147598567623589, "cur_lr": 0.0002839118933253797, "total_loss": 0.07453588040338623, "policy_loss": -0.05890963483619055, "vf_loss": 0.06614647040389375, "vf_explained_var": 0.6740529871649212, "kl": 0.09450426652738317, "entropy": 0.8852565218453055, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 113433, "num_env_steps_trained": 113433, "num_agent_steps_sampled": 113433, "num_agent_steps_trained": 113433}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.2200090476778, "episode_len_mean": 75.22, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257], "episode_lengths": [37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17935362569242982, "mean_inference_ms": 0.4864609956841588, "mean_action_processing_ms": 0.1108256852603596, "mean_env_wait_ms": 0.07745850937448234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003549814224243164, "StateBufferConnector_ms": 0.0033676624298095703, "ViewRequirementAgentConnector_ms": 0.062171220779418945}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.2200090476778, "episode_len_mean": 75.22, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.979548199333713, 9.86674397166898, 8.169149661792803, 8.895227734667996, 9.92536546100889, 9.822183356061096, 9.46862961261941, 9.801204255470653, 9.929339641864473, 9.910907944015817, 9.920513724208707, 9.364136102660051, 9.938256517632778, 9.891748525586625, -40.09472150805784, 8.026257894007458, 8.733680561856799, 9.847292321211775, 9.930080083234277, 9.831064063916243, 9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257], "episode_lengths": [37, 15, 139, 103, 76, 125, 80, 24, 75, 7, 32, 109, 72, 68, 106, 143, 133, 93, 41, 88, 81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17935362569242982, "mean_inference_ms": 0.4864609956841588, "mean_action_processing_ms": 0.1108256852603596, "mean_env_wait_ms": 0.07745850937448234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003549814224243164, "StateBufferConnector_ms": 0.0033676624298095703, "ViewRequirementAgentConnector_ms": 0.062171220779418945}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113433, "num_agent_steps_trained": 113433, "num_env_steps_sampled": 113433, "num_env_steps_trained": 113433, "num_env_steps_sampled_this_iter": 1156, "num_env_steps_trained_this_iter": 1156, "timesteps_total": 113433, "num_steps_trained_this_iter": 1156, "agent_timesteps_total": 113433, "timers": {"training_iteration_time_ms": 16641.743, "load_time_ms": 2.069, "load_throughput": 583687.291, "learn_time_ms": 16389.404, "learn_throughput": 73.694, "synch_weights_time_ms": 2.419}, "counters": {"num_env_steps_sampled": 113433, "num_env_steps_trained": 113433, "num_agent_steps_sampled": 113433, "num_agent_steps_trained": 113433}, "done": false, "episodes_total": 1759, "training_iteration": 92, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-30-03", "timestamp": 1678937403, "time_this_iter_s": 15.963738203048706, "time_total_s": 788.1908192634583, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff6542bd580>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff6542bdc40>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138121dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 373.02250123023987, "timesteps_since_restore": 0, "iterations_since_restore": 22, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.704545454545455, "ram_util_percent": 21.849999999999998, "gpu_util_percent0": 0.8731818181818181, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0721397851435381, "cur_lr": 0.0002839118933253797, "total_loss": 1.1458149876367922, "policy_loss": -0.1132497800876283, "vf_loss": 1.2241135345800742, "vf_explained_var": 0.5109981404410469, "kl": 0.032836040876174144, "entropy": 0.9022641287357719, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 25560.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 114613, "num_env_steps_trained": 114613, "num_agent_steps_sampled": 114613, "num_agent_steps_trained": 114613}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.646907871735064, "episode_len_mean": 71.36, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555], "episode_lengths": [81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794395555689829, "mean_inference_ms": 0.4867104557809846, "mean_action_processing_ms": 0.11085812812738367, "mean_env_wait_ms": 0.07749054943354425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568887710571289, "StateBufferConnector_ms": 0.0033779144287109375, "ViewRequirementAgentConnector_ms": 0.06267666816711426}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.71475861022918, "episode_reward_mean": 7.646907871735064, "episode_len_mean": 71.36, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.75605978854058, 9.807062802558116, 9.646094476866006, 9.998021950544938, 9.995540325605397, 9.938714384649625, 9.570295945691953, 8.366984296023798, 9.899580861073867, 9.912337923363564, 0.023086795400880433, 9.966256930480856, 9.548381539418429, 8.375574205307911, 9.930578529829013, 9.737978577372917, 9.641414487530277, -40.71475861022918, 9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555], "episode_lengths": [81, 71, 108, 9, 19, 59, 130, 143, 57, 21, 93, 9, 68, 137, 83, 92, 117, 104, 15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1794395555689829, "mean_inference_ms": 0.4867104557809846, "mean_action_processing_ms": 0.11085812812738367, "mean_env_wait_ms": 0.07749054943354425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003568887710571289, "StateBufferConnector_ms": 0.0033779144287109375, "ViewRequirementAgentConnector_ms": 0.06267666816711426}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114613, "num_agent_steps_trained": 114613, "num_env_steps_sampled": 114613, "num_env_steps_trained": 114613, "num_env_steps_sampled_this_iter": 1180, "num_env_steps_trained_this_iter": 1180, "timesteps_total": 114613, "num_steps_trained_this_iter": 1180, "agent_timesteps_total": 114613, "timers": {"training_iteration_time_ms": 16549.202, "load_time_ms": 2.058, "load_throughput": 583898.902, "learn_time_ms": 16297.177, "learn_throughput": 73.724, "synch_weights_time_ms": 2.41}, "counters": {"num_env_steps_sampled": 114613, "num_env_steps_trained": 114613, "num_agent_steps_sampled": 114613, "num_agent_steps_trained": 114613}, "done": false, "episodes_total": 1779, "training_iteration": 93, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-30-19", "timestamp": 1678937419, "time_this_iter_s": 16.244588613510132, "time_total_s": 804.4354078769684, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769eafc10>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769eaf190>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381acaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 389.26708984375, "timesteps_since_restore": 0, "iterations_since_restore": 23, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 15.909090909090908, "ram_util_percent": 21.818181818181824, "gpu_util_percent0": 0.8409090909090909, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6082096777153072, "cur_lr": 0.0002839118933253797, "total_loss": 0.1613337549844577, "policy_loss": -0.09595567289118966, "vf_loss": 0.2090108372299654, "vf_explained_var": 0.4631950004058972, "kl": 0.030166216036294633, "entropy": 0.8361396121612766, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 26670.5, "diff_num_grad_updates_vs_sampler_policy": 569.5}}, "num_env_steps_sampled": 115834, "num_env_steps_trained": 115834, "num_agent_steps_sampled": 115834, "num_agent_steps_trained": 115834}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.256178091967776, "episode_reward_mean": 8.16899133058002, "episode_len_mean": 69.56, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569], "episode_lengths": [15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17942179723819204, "mean_inference_ms": 0.48649701629939623, "mean_action_processing_ms": 0.1108093057588266, "mean_env_wait_ms": 0.07741904320641411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035381317138671875, "StateBufferConnector_ms": 0.0032525062561035156, "ViewRequirementAgentConnector_ms": 0.06194448471069336}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.256178091967776, "episode_reward_mean": 8.16899133058002, "episode_len_mean": 69.56, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.762122569710591, 9.941696711468792, 9.900835803477923, 9.901185181226987, 9.686119808249462, 9.89232948308369, 9.66086498964086, 9.998426475199082, 9.937351763264159, 9.877172535926247, -2.36943108545427, 9.031995675246225, 9.974822397946868, -40.256178091967776, 9.523617875254407, 9.585100550708834, 9.558267907866021, 9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569], "episode_lengths": [15, 72, 13, 12, 85, 77, 44, 6, 37, 9, 121, 132, 40, 57, 132, 126, 66, 108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17942179723819204, "mean_inference_ms": 0.48649701629939623, "mean_action_processing_ms": 0.1108093057588266, "mean_env_wait_ms": 0.07741904320641411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035381317138671875, "StateBufferConnector_ms": 0.0032525062561035156, "ViewRequirementAgentConnector_ms": 0.06194448471069336}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115834, "num_agent_steps_trained": 115834, "num_env_steps_sampled": 115834, "num_env_steps_trained": 115834, "num_env_steps_sampled_this_iter": 1221, "num_env_steps_trained_this_iter": 1221, "timesteps_total": 115834, "num_steps_trained_this_iter": 1221, "agent_timesteps_total": 115834, "timers": {"training_iteration_time_ms": 16776.638, "load_time_ms": 1.911, "load_throughput": 636093.554, "learn_time_ms": 16523.161, "learn_throughput": 73.582, "synch_weights_time_ms": 2.413}, "counters": {"num_env_steps_sampled": 115834, "num_env_steps_trained": 115834, "num_agent_steps_sampled": 115834, "num_agent_steps_trained": 115834}, "done": false, "episodes_total": 1797, "training_iteration": 94, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-30-36", "timestamp": 1678937436, "time_this_iter_s": 16.928763389587402, "time_total_s": 821.3641712665558, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff65435d7c0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff65435d940>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff13813f9d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 406.1958532333374, "timesteps_since_restore": 0, "iterations_since_restore": 24, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.443478260869565, "ram_util_percent": 21.882608695652166, "gpu_util_percent0": 0.9034782608695651, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.412314516572961, "cur_lr": 0.0002839118933253798, "total_loss": 0.07667578088377065, "policy_loss": -0.07936470325339616, "vf_loss": 0.05383241409710343, "vf_explained_var": 0.6698760508037195, "kl": 0.04247350683269206, "entropy": 0.8943862240488937, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 27855.5, "diff_num_grad_updates_vs_sampler_policy": 614.5}}, "num_env_steps_sampled": 117175, "num_env_steps_trained": 117175, "num_agent_steps_sampled": 117175, "num_agent_steps_trained": 117175}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.14751931494709, "episode_reward_mean": 8.7813581578733, "episode_len_mean": 72.53, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313], "episode_lengths": [108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17929766225628885, "mean_inference_ms": 0.4862982672894798, "mean_action_processing_ms": 0.1107408359750552, "mean_env_wait_ms": 0.07735202045425932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0030105113983154297, "ViewRequirementAgentConnector_ms": 0.06055903434753418}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.14751931494709, "episode_reward_mean": 8.7813581578733, "episode_len_mean": 72.53, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.798097045506086, 9.80656098580647, 9.939209208947426, 9.609476726230204, 9.916767510579785, 9.976462001810704, 8.544164752365393, 9.822010545361493, 8.404710299729432, 6.23199635972958, 9.99548602622477, 9.950382552717793, 7.956445442882926, 8.275718342374924, 9.679170300871183, 8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313], "episode_lengths": [108, 103, 12, 45, 86, 13, 119, 127, 59, 120, 2, 7, 131, 125, 116, 135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17929766225628885, "mean_inference_ms": 0.4862982672894798, "mean_action_processing_ms": 0.1107408359750552, "mean_env_wait_ms": 0.07735202045425932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00347137451171875, "StateBufferConnector_ms": 0.0030105113983154297, "ViewRequirementAgentConnector_ms": 0.06055903434753418}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117175, "num_agent_steps_trained": 117175, "num_env_steps_sampled": 117175, "num_env_steps_trained": 117175, "num_env_steps_sampled_this_iter": 1341, "num_env_steps_trained_this_iter": 1341, "timesteps_total": 117175, "num_steps_trained_this_iter": 1341, "agent_timesteps_total": 117175, "timers": {"training_iteration_time_ms": 17006.658, "load_time_ms": 1.878, "load_throughput": 656744.751, "learn_time_ms": 16742.902, "learn_throughput": 73.649, "synch_weights_time_ms": 2.431}, "counters": {"num_env_steps_sampled": 117175, "num_env_steps_trained": 117175, "num_agent_steps_sampled": 117175, "num_agent_steps_trained": 117175}, "done": false, "episodes_total": 1814, "training_iteration": 95, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-30-55", "timestamp": 1678937455, "time_this_iter_s": 18.169525861740112, "time_total_s": 839.5336971282959, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769ce7fd0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769ce7580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381acaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 424.3653790950775, "timesteps_since_restore": 0, "iterations_since_restore": 25, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.070833333333333, "ram_util_percent": 21.891666666666662, "gpu_util_percent0": 0.9162500000000001, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6184717748594406, "cur_lr": 0.0002839118933253797, "total_loss": -0.02239325761243149, "policy_loss": -0.08284986419948163, "vf_loss": 0.045309021450197585, "vf_explained_var": 0.7669342424582553, "kl": 0.004263398876759728, "entropy": 0.9940869707752157, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 29010.5, "diff_num_grad_updates_vs_sampler_policy": 539.5}}, "num_env_steps_sampled": 118356, "num_env_steps_trained": 118356, "num_agent_steps_sampled": 118356, "num_agent_steps_trained": 118356}, "sampler_results": {"episode_reward_max": 9.99904572294554, "episode_reward_min": -40.14751931494709, "episode_reward_mean": 8.815036572961537, "episode_len_mean": 72.61, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063], "episode_lengths": [135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1793347827921786, "mean_inference_ms": 0.4864683159559648, "mean_action_processing_ms": 0.11078214334337595, "mean_env_wait_ms": 0.07735198279172356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034415721893310547, "StateBufferConnector_ms": 0.002962827682495117, "ViewRequirementAgentConnector_ms": 0.06086874008178711}}, "episode_reward_max": 9.99904572294554, "episode_reward_min": -40.14751931494709, "episode_reward_mean": 8.815036572961537, "episode_len_mean": 72.61, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.2699291833579, 9.92888309589743, 9.406814510153735, 6.885066567197369, 9.564353566062355, 9.931571829119065, 8.499542462435183, -40.14751931494709, 9.753389351083937, 9.748320785900612, 8.308557660452482, 9.780110389575778, 4.034352254517608, 9.99904572294554, 9.926360305036185, 9.831915803465186, 8.419210813914152, 8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063], "episode_lengths": [135, 32, 36, 135, 105, 74, 115, 77, 81, 49, 128, 59, 133, 6, 17, 89, 141, 113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1793347827921786, "mean_inference_ms": 0.4864683159559648, "mean_action_processing_ms": 0.11078214334337595, "mean_env_wait_ms": 0.07735198279172356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034415721893310547, "StateBufferConnector_ms": 0.002962827682495117, "ViewRequirementAgentConnector_ms": 0.06086874008178711}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118356, "num_agent_steps_trained": 118356, "num_env_steps_sampled": 118356, "num_env_steps_trained": 118356, "num_env_steps_sampled_this_iter": 1181, "num_env_steps_trained_this_iter": 1181, "timesteps_total": 118356, "num_steps_trained_this_iter": 1181, "agent_timesteps_total": 118356, "timers": {"training_iteration_time_ms": 16846.219, "load_time_ms": 1.858, "load_throughput": 659468.561, "learn_time_ms": 16585.458, "learn_throughput": 73.884, "synch_weights_time_ms": 3.84}, "counters": {"num_env_steps_sampled": 118356, "num_env_steps_trained": 118356, "num_agent_steps_sampled": 118356, "num_agent_steps_trained": 118356}, "done": false, "episodes_total": 1829, "training_iteration": 96, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-31-10", "timestamp": 1678937470, "time_this_iter_s": 15.886780738830566, "time_total_s": 855.4204778671265, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769f6d940>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769f6d2e0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff138121dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 440.2521598339081, "timesteps_since_restore": 0, "iterations_since_restore": 26, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.67727272727273, "ram_util_percent": 21.89999999999999, "gpu_util_percent0": 0.8581818181818183, "vram_util_percent0": 0.03314208984375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8092358874297203, "cur_lr": 0.00028391189332537973, "total_loss": 0.024887492524982062, "policy_loss": -0.0645899044519121, "vf_loss": 0.04138441613379682, "vf_explained_var": 0.7150523301326868, "kl": 0.026730413380938577, "entropy": 0.955791657914718, "entropy_coeff": 0.0002810659182362141}, "model": {}, "num_grad_updates_lifetime": 30210.5, "diff_num_grad_updates_vs_sampler_policy": 659.5}}, "num_env_steps_sampled": 119771, "num_env_steps_trained": 119771, "num_agent_steps_sampled": 119771, "num_agent_steps_trained": 119771}, "sampler_results": {"episode_reward_max": 9.997715020786224, "episode_reward_min": 2.9806576060085535, "episode_reward_mean": 9.433916693048484, "episode_len_mean": 72.64, "episode_media": {}, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286], "episode_lengths": [113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17947659613162073, "mean_inference_ms": 0.4865994158713074, "mean_action_processing_ms": 0.1108285148509539, "mean_env_wait_ms": 0.07737587699930576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470182418823242, "StateBufferConnector_ms": 0.00296783447265625, "ViewRequirementAgentConnector_ms": 0.06110334396362305}}, "episode_reward_max": 9.997715020786224, "episode_reward_min": 2.9806576060085535, "episode_reward_mean": 9.433916693048484, "episode_len_mean": 72.64, "episodes_this_iter": 17, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.471099646443012, 9.772276383910299, 9.98655843448456, 9.006354985435426, 9.644054075814026, 9.941784707939284, 9.97168464290989, 9.359251273933163, 9.862276828135567, 8.150571393537945, 9.846415438781397, 9.924438969496837, 9.855461014015257, 8.922213105125516, 8.200153400720236, 9.98744566453148, 9.977514981694158, 9.994626537232486, 9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286], "episode_lengths": [113, 61, 31, 124, 125, 22, 35, 75, 68, 133, 48, 15, 76, 106, 111, 57, 51, 30, 6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17947659613162073, "mean_inference_ms": 0.4865994158713074, "mean_action_processing_ms": 0.1108285148509539, "mean_env_wait_ms": 0.07737587699930576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470182418823242, "StateBufferConnector_ms": 0.00296783447265625, "ViewRequirementAgentConnector_ms": 0.06110334396362305}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119771, "num_agent_steps_trained": 119771, "num_env_steps_sampled": 119771, "num_env_steps_trained": 119771, "num_env_steps_sampled_this_iter": 1415, "num_env_steps_trained_this_iter": 1415, "timesteps_total": 119771, "num_steps_trained_this_iter": 1415, "agent_timesteps_total": 119771, "timers": {"training_iteration_time_ms": 16419.281, "load_time_ms": 1.93, "load_throughput": 643655.437, "learn_time_ms": 16156.106, "learn_throughput": 76.894, "synch_weights_time_ms": 3.813}, "counters": {"num_env_steps_sampled": 119771, "num_env_steps_trained": 119771, "num_agent_steps_sampled": 119771, "num_agent_steps_trained": 119771}, "done": false, "episodes_total": 1846, "training_iteration": 97, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-31-24", "timestamp": 1678937484, "time_this_iter_s": 13.224547624588013, "time_total_s": 868.6450254917145, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6aac0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6a340>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381acaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 453.4767074584961, "timesteps_since_restore": 0, "iterations_since_restore": 27, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 15.676470588235293, "ram_util_percent": 19.888235294117646, "gpu_util_percent0": 0.6835294117647058, "vram_util_percent0": 0.028295180376838234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.713853831144581, "cur_lr": 0.0002839118933253797, "total_loss": -0.032103627691095746, "policy_loss": -0.06223915759977457, "vf_loss": 0.007803267854293924, "vf_explained_var": 0.9228999857429986, "kl": 0.008327633739895448, "entropy": 0.9525058775334745, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 31425.5, "diff_num_grad_updates_vs_sampler_policy": 554.5}}, "num_env_steps_sampled": 120981, "num_env_steps_trained": 120981, "num_agent_steps_sampled": 120981, "num_agent_steps_trained": 120981}, "sampler_results": {"episode_reward_max": 9.999149700341766, "episode_reward_min": 2.9806576060085535, "episode_reward_mean": 9.471970761519117, "episode_len_mean": 71.93, "episode_media": {}, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286, 9.991090314906844, 9.900253833635041, 9.987216753239062, 9.976240119446892, 9.812166770543588, 9.657865965841639, 9.767852243908901, 9.558867592769504, 9.999149700341766, 9.92884872571757, 8.826583704478395, 9.757314986699363, 9.99643458667732, 9.956803124152254, 9.835274309429577, 8.474506088752634, 9.542293133461177, 9.71082637720234], "episode_lengths": [6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112, 33, 25, 5, 14, 128, 89, 94, 83, 13, 51, 103, 83, 18, 62, 74, 120, 134, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17926356812133015, "mean_inference_ms": 0.48618811064286405, "mean_action_processing_ms": 0.11070494096737264, "mean_env_wait_ms": 0.07729031023807108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034563541412353516, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.06099295616149902}}, "episode_reward_max": 9.999149700341766, "episode_reward_min": 2.9806576060085535, "episode_reward_mean": 9.471970761519117, "episode_len_mean": 71.93, "episodes_this_iter": 18, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.949284321386845, 9.960471314367089, 9.978075391488977, 9.74757560335968, 9.929021587721659, 9.997387725969796, 2.9806576060085535, 9.84719633216287, 9.933749734869147, 9.599010250449396, 9.274812551079366, 9.971768197713029, 9.885362693587782, 9.791585817944132, 5.9185777130749555, 5.457528158129845, 9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286, 9.991090314906844, 9.900253833635041, 9.987216753239062, 9.976240119446892, 9.812166770543588, 9.657865965841639, 9.767852243908901, 9.558867592769504, 9.999149700341766, 9.92884872571757, 8.826583704478395, 9.757314986699363, 9.99643458667732, 9.956803124152254, 9.835274309429577, 8.474506088752634, 9.542293133461177, 9.71082637720234], "episode_lengths": [6, 35, 39, 105, 32, 16, 118, 66, 75, 92, 91, 19, 34, 43, 54, 139, 40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112, 33, 25, 5, 14, 128, 89, 94, 83, 13, 51, 103, 83, 18, 62, 74, 120, 134, 81]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17926356812133015, "mean_inference_ms": 0.48618811064286405, "mean_action_processing_ms": 0.11070494096737264, "mean_env_wait_ms": 0.07729031023807108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034563541412353516, "StateBufferConnector_ms": 0.0030426979064941406, "ViewRequirementAgentConnector_ms": 0.06099295616149902}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120981, "num_agent_steps_trained": 120981, "num_env_steps_sampled": 120981, "num_env_steps_trained": 120981, "num_env_steps_sampled_this_iter": 1210, "num_env_steps_trained_this_iter": 1210, "timesteps_total": 120981, "num_steps_trained_this_iter": 1210, "agent_timesteps_total": 120981, "timers": {"training_iteration_time_ms": 15571.18, "load_time_ms": 1.797, "load_throughput": 691100.268, "learn_time_ms": 15311.986, "learn_throughput": 81.087, "synch_weights_time_ms": 3.8}, "counters": {"num_env_steps_sampled": 120981, "num_env_steps_trained": 120981, "num_agent_steps_sampled": 120981, "num_agent_steps_trained": 120981}, "done": false, "episodes_total": 1864, "training_iteration": 98, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-31-32", "timestamp": 1678937492, "time_this_iter_s": 8.507354736328125, "time_total_s": 877.1523802280426, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769cdc2b0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769cdc1c0>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1385ccf70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 461.9840621948242, "timesteps_since_restore": 0, "iterations_since_restore": 28, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 32.633333333333326, "ram_util_percent": 18.8, "gpu_util_percent0": 0.21999999999999997, "vram_util_percent0": 0.024515787760416668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.713853831144582, "cur_lr": 0.0002839118933253797, "total_loss": 0.0982770951991413, "policy_loss": -0.07450657555389972, "vf_loss": 0.1293232102130839, "vf_explained_var": 0.7451039158730279, "kl": 0.01611383563032827, "entropy": 0.9610914955820357, "entropy_coeff": 0.00028106591823621405}, "model": {}, "num_grad_updates_lifetime": 32505.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 122105, "num_env_steps_trained": 122105, "num_agent_steps_sampled": 122105, "num_agent_steps_trained": 122105}, "sampler_results": {"episode_reward_max": 9.999149700341766, "episode_reward_min": 6.315906722884179, "episode_reward_mean": 9.559531084324059, "episode_len_mean": 73.53, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286, 9.991090314906844, 9.900253833635041, 9.987216753239062, 9.976240119446892, 9.812166770543588, 9.657865965841639, 9.767852243908901, 9.558867592769504, 9.999149700341766, 9.92884872571757, 8.826583704478395, 9.757314986699363, 9.99643458667732, 9.956803124152254, 9.835274309429577, 8.474506088752634, 9.542293133461177, 9.71082637720234, 9.996056717073964, 9.163101656383564, 9.550433173210294, 9.98262699465508, 9.09992430825884, 9.782596857609569, 9.855428218332008, 9.401988542634918, 7.099873977806622, 9.521452731517076, 9.91727248918704, 9.584454404279802, 9.786415949326514, 9.848983455667515, 8.622675709458044, 9.764812094406567], "episode_lengths": [40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112, 33, 25, 5, 14, 128, 89, 94, 83, 13, 51, 103, 83, 18, 62, 74, 120, 134, 81, 24, 112, 132, 10, 102, 71, 33, 114, 105, 55, 83, 71, 42, 18, 123, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17940989079452754, "mean_inference_ms": 0.48638080113902127, "mean_action_processing_ms": 0.11078123838084615, "mean_env_wait_ms": 0.07730304582839345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003465890884399414, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.06131267547607422}}, "episode_reward_max": 9.999149700341766, "episode_reward_min": 6.315906722884179, "episode_reward_mean": 9.559531084324059, "episode_len_mean": 73.53, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.926015883004641, 9.778343006325168, 9.991374344045532, 9.739178034235643, 9.511336528749723, 9.995103296997023, 9.986254784009503, 9.906444919286391, 6.315906722884179, 9.673257625552218, 9.713965527025342, 9.94912499036288, 9.823140538509119, 9.782649899190545, 9.568976807390994, 9.845710385649255, 6.643239643176569, 9.722696962507458, 9.997211268787083, 9.865820895087664, 9.702828548490157, 9.819206891581889, 9.907337318866283, 9.620135442362422, 9.933421495914981, 9.862346105599014, 9.987506462926085, 9.727486108241052, 8.96651735622343, 9.635688737730423, 9.894227418514477, 9.628678433308792, 9.043394286891726, 9.52847954714313, 9.803994701626642, 7.613617508620001, 9.729441485963624, 9.824429067365147, 9.709139914704647, 8.547108517739554, 7.949069277664321, 9.94187381692356, 9.92246663683532, 9.99438095903566, 9.95333402993662, 9.958776128370667, 9.819101152689017, 8.697706589296963, 9.810059823190063, 9.139205308437528, 9.916984655844653, 9.308456713449132, 9.853086689371292, 9.520684516111082, 9.47497685062505, 9.085520400584178, 9.84404578813319, 9.965496641824862, 9.895002178598155, 9.86030366432407, 9.997715020786224, 9.481603222362176, 9.87009291631329, 9.98957281068267, 8.917469999085322, 9.907699618329286, 9.991090314906844, 9.900253833635041, 9.987216753239062, 9.976240119446892, 9.812166770543588, 9.657865965841639, 9.767852243908901, 9.558867592769504, 9.999149700341766, 9.92884872571757, 8.826583704478395, 9.757314986699363, 9.99643458667732, 9.956803124152254, 9.835274309429577, 8.474506088752634, 9.542293133461177, 9.71082637720234, 9.996056717073964, 9.163101656383564, 9.550433173210294, 9.98262699465508, 9.09992430825884, 9.782596857609569, 9.855428218332008, 9.401988542634918, 7.099873977806622, 9.521452731517076, 9.91727248918704, 9.584454404279802, 9.786415949326514, 9.848983455667515, 8.622675709458044, 9.764812094406567], "episode_lengths": [40, 88, 33, 43, 78, 4, 27, 35, 133, 92, 130, 10, 22, 109, 68, 37, 133, 57, 16, 78, 143, 49, 107, 144, 50, 17, 12, 25, 141, 109, 79, 107, 139, 68, 78, 142, 54, 109, 66, 105, 146, 28, 98, 31, 9, 20, 40, 143, 112, 138, 45, 135, 25, 132, 99, 140, 127, 53, 63, 46, 17, 134, 78, 9, 62, 112, 33, 25, 5, 14, 128, 89, 94, 83, 13, 51, 103, 83, 18, 62, 74, 120, 134, 81, 24, 112, 132, 10, 102, 71, 33, 114, 105, 55, 83, 71, 42, 18, 123, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.17940989079452754, "mean_inference_ms": 0.48638080113902127, "mean_action_processing_ms": 0.11078123838084615, "mean_env_wait_ms": 0.07730304582839345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003465890884399414, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.06131267547607422}, "num_healthy_workers": 5, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122105, "num_agent_steps_trained": 122105, "num_env_steps_sampled": 122105, "num_env_steps_trained": 122105, "num_env_steps_sampled_this_iter": 1124, "num_env_steps_trained_this_iter": 1124, "timesteps_total": 122105, "num_steps_trained_this_iter": 1124, "agent_timesteps_total": 122105, "timers": {"training_iteration_time_ms": 15548.002, "load_time_ms": 1.76, "load_throughput": 703113.098, "learn_time_ms": 15287.717, "learn_throughput": 80.947, "synch_weights_time_ms": 3.83}, "counters": {"num_env_steps_sampled": 122105, "num_env_steps_trained": 122105, "num_agent_steps_sampled": 122105, "num_agent_steps_trained": 122105}, "done": true, "episodes_total": 1880, "training_iteration": 99, "trial_id": "7ea15_00001", "experiment_id": "e3fd64b6dc21456fbae43185efdcd4a2", "date": "2023-03-15_23-31-48", "timestamp": 1678937508, "time_this_iter_s": 15.819093227386475, "time_total_s": 892.9714734554291, "pid": 25359, "hostname": "tensorbook", "node_ip": "10.0.0.180", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0.2, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_trainer_workers": 0, "num_gpus_per_trainer_worker": 0, "num_cpus_per_trainer_worker": 1, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "<class 'simple_highway_ramp_wrapper.SimpleHighwayRampWrapper'>", "env_config": {"difficulty_level": 0, "stopper": "<stop_logic.StopLogic object at 0x7ff769e6aac0>", "burn_in_iters": 70, "time_step_size": 0.5, "debug": 0, "training": true, "randomize_start_dist": true, "neighbor_speed": 29.1, "neighbor_start_loc": 320.0}, "observation_space": null, "action_space": null, "env_task_fn": "<function curriculum_fn at 0x7ff655ce8b80>", "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 200, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "ignore_worker_failures": false, "recreate_failed_workers": true, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "gamma": 0.999, "lr": 0.0002839118933253797, "train_batch_size": 1000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 50], "fcnet_activation": "relu", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "linear", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "rl_trainer_class": null, "_enable_rl_trainer_api": false, "_rl_trainer_hps": "RLTrainerHPs()", "explore": true, "exploration_config": {"type": "GaussianNoise", "stddev": 0.23179202124946774, "random_timesteps": 0, "initial_scale": 1.0, "final_scale": 0.1, "scale_timesteps": 200000}, "policies": {"default_policy": [null, null, null, null]}, "policy_states_are_swappable": "<ray.rllib.utils.from_config._NotProvided object at 0x7ff769e6a580>", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": 20, "evaluation_duration": 15, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 2, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 17, "worker_cls": null, "rl_module_class": null, "_enable_rl_module_api": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.7051394525116119, "sgd_minibatch_size": 32, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00028106591823621405, "entropy_coeff_schedule": null, "clip_param": 0.28974635474018884, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.__init__.<locals>.<lambda> at 0x7ff1381acaf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'cda_callbacks.CdaCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5}, "time_since_restore": 477.8031554222107, "timesteps_since_restore": 0, "iterations_since_restore": 29, "warmup_time": 8.80284833908081, "perf": {"cpu_util_percent": 14.338095238095237, "ram_util_percent": 21.814285714285717, "gpu_util_percent0": 0.8952380952380953, "vram_util_percent0": 0.03314208984375}}
